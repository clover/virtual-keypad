{"version":3,"sources":["common/constants.js","store/actions/initialState.js","common/Storage.js","store/configuration/initialState.js","store/connection/initialState.js","store/connection/reducer.js","store/devices/initialState.js","store/error/initialState.js","store/settings/initialState.js","store/signature/initialState.js","common/retryFetch.js","common/api.js","common/fetchDevices.js","common/fetchSettings.js","common/format.js","store/transactions/initialState.js","store/rootReducer.js","store/actions/reducer.js","store/actions/constants.js","store/connection/constants.js","store/buffer/reducer.js","store/buffer/initialState.js","store/buffer/constants.js","store/configuration/reducer.js","store/configuration/constants.js","store/devices/reducer.js","store/devices/constants.js","store/error/reducer.js","store/error/constants.js","store/settings/reducer.js","store/settings/constants.js","store/signature/reducer.js","store/signature/constants.js","store/status/reducer.js","store/status/initialState.js","store/status/constants.js","store/transactions/reducer.js","store/transactions/constants.js","store/configuration/selectors.js","store/error/actions.js","store/actions/actions.js","store/connection/selectors.js","store/status/actions.js","common/persist.js","store/configuration/actions.js","store/devices/actions.js","store/settings/actions.js","store/thunks/configure.js","store/devices/selectors.js","store/connection/actions.js","store/thunks/connect.js","store/transactions/actions.js","store/thunks/disconnect.js","locales/index.js","i18n.js","store/thunks/reset.js","store/error/selectors.js","store/thunks/showWelcome.js","store/buffer/actions.js","store/buffer/selectors.js","store/transactions/selectors.js","store/thunks/transaction.js","store/thunks/voidPayment.js","store/store.js","store/createStore.js","store/actions/selectors.js","store/settings/selectors.js","store/signature/selectors.js","store/status/selectors.js","components/Configuration/selectors.js","components/Fields/TextField.js","components/Fields/CheckboxField.js","components/SVG/Logo.js","components/Configuration/Configuration.js","components/Devices/selectors.js","components/Devices/Device.js","components/Devices/Devices.js","components/Keypad/constants.js","store/thunks/acceptPayment.js","store/thunks/acceptSignature.js","store/signature/actions.js","store/thunks/identify.js","store/thunks/invokeInputOption.js","store/thunks/rejectPayment.js","store/thunks/rejectSignature.js","components/Keypad/selectors.js","components/Keypad/Signature.js","components/Keypad/Screen.js","components/Keypad/ScaleText.js","components/Keypad/Key.js","components/Keypad/Keys.js","components/Keypad/Menu.js","components/Transaction/parseAmounts.js","components/Transaction/Transaction.js","components/Transaction/useShowTransaction.js","components/Keypad/History.js","components/Keypad/Keypad.js","components/Error/Error.js","components/App/App.js","components/App/useMouse.js","components/Error/useError.js","components/App/usePreventDoubleTapZoom.js","components/Transaction/useTransactions.js","serviceWorker.js","index.js"],"names":["ACTION","APP","APP_NAME","APP_BY_NAME","Object","fromEntries","entries","map","arr","reverse","DOMAIN","PERMISSION","MANUAL_ENTRY_ALLOWED","PERFORM_MANUAL_REFUND","VOID_PAYMENTS","REG_PRODUCTS","TRANSACTION","get","JSON","parse","atob","localStorage","getItem","e","qs","QS","window","location","search","hash","storage","Storage","cloverDomain","document","referrer","URL","origin","includes","toString","configuration","getCloverDomain","merchantId","merchant_id","employeeId","employee_id","accessToken","access_token","raid","friendlyId","forceConnect","loading","undefined","connector","connected","fixCreditPayIntent","doTxStart","device","payIntent","order","requestInfo","externalReferenceId","externalPaymentId","call","tryDispose","dispose","list","selected","devices","message","stack","important","employee","permissions","width","height","strokes","retryFetch","url","retries","options","fetch","catch","deviceApps","deviceId","method","headers","accept","authorization","then","r","json","permissionSets","filterNames","values","searchParams","set","length","n","join","appsReducer","o","a","app","appName","createPartition","array","size","reduce","last","push","api","elements","filter","d","test","productName","partitions","i","Promise","all","id","apps","flat","applications","currency","value","isNaN","toLocaleString","minimumFractionDigits","maximumFractionDigits","active","mode","data","rootReducer","combineReducers","actions","state","initialState","type","payload","found","some","description","inputOptions","io","buffer","replace","slice","connection","code","request","Clover","remotepay","RetrieveDeviceStatusRequest","setSendLastMessage","retrieveDeviceStatus","error","stringify","success","settings","signature","status","challenges","transactions","cur","timestamp","Date","now","amount","tipAmount","visible","newState","payment","credit","selectConfiguration","selectFriendlyId","createSelector","selectProduction","selectCardEntryMethods","production","CardEntryMethods","DEFAULT","CARD_ENTRY_METHOD_MANUAL","selectConfigurationLoading","setError","setActions","selectConnection","selectConnector","setStatus","text","initialDevices","setItem","btoa","setConfiguration","setDeviceId","setDevices","setPermissions","dispatch","getState","persist","fetchDevices","Error","fetchSettings","selectRawDevices","selectDeviceId","selectDevices","sort","b","setConnector","find","factory","CloverConnectorFactoryBuilder","createICloverConnectorFactory","FACTORY_VERSION","VERSION_12","createICloverConnector","WebSocketCloudCloverDeviceConfigurationBuilder","setCloverServer","setFriendlyId","setForceConnect","build","Listener","keys","getPrototypeOf","forEach","ICloverConnectorListener","listener","addCloverConnectorListener","initializeConnection","setActiveTransaction","hideTransaction","updateTransaction","showWelcomeScreen","resolve","setTimeout","en","i18n","use","LanguageDetector","initReactI18next","init","fallbackLng","debug","keySeparator","nsSeparator","interpolation","escapeValue","resources","action","resetDevice","selectError","appendBuffer","selectBuffer","selectRawTransactions","selectTransactions","selectActiveTransaction","selectActiveTransactionType","selectActiveTransactionAmount","selectPaymentTransactions","t","selectVisiblePaymentTransactions","selectTransactionMode","cardEntryMethods","CloverID","getNewId","SaleRequest","setAmount","setExternalId","setCardEntryMethods","sale","ManualRefundRequest","manualRefund","orderId","VoidPaymentRequest","setPaymentId","setOrderId","setVoidReason","VoidReason","USER_CANCEL","voidPayment","store","middleware","applyMiddleware","thunk","devTools","__REDUX_DEVTOOLS_EXTENSION__","enhancer","f","createStore","compose","config","configure","selectActions","selectTransactionAction","selectNonTransactionActions","selectRawSettings","selectEmployee","selectEmployeeRoles","roles","selectPermissions","selectCreditEnabled","employeeRoles","employeeRoleIds","permissionRoleIds","Set","p","name","has","selectVoidEnabled","selectSignature","selectSignatureBounds","bounds","points","point","x","X","y","Y","Math","min","max","Infinity","selectSignatureLines","selectStatus","selectVisible","autoCorrect","autoComplete","autoCapitalize","spellCheck","disabled","onChange","other","useTranslation","useState","show","setShow","toggle","useCallback","label","useMemo","title","help","className","htmlFor","Button","color","outline","onFocus","Popover","trigger","isOpen","target","PopoverHeader","PopoverBody","source","linkTarget","event","checked","isSwitch","switch","mb0","classNames","xmlns","viewBox","aria-labelledby","role","data-name","transform","useDispatch","useSelector","setCloverDomain","setMerchantId","setEmployeeId","setAccessToken","setRaid","expanded","setExpanded","submitting","setSubmitting","submit","preventDefault","reset","onSubmit","onReset","Card","CardHeader","Logo","CardBody","onClick","Collapse","TextField","required","pattern","maxLength","CheckboxField","CardFooter","stopPropagation","cloud","cloudStatus","key","serial","onMouseEnter","onMouseLeave","aria-label","Tooltip","placement","setDisabled","select","connect","Device","ACTION_CREATOR","acceptPayment","VerifySignatureRequest","setPayment","acceptSignature","disconnect","showMessage","InputOption","setDescription","setKeyPress","keyPress","invokeInputOption","rejectPayment","rejectSignature","showWelcome","transaction","MODE","HISTORY","lines","fill","stroke","tranType","tranAmount","Signature","measure","el","scale","fontSize","style","parentElement","offsetWidth","offsetHeight","scrollWidth","scrollHeight","children","minScale","maxScale","ref","useRef","useEffect","current","resize","attempts","mid","classList","add","forwardRef","ref$","keyCodes","moreActions","moreText","onMoreClick","keydown","addEventListener","removeEventListener","k","ButtonDropdown","DropdownToggle","caret","DropdownMenu","right","DropdownItem","innerRef","ScaleText","transactionAction","transactionMode","creditEnabled","actionClicked","setActionClicked","keysDisabled","onAction","actionHandler","keyRef","keyHeight","setKeyHeight","submitOptions","action1","action2","Key","setMode","onShowWelcome","onDisconnect","m","readOnly","divider","start","final","partial","remaining","removeToast","useToasts","voidEnabled","voidableUntil","minutes","voidable","setVoidable","ms","to","clearTimeout","parseAmounts","onRemaining","doTransaction","onVoid","Table","orderRef","cardTransaction","cardType","first6","last4","repeat","trim","card","cardholderName","autoDismiss","addToast","appearance","Transaction","autoDismissTimeout","onDismiss","showTransaction","useShowTransaction","sortedTransactions","compareDesc","hover","striped","format","parseTimestamp","parseAmount","Menu","Screen","Keys","History","querySelectorAll","querySelector","remove","mouse","setMouse","onHover","useMouse","useError","expires","handler","touches","click","body","passive","usePreventDoubleTapZoom","useTransactions","Configuration","Devices","Keypad","Boolean","hostname","match","ReactDOM","render","StrictMode","App","getElementById","navigator","serviceWorker","ready","registration","unregister","console"],"mappings":"kk7BAAaA,EACK,iBADLA,EAEO,mBAFPA,EAGC,aAHDA,EAID,WAJCA,EAKU,sBALVA,EAMK,iBANLA,EAOO,mBAPPA,EAQJ,QARIA,EASG,eATHA,EAUE,cAVFA,EAWO,mBAIPC,EACQ,oBAGRC,EAAQ,eAClBD,EAAwB,qBAGdE,EAAcC,OAAOC,YAAYD,OAAOE,QAAQJ,GAAUK,KAAI,SAAAC,GAAG,OAAIA,EAAIC,cAEzEC,EAAS,yBAETC,EAAa,CACxBC,qBAAsB,uBACtBC,sBAAuB,wBACvBC,cAAe,iBAGJC,EAAe,uBAIfC,EACL,OADKA,EAEH,SAFGA,EAGL,OCxCO,K,yBCMFC,EAAM,WACjB,IACE,OAAOC,KAAKC,MAAMC,KAAKC,aAAaC,QF2BjB,0BE3BqC,aACxD,MAAOC,GACP,OAAO,OCLLC,EAAKC,IAAGN,MAAMO,OAAOC,SAASC,QAC9BC,EAAOJ,IAAGN,MAAMO,OAAOC,SAASE,MAChCC,EAAUC,IAeD,GACbC,aAdsB,WAAO,IAAD,EAOc,EAN1C,GAAIC,SAASC,SAAU,CACrB,IAAMA,EAAW,IAAIC,IAAIF,SAASC,UAClC,GAAIA,EAASE,OAAOC,SAAS,cAC3B,OAAOH,EAASI,WAGpB,cAAIR,QAAJ,IAAIA,GAAJ,UAAIA,EAASS,qBAAb,aAAI,EAAwBP,cAC1B,OAAOF,QAAP,IAAOA,GAAP,UAAOA,EAASS,qBAAhB,aAAO,EAAwBP,aAE1BtB,EAIO8B,GACdC,WAAYjB,EAAGkB,cAAH,OAAkBZ,QAAlB,IAAkBA,GAAlB,UAAkBA,EAASS,qBAA3B,aAAkB,EAAwBE,aAAc,GACpEE,WAAYnB,EAAGoB,cAAH,OAAkBd,QAAlB,IAAkBA,GAAlB,UAAkBA,EAASS,qBAA3B,aAAkB,EAAwBI,aAAc,GACpEE,YAAahB,EAAKiB,eAAL,OAAqBhB,QAArB,IAAqBA,GAArB,UAAqBA,EAASS,qBAA9B,aAAqB,EAAwBM,cAAe,GACzEE,KAAMvB,EAAGuB,OAAH,OAAWjB,QAAX,IAAWA,GAAX,UAAWA,EAASS,qBAApB,aAAW,EAAwBQ,OAAQ,GACjDC,YAAmB,OAAPlB,QAAO,IAAPA,GAAA,UAAAA,EAASS,qBAAT,eAAwBS,aAAc,iBAClDC,cAAc,EACdC,aAASC,G,iBC9BI,GACbC,UAAW,KACXC,WAAW,GCGPC,EAAqB,SAAAF,GAAa,IAG9BG,EAAcH,EAAUI,OAAxBD,UAERH,EAAUI,OAAOD,UAAY,SAACE,EAAWC,EAAOC,GAK9C,MAJoB,WAAhBA,IAEFF,EAAUG,oBAAsBH,EAAUI,mBAErCN,EAAUO,KAAKV,EAAUI,OAAQC,EAAWC,EAAOC,KAIxDI,EAAa,SAAAX,GACjB,IAEW,OAATA,QAAS,IAATA,KAAWY,UACX,MAAOzC,MCrBLO,EAAUC,IAED,IACbkC,KAAM,GACNC,UAAiB,OAAPpC,QAAO,IAAPA,GAAA,UAAAA,EAASqC,eAAT,eAAkBD,WAAY,ICN3B,IACbE,QAAS,KACTC,MAAO,KACPC,eAAWnB,GCHE,IACboB,SAAU,KACVC,YAAa,MCFA,IACbC,MAAO,EACPC,OAAQ,EACRC,QAAS,I,qCCGIC,GANI,SAAbA,EAAcC,EAAD,WAAQC,eAAR,MAAkB,EAAlB,EAAwBC,EAAxB,mCACjBC,MAAMH,EAAKE,GAASE,OAAM,SAAA1D,GACxB,GAAIuD,EAAU,EAAG,OAAOF,EAAWC,EAAD,aAAQC,QAASA,EAAU,GAAMC,IACnE,MAAMxD,MCAG2D,GAAa,SAAC,GAAD,IAAGlD,EAAH,EAAGA,aAAcS,EAAjB,EAAiBA,WAAY0C,EAA7B,EAA6BA,SAAUtC,EAAvC,EAAuCA,YAAvC,OACxB+B,GAAW,IAAIzC,IAAJ,uBAAwBM,EAAxB,mBAA6C0C,EAA7C,iBAAsEnD,GAAcM,WAAY,CACzG8C,OAAQ,MACRC,QAAS,CACPC,OAAQ,mBACR,eAAgB,mBAChBC,cAAc,UAAD,OAAY1C,MAE1B2C,MAAK,SAAAC,GAAC,OAAIA,EAAEC,WAEJvB,GAAU,SAAC,GAAD,IAAGnC,EAAH,EAAGA,aAAcS,EAAjB,EAAiBA,WAAYI,EAA7B,EAA6BA,YAA7B,OACrB+B,GAAW,IAAIzC,IAAJ,wBAAyBM,EAAzB,YAA+CT,GAAcM,WAAY,CAClF8C,OAAQ,MACRC,QAAS,CACPC,OAAQ,mBACR,eAAgB,mBAChBC,cAAc,UAAD,OAAY1C,MAE1B2C,MAAK,SAAAC,GAAC,OAAIA,EAAEC,WAEJnB,GAAW,SAAC,GAAD,IAAGvC,EAAH,EAAGA,aAAcS,EAAjB,EAAiBA,WAAYE,EAA7B,EAA6BA,WAAYE,EAAzC,EAAyCA,YAAzC,OACtB+B,GAAW,IAAIzC,IAAJ,wBAAyBM,EAAzB,sBAAiDE,EAAjD,iBAA4EX,GAAcM,WAAY,CAC/G8C,OAAQ,MACRC,QAAS,CACPC,OAAQ,mBACR,eAAgB,mBAChBC,cAAc,UAAD,OAAY1C,MAE1B2C,MAAK,SAAAC,GAAC,OAAIA,EAAEC,WAEJC,GAAiB,SAAC,GAAwF,IAAtF3D,EAAqF,EAArFA,aAAcS,EAAuE,EAAvEA,WAAYI,EAA2D,EAA3DA,YAA2D,IAA9C+C,mBAA8C,MAAhCxF,OAAOyF,OAAOlF,GAAkB,EAC9GkE,EAAM,IAAI1C,IAAJ,wBAAyBM,EAAzB,oBAAuDT,GAMnE,OALA6C,EAAIiB,aAAaC,IAAI,SAAU,SAC/BlB,EAAIiB,aAAaC,IAAI,QAAS,MAC9B,OAAIH,QAAJ,IAAIA,OAAJ,EAAIA,EAAaI,SACfnB,EAAIiB,aAAaC,IAAI,SAArB,mBAA2CH,EAAYrF,KAAI,SAAA0F,GAAC,iBAAQA,EAAR,QAAcC,KAAK,KAA/E,MAEKtB,GAAWC,EAAIvC,WAAY,CAChC8C,OAAQ,MACRC,QAAS,CACPC,OAAQ,mBACR,eAAgB,mBAChBC,cAAc,UAAD,OAAY1C,MAE1B2C,MAAK,SAAAC,GAAC,OAAIA,EAAEC,WC5CXS,GAAc,SAACC,EAAGC,GACtB,IAAMC,EAAMnG,EAAYkG,EAAEE,SAC1B,OAAOD,EAAG,2BAAQF,GAAR,kBAAYE,GAAM,IAASF,GAGjCI,GAAkB,SAACC,EAAOC,GAAR,OACtBD,EAAME,QACJ,SAACN,EAAGD,GACF,IAAMQ,EAAOP,EAAEA,EAAEL,OAAS,GAM1B,OALIY,EAAKZ,SAAWU,EAClBL,EAAEQ,KAAK,CAACT,IAERQ,EAAKC,KAAKT,GAELC,IAET,CAAC,MAGL,4CAAe,8CAAAA,EAAA,6DAASrE,EAAT,EAASA,aAAcS,EAAvB,EAAuBA,WAAYI,EAAnC,EAAmCA,YAAnC,SACciE,GAAY,CAAE9E,eAAcS,aAAYI,gBADtD,gBACLkE,EADK,EACLA,SACF5C,EAAU4C,EAASC,QAAO,SAAAC,GAAC,OAAIlG,EAAamG,KAAKD,EAAEE,gBAGnDC,EAAaZ,GAAgBrC,EAAS,GACnCkD,EAAI,EANA,YAMGA,EAAID,EAAWpB,QANlB,kCAQWsB,QAAQC,IAC5BH,EAAWC,GAAG9G,KAAI,gBAAO4E,EAAP,EAAGqC,GAAH,OAAsBV,GAAe,CAAE9E,eAAcS,aAAYI,cAAasC,iBATvF,QAQXiC,EAAWC,GARA,eAM0BA,IAN1B,8BAYPI,EAAOL,EAAWM,OAZX,kBAcNvD,EAAQ5D,KAAI,SAACiD,EAAQ6D,GAAT,mBAAC,eACf7D,GADc,IAEjBiE,KAAMA,EAAKJ,GAAGM,aAAahB,OAAOR,GAAa,UAhBpC,4CAAf,sD,SCpBA,4CAAe,4CAAAE,EAAA,6DAASrE,EAAT,EAASA,aAAcS,EAAvB,EAAuBA,WAAYI,EAAnC,EAAmCA,YAAaF,EAAhD,EAAgDA,WAAhD,SACyB2E,QAAQC,IAAI,CAChDT,GAAa,CAAE9E,eAAcS,aAAYE,aAAYE,gBAAeoC,OAAM,kBAAM,QAChF6B,GAAmB,CAAE9E,eAAcS,aAAYI,gBAAeoC,OAAM,kBAAM,UAH/D,2CACNV,EADM,KACIC,EADJ,uBAKN,CAAED,WAAUC,gBALN,2CAAf,sDCFaoD,GAAW,SAAAC,GACtB,IAAM5B,GAAK4B,EACX,OAAKC,MAAM7B,IAAMA,GAAK,GACZA,EAAI,KAAK8B,oBAAe5E,EAAW,CAAE6E,sBAAuB,EAAGC,sBAAuB,IAEzF,ICHM,IACbC,OAAQ,KACRC,KAAMnH,EACNoH,KAAM,ICoBOC,GAbKC,YAAgB,CAClCC,QCRa,WAA8C,IAA7CC,EAA4C,uDAApCC,EAAoC,yCAApBC,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QAC5C,OAAQD,GACN,ICNyB,eDOvB,OAAOD,EACT,ICT0B,gBDUxB,IAAMG,EAAQJ,EAAMK,MAAK,SAAAxC,GAAC,eAAIA,EAAEqC,OAASC,EAAQD,OAAQ,UAAArC,EAAEsC,eAAF,eAAWG,gBAAX,UAA2BH,EAAQA,eAAnC,aAA2B,EAAiBG,gBACrG,OAAOF,EAAQJ,EAAH,sBAAeA,GAAf,CAAsBG,IAEpC,ICXuB,aDYrB,OAAOA,GAAW,GACpB,IEd0B,eFexB,MAAO,CAAC,CAAED,KAAM1I,EAAmB2I,QAAS,CAAEG,YAAa,YAC7D,IAAK,4BAEL,IAAK,oCACH,MAAO,CAAC,CAAEJ,KAAM1I,GAAmB,CAAE0I,KAAM1I,IAC7C,IAAK,oCACH,OAAO2I,EAAQI,aAAaxI,KAAI,SAAAyI,GAAE,MAAK,CAAEN,KAAM1I,EAA4B2I,QAASK,MACtF,IAAK,6BACL,IAAK,oCACL,IAAK,qCACH,MAAO,CAAC,CAAEN,KAAM1I,GAAmB,CAAE0I,KAAM1I,IAC7C,IAAK,sCACH,MAAO,CACL,CAAE0I,KAAM1I,EAAuB2I,WAC/B,CAAED,KAAM1I,EAAuB2I,YAEnC,IAAK,uCACH,MAAO,CACL,CAAED,KAAM1I,EAAyB2I,WACjC,CAAED,KAAM1I,EAAyB2I,YAErC,QACE,OAAOH,IDxBXS,OIXa,WAA8C,IAA7CT,EAA4C,uDCH7C,GDG6C,yCAApBE,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QAC5C,OAAQD,GACN,IEJwB,cFKtB,MCNS,GDOX,IEPyB,eFQvB,OAAQF,EAAQG,GAASO,QAAQ,MAAO,IAAIC,MAAM,EAAG,GACvD,IEPsB,YFQpB,OAAOR,EACT,IERuB,aFSrB,OAAOH,EAAMxC,OAASwC,EAAMW,MAAM,EAAGX,EAAMxC,OAAS,GAAK,GAC3D,QACE,OAAOwC,IJCXjG,cOZa,WAA8C,IAA7CiG,EAA4C,uDAApCC,EAAoC,yCAApBC,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QAC5C,OAAQD,GACN,ICLiC,0BDM/B,OAAO,2BACFF,GADL,IAEEtF,SAAS,IAEb,ICTqC,6BDUnC,OAAO,2BACFsF,GADL,IAEEtF,aAASC,IAEb,ICb6B,mBDc3B,OAAO,2BACFqF,GADL,IAEExG,aAAc2G,EAAQ3G,cAAgB,GACtCS,WAAYkG,EAAQlG,YAAc,GAClCE,WAAYgG,EAAQhG,YAAc,GAClCI,KAAM4F,EAAQ5F,MAAQ,GACtBF,YAAa8F,EAAQ9F,aAAe,GACpCG,WAAY2F,EAAQ3F,YAAc,GAClCC,aAAc0F,EAAQ1F,eAAgB,IAE1C,QACE,OAAOuF,IPXXY,WXYa,WAA8C,IAAD,EAA5CZ,EAA4C,uDAApCC,EAAoC,yCAApBC,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QAC5C,OAAQD,GACN,Ic9B4B,iBdgC1B,OADA3E,EAAWyE,EAAMpF,WACVqF,EACT,IchC0B,edkCxB,OADA1E,EAAWyE,EAAMpF,WACV,2BACFoF,GADL,IAEEpF,UAAWuF,EACXtF,WAAW,IAEf,IAAK,4BACH,GACmB,gBAAjBsF,EAAQU,MACS,kBAAjBV,EAAQD,OADR,UAEAC,EAAQvE,eAFR,aAEA,EAAiB/B,SAAS,iBAC1B,CACA,IAAK,IAAD,GACF,UAAImG,EAAMpF,iBAAV,aAAI,EAAiBY,UACnBwE,EAAMpF,UAAUY,UAElB,MAAOzC,IAGT,OAAOkH,EAET,OAAOD,EACT,IAAK,mCACH,OAAO,2BAAKA,GAAZ,IAAmBnF,WAAW,IAChC,IAAK,4BACHC,EAAmBkF,EAAMpF,WACzB,IAAMkG,EAAU,IAAIC,IAAOC,UAAUC,4BAIrC,OAHAH,EAAQI,oBAAmB,GAC3BlB,EAAMpF,UAAUuG,qBAAqBL,GAE9B,2BAAKd,GAAZ,IAAmBnF,WAAW,IAEhC,QACE,OAAOmF,IWlDXrE,QSda,WAA8C,IAAD,EAA5CqE,EAA4C,uDAApCC,GAAoC,yCAApBC,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QAC5C,OAAQD,GACN,ICL8B,eDM5B,OAAO,2BACFF,GADL,IAEEvE,KAAM,KAEV,ICTkC,gBDUhC,OAAO,2BACFuE,GADL,IAEEtE,SAAU,KAEd,ICZgC,cDa9B,OAAO,2BACFsE,GADL,IAEEtE,SAAUyE,GAAW,KAEzB,IClB4B,aDmB1B,OAAO,2BACFH,GADL,IAEEvE,KAAM0E,GAAW,KAErB,IAAK,4BACH,MACmB,gBAAjBA,EAAQU,MACS,kBAAjBV,EAAQD,OADR,UAEAC,EAAQvE,eAFR,aAEA,EAAiB/B,SAAS,iBAEnBoG,GAEFD,EACT,QACE,OAAOA,ITjBXoB,MWfa,WAA8C,IAAD,EAA5CpB,EAA4C,uDAApCC,GAAoC,yCAApBC,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QAC5C,OAAQD,GACN,ICLuB,aDMrB,OAAOD,GACT,ICNqB,WDOnB,OAAO,2BACFD,GADL,IAEEpE,QAASuE,EAAQvE,QACjBC,MAAOsE,EAAQtE,MACfC,UAAWqE,EAAQrE,YAEvB,IAAK,4BACH,MACmB,gBAAjBqE,EAAQU,MACS,kBAAjBV,EAAQD,OADR,UAEAC,EAAQvE,eAFR,aAEA,EAAiB/B,SAAS,iBAEnB,2BACFmG,GADL,IAEEpE,QAAS,oEACTC,MAAOnD,KAAK2I,UAAUlB,EAAS,KAAM,GACrCrE,eAAWnB,IAGR,2BACFqF,GADL,IAEEpE,QAAQ,gBAAD,OAAkBuE,EAAQvE,SACjCC,MAAOnD,KAAK2I,UAAUlB,EAAS,KAAM,GACrCrE,eAAWnB,IAEf,IAAK,qCACL,IAAK,6BACL,IAAK,oCACH,OAAKwF,EAAQmB,QAQNtB,EAPE,2BACFA,GADL,IAEEpE,QAASuE,EAAQvE,QACjBC,MAAOnD,KAAK2I,UAAUlB,EAAS,KAAM,GACrCrE,WAAW,IAIjB,QACE,OAAOkE,IX3BXuB,SahBa,WAA8C,IAA7CvB,EAA4C,uDAApCC,GAAoC,yCAApBC,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QAC5C,OAAQD,GACN,ICL6B,cDM3B,OAAO,2BACFF,GADL,IAEEjE,SAAUoE,IAEd,ICTgC,iBDU9B,OAAO,2BACFH,GADL,IAEEhE,YAAamE,IAEjB,QACE,OAAOH,IbIXwB,UejBa,WAA8C,IAAD,MAA5CxB,EAA4C,uDAApCC,GAAoC,yCAApBC,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QAC5C,OAAQD,GACN,ICL2B,iBDMzB,OAAOD,GACT,ICNyB,eDOvB,MAAO,CACLhE,OAAc,OAAPkE,QAAO,IAAPA,OAAA,EAAAA,EAASlE,QAAS,EACzBC,QAAe,OAAPiE,QAAO,IAAPA,OAAA,EAAAA,EAASjE,SAAU,EAC3BC,SAAgB,OAAPgE,QAAO,IAAPA,OAAA,EAAAA,EAAShE,UAAW,IAEjC,IAAK,uCACH,MAAO,CACLF,OAAO,UAAAkE,EAAQqB,iBAAR,eAAmBvF,QAAS,EACnCC,QAAQ,UAAAiE,EAAQqB,iBAAR,eAAmBtF,SAAU,EACrCC,SAAS,UAAAgE,EAAQqB,iBAAR,eAAmBrF,UAAW,IAE3C,QACE,OAAO6D,IfCXyB,OiBlBa,WAA8C,IAA7CzB,EAA4C,uDCH7C,GDG6C,yCAApBE,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QAC5C,OAAQD,GACN,IELwB,cFMtB,MAAO,GACT,IENsB,YFOpB,OAAOC,GAAW,GACpB,IAAK,4BAEL,IAAK,oCACH,MAAO,QACT,IAAK,oCACH,OAAOA,EAAQvE,QACjB,IAAK,6BACL,IAAK,oCACL,IAAK,qCACH,MAAO,QACT,IAAK,sCACH,OAAOuE,EAAQuB,WAAW,GAAG9F,QAC/B,IAAK,uCACH,MAAO,mBACT,QACE,OAAOoE,IjBFX2B,aoBlBa,WAA8C,IAAD,EAA5C3B,EAA4C,uDAApCC,GAAoC,yCAApBC,EAAoB,EAApBA,KAAMC,EAAc,EAAdA,QAC5C,OAAQD,GACN,ICD6B,qBDE3B,OAAO,2BACFF,GADL,IAEEL,KAAMQ,IAEV,ICX+B,uBDY7B,GAAIA,EAAQnB,GAAI,CACd,IAAM4C,EAAM5B,EAAMJ,KAAKO,EAAQnB,KAAO,GAEtC,OAAO,2BACFgB,GADL,IAEEN,OAAQS,EAAQnB,GAChBY,KAAK,2BACAI,EAAMJ,MADP,kBAEDO,EAAQnB,GAFP,2BAGGgB,EAAMJ,KAAKO,EAAQnB,KAHtB,IAIAA,GAAImB,EAAQnB,GACZ6C,UAAWC,KAAKC,MAChB7B,KAAMC,EAAQD,MAAQ0B,EAAI1B,KAC1B8B,OAAQ7B,EAAQ6B,QAAUJ,EAAII,QAAU,EACxCC,UAAW9B,EAAQ8B,WAAaL,EAAIK,WAAa,QAKzD,OAAO,2BACFjC,GADL,IAEEN,OAAQ,KAGZ,IChC6B,kBDiC3B,OAAO,2BACFM,GADL,IAEEJ,KAAK,2BACAI,EAAMJ,MADP,kBAEDO,EAFC,2BAGGH,EAAMJ,KAAKO,IAHd,IAIA+B,SAAS,QAIjB,IC5C6B,kBD6C3B,OAAO,2BACFlC,GADL,IAEEJ,KAAK,2BACAI,EAAMJ,MADP,kBAEDO,EAFC,2BAGGH,EAAMJ,KAAKO,IAHd,IAIA+B,SAAS,QAIjB,ICzD+B,oBD0D7B,IAAMC,EAAQ,2BACTnC,GADS,IAEZJ,KAAK,eAAMI,EAAMJ,QAGnB,cADOuC,EAASvC,KAAKO,GACdgC,EAET,IChE+B,oBDiE7B,IAAMP,EAAM5B,EAAMJ,KAAKO,EAAQnB,KAAO,GAEtC,OAAO,2BACFgB,GADL,IAEEJ,KAAK,2BACAI,EAAMJ,MADP,kBAEDO,EAAQnB,GAFP,2BAGG4C,GAHH,IAIA5C,GAAImB,EAAQnB,GACZ6C,UAAWC,KAAKC,MAChBG,QAAS/B,EAAQ+B,SAAWN,EAAIM,UAAW,EAC3CF,OAAQ7B,EAAQ6B,QAAUJ,EAAII,QAAU,EACxCC,UAAW9B,EAAQ8B,WAAaL,EAAIK,WAAa,EACjD/B,KAAMC,EAAQD,MAAQ0B,EAAI1B,MAAQ,GAClCkC,QAASjC,EAAQiC,SAAWR,EAAIQ,SAAW,WAKnD,IAAK,6BACH,GAAIjC,EAAQmB,QACV,OAAO,2BACFtB,GADL,IAEEN,OAAQ,GACRE,KAAK,2BACAI,EAAMJ,MADP,kBAEDO,EAAQiC,QAAQ/G,kBAFf,2BAGG2E,EAAMJ,KAAKO,EAAQiC,QAAQ/G,oBAH9B,IAIA2D,GAAImB,EAAQiC,QAAQ/G,kBACpBwG,UAAWC,KAAKC,MAChBG,SAAS,EACThC,KAAM1H,EACN4J,QAASjC,EAAQiC,cAKzB,IAAMD,EAAQ,2BACTnC,GADS,IAEZN,OAAQ,KAGV,cADOyC,EAASvC,KAAKI,EAAMN,QACpByC,EAET,IAAK,qCACH,GAAIhC,EAAQmB,QACV,OAAO,2BACFtB,GADL,IAEEN,OAAQ,GACRE,KAAK,2BACAI,EAAMJ,MADP,kBAEDO,EAAQkC,OAAOjH,oBAFd,2BAGG4E,EAAMJ,KAAKO,EAAQkC,OAAOjH,sBAH7B,IAIA4D,GAAImB,EAAQkC,OAAOjH,oBACnByG,UAAWC,KAAKC,MAChBG,SAAS,EACThC,KAAM1H,EACN4J,QAASjC,EAAQkC,aAKzB,IAAMF,EAAQ,2BACTnC,GADS,IAEZN,OAAQ,KAGV,cADOyC,EAASvC,KAAKI,EAAMN,QACpByC,EAET,IAAK,oCACH,GAAIhC,EAAQmB,QACV,OAAO,2BACFtB,GADL,IAEEN,OAAQ,GACRE,KAAK,2BACAI,EAAMJ,MADP,kBAEDO,EAAQiC,QAAQ/G,kBAFf,2BAGG2E,EAAMJ,KAAKO,EAAQiC,QAAQ/G,oBAH9B,IAIA2D,GAAImB,EAAQiC,QAAQ/G,kBACpBwG,UAAWC,KAAKC,MAChBG,SAAS,EACThC,KAAM1H,EACN4J,QAASjC,EAAQiC,cAKzB,IAAMR,EAAM5B,EAAMJ,KAAKI,EAAMN,QAC7B,OAAO,OAAHkC,QAAG,IAAHA,OAAA,EAAAA,EAAK1B,QAAS1H,EACT,2BACFwH,GADL,IAEEN,OAAQ,GACRE,KAAK,2BACAI,EAAMJ,MADP,kBAEDgC,EAAI5C,GAFH,2BAGGgB,EAAMJ,KAAKgC,EAAI5C,KAHlB,IAIAkB,KAAM1H,QAKPwH,EAET,IAAK,4BACH,MACmB,gBAAjBG,EAAQU,MACS,kBAAjBV,EAAQD,OADR,UAEAC,EAAQvE,eAFR,aAEA,EAAiB/B,SAAS,iBAEnBoG,GAEFD,EACT,QACE,OAAOA,M,SE/KAsC,GAAsB,SAAAtC,GAAK,OAAIA,EAAMjG,eAErCwI,GAAmBC,aAAeF,IAAqB,qBAAG9H,YAA+B,oBAEzFiI,GAAmBD,aAAeF,IAAqB,qBAAG9I,eAAoCtB,KAE9FwK,GAAyBF,aAAeC,IAAkB,SAAAE,GAAU,OAC/EA,EACI5B,IAAO6B,iBAAiBC,QAExB9B,IAAO6B,iBAAiBC,QAAU9B,IAAO6B,iBAAiBE,4BAGnDC,GAA6BP,aAAeF,IAAqB,qBAAG5H,UAAyB,KCd7FsI,GAAW,wEAAiC,GAA9BpH,EAAH,EAAGA,QAASC,EAAZ,EAAYA,MAAOC,EAAnB,EAAmBA,UAAnB,MAAyC,CAC/DoE,KXJuB,WWKvBC,QAAS,CAAEvE,UAASC,QAAOC,eCGhBmH,GAAa,SAAAlD,GAAO,MAAK,CACpCG,KtBRyB,asBSzBC,QAASJ,ICTEmD,GAAmB,SAAAlD,GAAK,OAAIA,EAAMY,YAElCuC,GAAkBX,aAAeU,IAAkB,qBAAGtI,aCAtDwI,IDEkBZ,aAAeU,IAAkB,qBAAGrI,aCF1C,SAAAwI,GAAI,MAAK,CAChCnD,KPJwB,YOKxBC,QAASkD,KCHI,mBzCDIhE,EyCCDtF,EAAH,EAAGA,cAAe4B,EAAlB,EAAkBA,QAAlB,OzCDI0D,EyCEL,CACVtF,cAAc,2BACTA,GADQ,IAEXU,kBAAcE,EACdD,aAASC,IAEXgB,QAAQ,2BACH2H,IADE,IAEL5H,SAAUC,EAAQD,iBzCTtB7C,aAAa0K,QFgCQ,wBEhCSC,KAAK9K,KAAK2I,UAAUhC,M0CDvCoE,GAAmB,SAAC,GAAD,MAQzB,CACLvD,KpBT+B,mBoBU/BC,QAAS,CAAE3G,aAVmB,EAC9BA,aASyBS,WAVK,EAE9BA,WAQqCE,WAVP,EAG9BA,WAOiDI,KAVnB,EAI9BA,KAMuDF,YAVzB,EAK9BA,YAKoEG,WAVtC,EAM9BA,WAIgFC,aAVlD,EAO9BA,gBCHWiJ,GAAc,SAAA/G,GAAQ,MAAK,CACtCuD,KnBJkC,cmBKlCC,QAASxD,IAGEgH,GAAa,SAAAhI,GAAO,MAAK,CACpCuE,KnBV8B,amBW9BC,QAASxE,ICNEiI,GAAiB,SAAAhE,GAAI,MAAK,CACrCM,KhBPkC,iBgBQlCC,QAASP,ICAI,mBAAGpG,EAAH,EAAGA,aAAcS,EAAjB,EAAiBA,WAAYE,EAA7B,EAA6BA,WAAYI,EAAzC,EAAyCA,KAAMF,EAA/C,EAA+CA,YAAaG,EAA5D,EAA4DA,WAAYC,EAAxE,EAAwEA,aAAxE,gDAA2F,WACxGoJ,EACAC,GAFwG,sBAAAjG,EAAA,+EAKhGgG,EAAS,CACb3D,KAAM,YACNC,QAAS,CAAE3G,eAAcS,aAAYE,aAAYI,OAAMF,cAAaG,aAAYC,kBAPoB,uBAShGoJ,ERhBuB,CAAE3D,KXFR,emBS+E,uBAUhG2D,EHJoC,CAAE3D,KpBfX,4BuBSqE,uBAYhG2D,EACJJ,GAAiB,CAAEjK,eAAcS,aAAYE,aAAYI,OAAMF,cAAaG,aAAYC,kBAbY,cAetGsJ,GAAQD,KAf8F,UAiBhFE,GAAa,CAAExK,eAAcS,aAAYM,OAAMJ,aAAYE,gBAjBqB,eAiBhGsB,EAjBgG,iBAkBhGkI,EAASF,GAAWhI,IAlB4E,WAoBjGA,EAAQ6B,OApByF,uBAqB9F,IAAIyG,MAAM,2BArBoF,WAwBjGtI,EAAQ0E,MAAK,SAAAxC,GAAC,OAAIA,EAAEoB,KAAKxH,MAxBwE,uBAyB9F,IAAIwM,MAAM,4DAzBoF,yBA4B9DC,GAAc,CAAE1K,eAAcS,aAAYE,aAAYI,OAAMF,gBA5BE,wBA4B9F0B,EA5B8F,EA4B9FA,SAAUC,EA5BoF,EA4BpFA,YA5BoF,UA6BhG6H,EDpC0B,CAClC3D,KhBH+B,cgBI/BC,QCkC6BpE,IA7B2E,yBA8BhG8H,EAASD,GAAe5H,IA9BwE,2EAgChG6H,EAASb,GAAS,EAAD,KAhC+E,mCAkChGa,EH1BuC,CAAE3D,KpBhBV,+BuBQiE,4FAA3F,yD,wCCPFiE,GAAmB,SAAAnE,GAAK,OAAIA,EAAMrE,SAElCyI,GAAiB5B,aAAe2B,IAAkB,qBAAGzI,YAErD2I,GAAgB7B,aAAe2B,GAAkBC,IAAgB,WAAWzH,GAAX,IAAGlB,EAAH,EAAGA,KAAH,OAC5E,YAAIA,GAAM6I,MAAK,SAACzG,EAAG0G,GAAJ,OAAW1G,EAAEmB,KAAOrC,GAAY,EAAI4H,EAAEvF,KAAOrC,EAAW,EAAI,QCHhE6H,GAAe,SAAA5J,GAAS,MAAK,CACxCsF,K9BJ4B,e8BK5BC,QAASvF,ICKI,YAAA+B,GAAQ,gDAAI,WAAOkH,EAAUC,GAAjB,wCAAAjG,EAAA,+EAEjBgG,EAAS,CAAE3D,KAAM,UAAWC,QAASxD,IAFpB,uBAGjBkH,EAASH,GAAY/G,IAHJ,UAKjBqD,EAAQ8D,IACdC,GAAQ/D,GANe,EAQ2DsC,GAAoBtC,GAA9FxG,EARe,EAQfA,aAAcS,EARC,EAQDA,WAAYM,EARX,EAQWA,KAAMF,EARjB,EAQiBA,YAAaG,EAR9B,EAQ8BA,WAAYC,EAR1C,EAQ0CA,aAC3DO,EAASqJ,GAAcrE,GAAOyE,MAAK,SAAAhG,GAAC,OAAIA,EAAEO,KAAOrC,KAThC,uBAWJ,IAAIsH,MAAJ,oBAXI,WAYlBjJ,EAAOiE,KAAKxH,GAZM,uBAYwB,IAAIwM,MAAM,oDAZlC,QAcjBS,EAAU3D,IAAO4D,8BAA8BC,8BAArC,eACb7D,IAAO4D,8BAA8BE,gBAAkB9D,IAAO4D,8BAA8BG,aAGzFlK,EAAY8J,EAAQK,uBACxB,IAAIhE,IAAOiE,+CAA+CzK,EAAMoC,EAAU1C,EAAYI,GACnF4K,gBAAgBzL,GAChB0L,cAAc1K,GACd2K,gBAAgB1K,GAChB2K,SAGCC,EA1BiB,oDA2BrB,aAAe,IAAD,8BACZ,eACAzN,OAAO0N,KAAK1N,OAAO2N,eAAe3N,OAAO2N,eAAP3N,OAAA,KAAAA,CAAA,MAA8B4N,SAAQ,SAAAtF,GACtE,EAAKA,GAAQ,SAAAC,GAAO,OAAI0D,EAAS,CAAE3D,KAAK,eAAD,OAAiBA,GAAQC,gBAHtD,EA3BO,UA0BAY,IAAOC,UAAUyE,0BAQlCC,EAAW,IAAIL,EACrBzK,EAAU+K,2BAA2BD,GAErC7B,EAASW,GAAa5J,IACtBiJ,EAAST,GAAU,qBAEnBxI,EAAUgL,uBAxCa,kDA0CvB/B,EAASb,GAAS,EAAD,KA1CM,0DAAJ,yDCTV6C,GAAuB,wEAAmC,GAAhC7G,EAAH,EAAGA,GAAIkB,EAAP,EAAOA,KAAM8B,EAAb,EAAaA,OAAQC,EAArB,EAAqBA,UAArB,MAA2C,CAC7E/B,KdHiC,uBcIjCC,QAAS,CAAEnB,KAAIkB,OAAM8B,SAAQC,eAalB6D,GAAkB,SAAA9G,GAAE,MAAK,CACpCkB,Kdd+B,kBce/BC,QAASnB,IAGE+G,GAAoB,SAAC,GAAD,MAA+C,CAC9E7F,KdrBiC,oBcsBjCC,QAAS,CAAEnB,GAFoB,EAAGA,GAEnBkB,KAFgB,EAAOA,KAEjB8B,OAFU,EAAaA,OAEfC,UAFE,EAAqBA,UAEZG,QAFT,EAAgCA,WChBlD,8DAAM,WAAOyB,EAAUC,GAAjB,gBAAAjG,EAAA,+EAEXgG,EAAS,CAAE3D,KAAM,eAFN,cAIXtF,EAAYuI,GAAgBW,KAJjB,SAMflJ,EAAUoL,oBANK,SAOT,IAAIlH,SAAQ,SAAAmH,GAAO,OAAIC,WAAWD,EAAS,QAPlC,wEAYjBrL,EAAUY,UAZO,UAcXqI,EHlB2B,CAAE3D,K9BFP,mBiCMX,yBAeX2D,EPjByB,CAAE3D,KnBJH,iB0BMb,yBAgBX2D,EAASgC,MAhBE,2EAkBXhC,EAASb,GAAS,EAAD,KAlBN,iEAAN,yD,6BCAA,IACbmD,G,OACA,Q,OACA,Q,OACA,Q,OACA,Q,QCLaC,QACZC,IAAIC,MACJD,IAAIE,MACJC,KAAK,CACJC,YAAa,CAAC,KAAM,QAAS,QAAS,QAAS,SAC/CC,OAAO,EACPC,aAAc,IACdC,aAAa,EACbC,cAAe,CAAEC,aAAa,GAC9BC,eCVW,YAAAC,GAAM,gDAAI,WAAOnD,EAAUC,GAAjB,UAAAjG,EAAA,sDACvB,IACEgG,EAAS,2BAAKmD,GAAN,IAAc9G,KAAM,WAC5B2D,EAAST,GAAU,oBACnBS,EfF+B,CAAE3D,KtBNR,iBqCUPiD,GAAgBW,KACxBmD,cACV,MAAOlO,GACP8K,EAASb,GAASjK,IATG,2CAAJ,yDCLRmO,GAAc,SAAAlH,GAAK,OAAIA,EAAMoB,OCM3B,YAAA4F,GAAM,gDAAI,WAAOnD,EAAUC,GAAjB,UAAAjG,EAAA,sDACvB,IACEgG,EAAS,2BAAKmD,GAAN,IAAc9G,KAAM,iBAC5B2D,EAAST,GAAU,UACnBS,EAASZ,GAAW,CAAC,CAAE/C,KAAM1I,GAAmB,CAAE0I,KAAM1I,MAEtC2L,GAAgBW,KACxBkC,oBACV,MAAOjN,GACP8K,EAASb,GAASjK,IATG,2CAAJ,yDCJRoO,GAAe,SAAA9H,GAAK,MAAK,CACpCa,KpCH2B,eoCI3BC,QAASd,ICJE+H,GAAe,SAAApH,GAAK,OAAIA,EAAMS,QCE9B4G,GAAwB,SAAArH,GAAK,OAAIA,EAAM2B,cAEvC2F,GAAqB9E,aAAe6E,IAAuB,gBAAGzH,EAAH,EAAGA,KAAH,OAAchI,OAAOyF,OAAOuC,MAEvF2H,GAA0B/E,aAAe6E,IAAuB,gBAAG3H,EAAH,EAAGA,OAAH,SAAWE,KAAgBF,MAE3F8H,GAA8BhF,aAAe+E,IAAyB,SAAA7H,GAAM,cAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAQQ,QAExFuH,GAAgCjF,aAC3C+E,IACA,SAAA7H,GAAM,QAAW,OAANA,QAAM,IAANA,OAAA,EAAAA,EAAQsC,SAAU,KAAY,OAANtC,QAAM,IAANA,OAAA,EAAAA,EAAQuC,YAAa,MAG7CyF,GAA4BlF,aAAe8E,IAAoB,SAAA3F,GAAY,OACtFA,EAAanD,QAAO,SAAAmJ,GAAC,OAAIA,EAAEvF,cAGhBwF,GAAmCpF,aAAekF,IAA2B,SAAA/F,GAAY,OACpGA,EAAanD,QAAO,SAAAmJ,GAAC,OAAIA,EAAEzF,cAGhB2F,GAAwBrF,aAAe6E,IAAuB,qBAAG1H,QCV/D,YAAAqH,GAAM,gDAAI,WAAOnD,EAAUC,GAAjB,kCAAAjG,EAAA,+EAELuI,GAFK,UAEfuB,EAFe,OAGrB9D,EAAS,2BAAKmD,GAAN,IAAc9G,KAAM,iBAEtBF,EAAQ8D,IACRrD,EAAS2G,GAAapH,GACtBpF,EAAYuI,GAAgBnD,GAC5B8H,EAAmBpF,GAAuB1C,GAC1CE,EAAO2H,GAAsB7H,GAEnC6D,ErBjB+B,CAAE3D,KtBNR,iB2CwBzB2D,EAAST,GAAU,kBACnBS,EHnB8B,CAAE3D,KpCNR,gBuC2BlB8B,GAAUvB,EAfK,uBAgBF,IAAIwD,MAAM,sBAhBR,YAiBjB3E,MAAM0C,GAjBW,uBAiBI,IAAIiC,MAAM,qBAjBd,aAkBjBjC,GAAU,GAAKA,EAAS,SAlBP,uBAkBwB,IAAIiC,MAAM,qBAlBlC,QAoBjBjF,EAAK+B,IAAOgH,SAASC,WACrB9H,IAAS1H,IAEXwG,EAAKA,EAAG2B,MAAM,EAAG,KAGnBkD,EAASgC,GAAqB,CAAE7G,KAAIkB,OAAM8B,YA1BrB,KA4Bb9B,EA5Ba,cA6Bd1H,EA7Bc,UAyCdA,EAzCc,2BA+BTsI,EAAU,IAAIC,IAAOC,UAAUiH,aAC7BC,UAAUlG,GAClBlB,EAAQqH,cAAcnJ,GACtB8B,EAAQsH,oBAAoBN,GAE5BjE,EAASkC,GAAkB,CAAE/G,KAAIkB,KAAM1H,EAAkBwJ,YAEzDpH,EAAUyN,KAAKvH,GAtCA,oCA2CTA,EAAU,IAAIC,IAAOC,UAAUsH,qBAC7BJ,UAAUlG,GAClBlB,EAAQqH,cAAcnJ,GACtB8B,EAAQsH,oBAAoBN,GAE5BjE,EAASkC,GAAkB,CAAE/G,KAAIkB,KAAM1H,EAAoBwJ,YAE3DpH,EAAU2N,aAAazH,GAlDR,mCAsDX,IAAImD,MAAJ,UAAa0D,EAAE,kCAAf,aAAqDzH,IAtD1C,0DAyDrB2D,EAASb,GAAS,EAAD,KACjBa,EAAS,CAAE3D,KAAM,8BA1DI,0DAAJ,yDCJN,YAAAkC,GAAO,gDAAI,WAAOyB,EAAUC,GAAjB,4BAAAjG,EAAA,kEAEtBgG,EAAS,CAAE3D,KAAM,cAAeC,QAASiC,IAEjCpD,EAAsDoD,EAAtDpD,GAAI3D,EAAkD+G,EAAlD/G,kBAAmBmN,EAA+BpG,EAA/BoG,QAASxG,EAAsBI,EAAtBJ,OAAQC,EAAcG,EAAdH,UAC1CrH,EAAYuI,GAAgBW,KAElCD,EtBT+B,CAAE3D,KtBNR,iB4CgBzB2D,EAAST,GAAU,qBACdpE,EATiB,sBASP,IAAIiF,MAAM,4BATH,OAYtBJ,EAASgC,GAAqB,CAAE7G,GAAI3D,EAAmB6E,KAD1C1H,EACgDwJ,SAAQC,gBAE/DnB,EAAU,IAAIC,IAAOC,UAAUyH,oBAC7BC,aAAa1J,GACrB8B,EAAQ6H,WAAWH,GACnB1H,EAAQ8H,cAAc7H,IAAO7F,MAAM2N,WAAWC,aAC9ClO,EAAUmO,YAAYjI,GAlBA,kDAoBtB+C,EAASb,GAAS,EAAD,KACjBa,EAAS,CAAE3D,KAAM,8BArBK,0DAAJ,yDCLhB8I,GCCS,SAAA/I,GACb,IAAMgJ,EAAaC,YAAgBC,KAG7BC,EAAWlQ,OAAOmQ,6BAClBC,EAAWF,EAAWA,IAAa,SAAAG,GAAC,OAAIA,GAE9C,OAAOC,YAAY3J,GAAaI,EAAcwJ,YAAQR,EAAYK,IDRtDE,MAAY7O,GAEpB+O,GAASpH,GAAoB0G,GAAMlF,YACzCkF,GAAMnF,SAAS8F,GAAUD,KAEVV,I,GAAAA,MELFY,GAAgB,SAAA5J,GAAK,OAAIA,EAAMD,SAE/B8J,GAA0BrH,aAAeoH,IAAe,SAAA7J,GAAO,OAC1EA,EAAQ0E,MAAK,SAAA5G,GAAC,OAAIA,EAAEqC,OAAS1I,QAGlBsS,GAA8BtH,aAAeoH,IAAe,SAAA7J,GACvE,IAAM/H,EAAM+H,EAAQvB,QAAO,SAAAX,GAAC,OAAIA,EAAEqC,OAAS1I,KAC3C,GAAmB,IAAfQ,EAAIwF,OAAc,CAAC,IAAD,mBACLxF,EADK,GACb6F,EADa,KACV0G,EADU,KAEpB,GAA+B,QAA3B,UAAA1G,EAAEsC,eAAF,eAAWG,cAAmD,SAA3B,UAAAiE,EAAEpE,eAAF,eAAWG,aAChD,MAAO,CAACiE,EAAG1G,GAGf,OAAO7F,KCfI+R,GAAoB,SAAA/J,GAAK,OAAIA,EAAMuB,UAEnCyI,GAAiBxH,aAAeuH,IAAmB,qBAAGhO,YAEtDkO,GAAsBzH,aAAewH,IAAgB,SAAAjO,GAAQ,oBAAIA,QAAJ,IAAIA,GAAJ,UAAIA,EAAUmO,aAAd,aAAI,EAAiB3L,YAElF4L,GAAoB3H,aAAeuH,IAAmB,gBAAG/N,EAAH,EAAGA,YAAH,cAAqBA,QAArB,IAAqBA,OAArB,EAAqBA,EAAauC,YAExF6L,GAAsB5H,aACjCyH,GACAE,IACA,SAACE,EAAerO,GACd,GAAIqO,GAAiBrO,EAAa,CAChC,IAAMsO,EAAkBD,EAActS,KAAI,SAAAkF,GAAC,OAAIA,EAAE+B,MAC3CuL,EAAoB,IAAIC,IAC5BxO,EACGwC,QAAO,SAAAiM,GAAC,OAAIA,EAAEC,OAASvS,EAAWE,yBAClCN,KAAI,SAAA0S,GAAC,uBAAIA,EAAEP,aAAN,aAAI,EAAS3L,SAASxG,KAAI,SAAAkF,GAAC,OAAIA,EAAE+B,SACtCE,QAEL,OAAOoL,EAAgBjK,MAAK,SAAArB,GAAE,OAAIuL,EAAkBI,IAAI3L,MAE1D,OAAO,KAIE4L,GAAoBpI,aAC/ByH,GACAE,IACA,SAACE,EAAerO,GACd,GAAIqO,GAAiBrO,EAAa,CAChC,IAAMsO,EAAkBD,EAActS,KAAI,SAAAkF,GAAC,OAAIA,EAAE+B,MAC3CuL,EAAoB,IAAIC,IAC5BxO,EACGwC,QAAO,SAAAiM,GAAC,OAAIA,EAAEC,OAASvS,EAAWG,iBAClCP,KAAI,SAAA0S,GAAC,uBAAIA,EAAEP,aAAN,aAAI,EAAS3L,SAASxG,KAAI,SAAAkF,GAAC,OAAIA,EAAE+B,SACtCE,QAEL,OAAOoL,EAAgBjK,MAAK,SAAArB,GAAE,OAAIuL,EAAkBI,IAAI3L,MAE1D,OAAO,KCzCE6L,GAAkB,SAAA7K,GAAK,OAAIA,EAAMwB,WAEjCsJ,GAAwBtI,aAAeqI,IAAiB,YAAkB,IAC/EE,EAD8E,EAAd5O,QAEnEpE,KAAI,qBAAGiT,UACP9L,OACAf,QACC,WAAiB8M,GAAjB,IAAGC,EAAH,EAAGA,EAAGC,EAAN,EAAMA,EAAGC,EAAT,EAASA,EAAGC,EAAZ,EAAYA,EAAZ,MAA4B,CAC1BH,EAAGI,KAAKC,IAAIL,EAAGD,EAAMC,GACrBC,EAAGG,KAAKE,IAAIL,EAAGF,EAAMC,GACrBE,EAAGE,KAAKC,IAAIH,EAAGH,EAAMG,GACrBC,EAAGC,KAAKE,IAAIH,EAAGJ,EAAMG,MAEvB,CAAEF,EAAGO,IAAUN,GAAIM,IAAUL,EAAGK,IAAUJ,GAAII,MAElD,MAAO,CAACV,EAAOG,EAAGH,EAAOK,EAAGL,EAAOI,EAAIJ,EAAOG,EAAGH,EAAOM,EAAIN,EAAOK,GAAG1N,KAAK,QAGhEgO,GAAuBlJ,aAAeqI,IAAiB,qBAAG1O,QAC7DpE,KAAI,qBAAGiT,OAAoBjT,KAAI,gBAAGmT,EAAH,EAAGA,EAAGE,EAAN,EAAMA,EAAN,gBAAiBF,EAAjB,YAAsBE,MAAK1N,KAAK,WCrB5DiO,GAAe,SAAA3L,GAAK,OAAIA,EAAMyB,Q,yFCG9BmK,GAAgBpJ,aAC3BW,GACAkB,IACA,SAACzJ,EAAWe,GAAZ,OAAyBf,IAAce,EAAQ6B,U,mDCDlC,eAWR,IAVLwB,EAUI,EAVJA,GAUI,IATJkB,YASI,MATG,OASH,MARJ2L,mBAQI,MARU,MAQV,MAPJC,oBAOI,MAPW,MAOX,MANJC,sBAMI,MANa,MAMb,MALJC,kBAKI,MALS,QAKT,EAJJ3M,EAII,EAJJA,MACA4M,EAGI,EAHJA,SACAC,EAEI,EAFJA,SACGC,EACC,uHACIxE,EAAMyE,eAANzE,EADJ,EAGoB0E,oBAAS,GAH7B,oBAGGC,EAHH,KAGSC,EAHT,KAIEC,EAASC,uBAAY,kBAAMF,GAAQ,SAAA3K,GAAG,OAAKA,OAAM,CAAC2K,IAElDG,EAAQC,mBAAQ,kBAAMhF,EAAE,GAAD,OAAI3I,EAAJ,aAAiB,CAACA,EAAI2I,IAC7CiF,EAAQD,mBAAQ,kBAAMhF,EAAE,GAAD,OAAI3I,EAAJ,UAAgB,MAAK,CAACA,EAAI2I,IACjDkF,EAAOF,mBAAQ,kBAAMhF,EAAE,GAAD,OAAI3I,EAAJ,SAAe,MAAK,CAACA,EAAI2I,IAErD,OACE,yBAAKmF,UAAU,cACb,2BAAOC,QAAS/N,EAAI8N,UAAU,WAC3BJ,EADH,IAEGG,GACC,oCACE,kBAACG,GAAA,EAAD,CACE9M,KAAK,SACLlB,GAAE,UAAKA,EAAL,QACFiO,MAAM,YACNC,SAAO,EACPhP,KAAK,KACL4O,UAAU,uBACVF,MAAM,OACNO,QAASX,GARX,KAYA,kBAACY,GAAA,EAAD,CAASC,QAAQ,QAAQC,OAAQhB,EAAME,OAAQA,EAAQe,OAAM,UAAKvO,EAAL,SAC3D,kBAACwO,GAAA,EAAD,KAAgBd,EAAhB,SACA,kBAACe,GAAA,EAAD,KACE,kBAAC,KAAD,CAAUC,OAAQb,EAAMc,WAAW,eAM7C,yCACE3O,GAAIA,EACJkB,KAAMA,EACN4M,UAAU,eACVF,MAAOA,EACPf,YAAaA,EACbC,aAAcA,EACdC,eAAgBA,EAChBC,WAAYA,EACZ3M,MAAOA,EACP6M,SAAU,SAAA0B,GAAK,OAAI1B,EAAS0B,EAAML,OAAOlO,QACzC4M,SAAUA,GACNE,MC5DG,eAAwF,IAArFnN,EAAoF,EAApFA,GAAI0N,EAAgF,EAAhFA,MAAOG,EAAyE,EAAzEA,KAAMgB,EAAmE,EAAnEA,QAAS3B,EAA0D,EAA1DA,SAAUD,EAAgD,EAAhDA,SAAkB6B,EAA8B,EAAtCC,OAAkBC,EAAoB,EAApBA,IAAQ7B,EAAY,uFAC5EE,oBAAS,GADmE,oBAC7FC,EAD6F,KACvFC,EADuF,KAE9FC,EAASC,uBAAY,kBAAMF,GAAQ,SAAA3K,GAAG,OAAKA,OAAM,CAAC2K,IAExD,OACE,yBAAKO,UAAWmB,KAAW,aAAc,CAAE,OAAQD,KACjD,yBAAKlB,UAAWmB,KAAW,iBAAkB,CAAE,gBAAiBH,EAAU,mBAAoBA,KAC5F,yCACE9O,GAAIA,EACJkB,KAAK,WACL4M,UAAU,uBACVe,QAASA,EACT3B,SAAU,kBAAMA,GAAU2B,IAC1B5B,SAAUA,GACNE,IAEN,2BAAOW,UAAU,kDAAkDC,QAAS/N,GACzE0N,EACAG,GACC,oCACE,kBAACG,GAAA,EAAD,CACE9M,KAAK,SACLlB,GAAE,UAAKA,EAAL,QACFiO,MAAM,YACNC,SAAO,EACPhP,KAAK,KACL4O,UAAU,uBACVF,MAAM,OACNO,QAASX,GARX,KAYA,kBAACY,GAAA,EAAD,CAASC,QAAQ,QAAQC,OAAQhB,EAAME,OAAQA,EAAQe,OAAM,UAAKvO,EAAL,SAC3D,kBAACwO,GAAA,EAAD,KAAgBd,EAAhB,SACA,kBAACe,GAAA,EAAD,KACE,kBAAC,KAAD,CAAUC,OAAQb,EAAMc,WAAW,kBCrCtC,eAAoB,IAAD,IAAhBzP,YAAgB,MAAT,GAAS,EACxByJ,EAAMyE,eAANzE,EACR,OACE,yBACEmF,UAAU,OACV9N,GAAG,kBACHkP,MAAM,6BACNjS,MAAOiC,EACPhC,OAAQgC,EACRiQ,QAAQ,kBACRC,kBAAgB,iBAChBC,KAAK,SAEL,2BAAOrP,GAAG,kBAAkB2I,EAAE,WAC9B,uBAAG3I,GAAG,kBAAkBsP,YAAU,iBAChC,0BAAM7P,EAAE,oDAAoD8P,UAAU,8BACtE,0BAAM9P,EAAE,qDAAqD8P,UAAU,8BACvE,0BAAM9P,EAAE,oDAAoD8P,UAAU,8BACtE,0BACE9P,EAAE,0HACF8P,UAAU,iCCbL,cAAO,IACZ5G,EAAMyE,eAANzE,EACF9D,EAAW2K,cACXzU,EAAgB0U,YAAYnM,IAC5B5H,EAAU+T,YAAY1L,IACtBb,EAAUuM,YAAY7C,IALT,EAOqBS,mBAAStS,EAAcP,cAP5C,oBAOZA,EAPY,KAOEkV,EAPF,OAQiBrC,mBAAStS,EAAcE,YARxC,oBAQZA,EARY,KAQA0U,EARA,OASiBtC,mBAAStS,EAAcI,YATxC,oBASZA,EATY,KASAyU,EATA,OAUmBvC,mBAAStS,EAAcM,aAV1C,oBAUZA,EAVY,KAUCwU,EAVD,OAWKxC,mBAAStS,EAAcQ,MAX5B,oBAWZA,EAXY,KAWNuU,EAXM,OAYiBzC,mBAAStS,EAAcS,YAZxC,oBAYZA,EAZY,KAYA0K,EAZA,OAaqBmH,mBAAStS,EAAcU,cAb5C,oBAaZA,EAbY,KAaE0K,EAbF,OAcakH,oBAAS,GAdtB,oBAcZ0C,EAdY,KAcFC,EAdE,KAebxC,EAASC,uBAAY,kBAAMuC,GAAY,SAAApN,GAAG,OAAKA,OAAM,CAACoN,IAfzC,EAiBiB3C,oBAAS,GAjB1B,oBAiBZ4C,EAjBY,KAiBAC,EAjBA,KAmBbjD,EAAWU,mBAAQ,kBAAMjS,GAAWuU,IAAY,CAACvU,EAASuU,IAE1DE,EAAS1C,sBAAW,yCACxB,WAAMmB,GAAN,UAAA/P,EAAA,sEAEI+P,EAAMwB,iBACNF,GAAc,GAHlB,SAIUrL,EACJ8F,GAAU,CAAEnQ,eAAcS,aAAYE,aAAYE,cAAaE,OAAMC,aAAYC,kBALvF,uBAQIyU,GAAc,GARlB,uEADwB,sDAYxB,CAACrL,EAAUrK,EAAcS,EAAYE,EAAYE,EAAaE,EAAMC,EAAYC,IAG5E4U,EAAQ5C,uBACZ,SAAAmB,GACEA,EAAMwB,iBACNV,EAAgB3U,EAAcP,cAC9BmV,EAAc5U,EAAcE,YAC5B2U,EAAc7U,EAAcI,YAC5B0U,EAAe9U,EAAcM,aAC7ByU,EAAQ/U,EAAcQ,MACtB2K,EAAcnL,EAAcS,YAC5B2K,EAAgBpL,EAAcU,gBAEhC,CACEV,EACA2U,EACAC,EACAC,EACAC,EACAC,EACA5J,EACAC,IAIJ,OAAKjD,EAGH,0BAAMoN,SAAUH,EAAQI,QAASF,GAC/B,kBAACG,GAAA,EAAD,CAAM1C,UAAU,iBACd,kBAAC2C,GAAA,EAAD,KACE,kBAACC,GAAD,MACA,4BAAK/H,EAAE,oBAERjN,GACC,kBAACiV,GAAA,EAAD,KACE,2CAGFjV,GACA,oCACE,kBAACiV,GAAA,EAAD,KACE,kBAAC3C,GAAA,EAAD,CAAQ9M,KAAK,SAAShC,KAAK,KAAK4O,UAAU,aAAaG,MAAM,OAAO2C,QAASpD,GAC1E7E,EAAE,iBADL,IACwBoH,EAAW,SAAM,UAEzC,kBAACc,GAAA,EAAD,CAAUvC,OAAQyB,GAChB,kBAACe,GAAD,CACE9Q,GAAG,eACHkB,KAAK,MACLb,MAAO7F,EACP0S,SAAUwC,EACVzC,SAAUA,EACV8D,UAAQ,IAEV,kBAACD,GAAD,CACE9Q,GAAG,aACHgR,QAAQ,oBACRC,UAAU,KACV5Q,MAAOpF,EACPiS,SAAUyC,EACV1C,SAAUA,EACV8D,UAAQ,IAEV,kBAACD,GAAD,CACE9Q,GAAG,aACHgR,QAAQ,oBACRC,UAAU,KACV5Q,MAAOlF,EACP+R,SAAU0C,EACV3C,SAAUA,IAEZ,kBAAC6D,GAAD,CACE9Q,GAAG,OACHgR,QAAQ,yBACR3Q,MAAO9E,EACP2R,SAAU4C,EACV7C,SAAUA,EACV8D,UAAQ,IAEV,kBAACD,GAAD,CACE9Q,GAAG,cACHgR,QAAQ,yDACR3Q,MAAOhF,EACP6R,SAAU2C,EACV5C,SAAUA,EACV8D,UAAQ,IAEV,kBAACD,GAAD,CAAW9Q,GAAG,aAAaK,MAAO7E,EAAY0R,SAAUhH,EAAe+G,SAAUA,IACjF,kBAACiE,GAAD,CACElR,GAAG,eACH0N,MAAO/E,EAAE,sBACTkF,KAAMlF,EAAE,qBACRkG,QAASpT,EACTyR,SAAU,kBAAM/G,GAAiB1K,IACjCuT,KAAG,MAIT,kBAACmC,GAAA,EAAD,KACE,kBAACnD,GAAA,EAAD,CAAQ9M,KAAK,SAAS+M,MAAM,UAAUhB,SAAUA,GAC7CtE,EAAE,YAEL,kBAACqF,GAAA,EAAD,CAAQ9M,KAAK,QAAQ+M,MAAM,YAAYH,UAAU,OAAOb,SAAUA,GAC/DtE,EAAE,cA9EI,MCjEViE,GAAgBpJ,aAC3BW,GACAkB,IACA,SAACzJ,EAAWe,GAAZ,OAAyBf,KAAee,EAAQ6B,U,UCAnC,eAA4C,IAAzCxC,EAAwC,EAAxCA,OAAQ0E,EAAgC,EAAhCA,OAAQuM,EAAwB,EAAxBA,SAAU2D,EAAc,EAAdA,QAClCjI,EAAMyE,eAANzE,EADgD,EAEhC0E,oBAAS,GAFuB,oBAEjDC,EAFiD,KAE3CC,EAF2C,KAGlDvN,EAAK2N,mBAAQ,kCAAgB3R,EAAOgE,MAAM,CAAChE,EAAOgE,KAElDwN,EAAS,SAAAoB,GACTA,IACFA,EAAMwB,iBACNxB,EAAMwC,mBAER7D,GAASD,IAGL+D,EAAQrV,EAAOiE,KAAKxH,GACpB6Y,EAAc3I,EAAE,mBAAD,OAAoB0I,EAAQ,GAAK,KAAjC,cAErB,OACE,4BACEE,IAAKvV,EAAOgE,GACZkB,KAAK,SACL4M,UAAWmB,KACT,+FACA,CACEhC,WACA,2BAA4BA,GAAYvM,IAG5CkQ,QAASA,GAET,yBAAK9C,UAAU,OACZ9R,EAAO0P,MAAQ,yBAAKoC,UAAU,oBAAoB9R,EAAO0P,MACzD1P,EAAO2D,YAFV,IAEwB3D,EAAOwV,QAE/B,0BACExR,GAAIA,EACJyR,aAAc,kBAAMlE,GAAQ,IAC5BmE,aAAc,kBAAMnE,GAAQ,IAC5BqD,QAASpD,EACTM,UAAWmB,KAAW,YAAa,CACjC,kBAAmBhC,EACnB,iBAAkBA,GAAYoE,EAC9B,iBAAkBpE,IAAaoE,IAEjChC,KAAK,MACLsC,aAAYL,GAXd,gBAeA,kBAACM,GAAA,EAAD,CAAStD,OAAQhB,EAAMiB,OAAQvO,EAAIwN,OAAQA,EAAQqE,UAAU,QAC3D,0BAAM/D,UAAU,SAASwD,MC9ClB,cAAO,IACZ3I,EAAMyE,eAANzE,EACF9D,EAAW2K,cACX7S,EAAU8S,YAAYpK,IACtB1H,EAAW8R,YAAYrK,IACvBlC,EAAUuM,YAAY7C,IALT,EAMaS,qBANb,oBAMZJ,EANY,KAMF6E,EANE,KAQbC,EAAStE,uBACb,SAAAzN,GAAE,gDAAI,WAAM4O,GAAN,UAAA/P,EAAA,sEAEF+P,EAAMwB,iBACN0B,GAAY,GAHV,SAIIjN,EAASmN,GAAQhS,IAJrB,uBAMF8R,GAAY,GANV,uEAAJ,wDASF,CAACjN,IAKH,OAAK3B,EAGH,kBAACsN,GAAA,EAAD,CAAM1C,UAAU,WACd,kBAAC2C,GAAA,EAAD,KACE,kBAACC,GAAD,MACA,4BAAK/H,EAAE,mBACP,4BAAQmF,UAAU,mBAAmBF,MAAOjF,EAAE,UAAWiI,QAThD,kBAAM/L,E/B3BY,CAAE3D,KnBJH,kBkDwCgD+L,SAAUA,GAApF,SAIF,kBAAC0D,GAAA,EAAD,KACE,yBAAK7C,UAAU,cACb,+BAAQnF,EAAE,iBAAV,KACA,yBAAKmF,UAAU,cACZnR,EAAQ5D,KAAI,SAAAiD,GAAM,OACjB,kBAACiW,GAAD,CACEV,IAAKvV,EAAOgE,GACZhE,OAAQA,EACRiR,SAAUA,EACVvM,OAAQ1E,EAAOgE,KAAOrC,EACtBiT,QAASmB,EAAO/V,EAAOgE,aArBhB,MClBVkS,IAAc,qBACxB1Z,GCXY,SAAAwP,GAAM,gDAAI,WAAOnD,EAAUC,GAAjB,UAAAjG,EAAA,sDACvB,IACEgG,EAAS,2BAAKmD,GAAN,IAAc9G,KAAM,mBAC5B2D,EAAST,GAAU,4BACnBS,EtCF+B,CAAE3D,KtBNR,iB4DUPiD,GAAgBW,KACxBqN,cAAcnK,EAAO7G,QAAQiC,SACvC,MAAOrJ,GACP8K,EAASb,GAASjK,IATG,2CAAJ,2DDUM,eAExBvB,GETY,SAAAwP,GAAM,gDAAI,WAAOnD,EAAUC,GAAjB,kBAAAjG,EAAA,sDACvB,IACEgG,EAAS,2BAAKmD,GAAN,IAAc9G,KAAM,qBAC5B2D,EAAST,GAAU,8BACnBS,EvCL+B,CAAE3D,KtBNR,iB6DYzB2D,ECXiC,CAAE3D,KhDFR,mB+CerBtF,EAAYuI,GAAgBW,MAC5BhD,EAAU,IAAIC,IAAOC,UAAUoQ,wBAC7BC,WAAWrK,EAAO7G,QAAQiC,SAClCxH,EAAU0W,gBAAgBxQ,GAC1B,MAAO/H,GACP8K,EAASb,GAASjK,IAZG,2CAAJ,2DFOM,eAGxBvB,EAAoB+Z,IAHI,eAIxB/Z,GIXY,SAAAwP,GAAM,gDAAI,WAAOnD,EAAUC,GAAjB,sBAAAjG,EAAA,+EAELuI,GAFK,OAEfuB,EAFe,OAGrB9D,EAAS,2BAAKmD,GAAN,IAAc9G,KAAM,cAC5B2D,EAAST,GAAU,sBACnBS,EACEZ,GAAW,CACT,CAAE/C,KAAM1I,EAAqB2I,QAAS,CAAEG,YAAa,OACrD,CAAEJ,KAAM1I,EAAmB2I,QAAS,CAAEG,YAAa,cAIjDN,EAAQ8D,IACRlJ,EAAYuI,GAAgBnD,GAC5BxF,EAAa+H,GAAiBvC,GAEpCpF,EAAU4W,YAAV,UAAyBhX,EAAzB,YAAuCmN,EAAE,eAhBpB,kDAkBrB9D,EAASb,GAAS,EAAD,KAlBI,0DAAJ,2DJOM,eAKxBxL,GKfY,SAAAwP,GAAM,gDAAI,WAAOnD,EAAUC,GAAjB,kBAAAjG,EAAA,sDACvB,IACEgG,EAAS,2BAAKmD,GAAN,IAAc9G,KAAM,uBAEtBtF,EAAYuI,GAAgBW,MAC5BhD,EAAU,IAAIC,IAAOC,UAAUyQ,aAC7BC,eAAe1K,EAAO7G,QAAQG,aACtCQ,EAAQ6Q,YAAY3K,EAAO7G,QAAQyR,UACnChX,EAAUiX,kBAAkB/Q,GAC5B,MAAO/H,GACP8K,EAASb,GAASjK,IAVG,2CAAJ,2DLUM,eAMxBvB,GMhBY,SAAAwP,GAAM,gDAAI,WAAOnD,EAAUC,GAAjB,UAAAjG,EAAA,sDACvB,IACEgG,EAAS,2BAAKmD,GAAN,IAAc9G,KAAM,mBAC5B2D,EAAST,GAAU,4BACnBS,E3CF+B,CAAE3D,KtBNR,iBiEUPiD,GAAgBW,KACxBgO,cAAc9K,EAAO7G,QAAQiC,QAAS4E,EAAO7G,QAAQuB,WAAW,IAC1E,MAAO3I,GACP8K,EAASb,GAASjK,IATG,2CAAJ,2DNUM,eAOxBvB,GOdY,SAAAwP,GAAM,gDAAI,WAAOnD,EAAUC,GAAjB,kBAAAjG,EAAA,sDACvB,IACEgG,EAAS,2BAAKmD,GAAN,IAAc9G,KAAM,qBAC5B2D,EAAST,GAAU,8BACnBS,E5CL+B,CAAE3D,KtBNR,iBkEYzB2D,EJXiC,CAAE3D,KhDFR,mBoDerBtF,EAAYuI,GAAgBW,MAC5BhD,EAAU,IAAIC,IAAOC,UAAUoQ,wBAC7BC,WAAWrK,EAAO7G,QAAQiC,SAClCxH,EAAUmX,gBAAgBjR,GAC1B,MAAO/H,GACP8K,EAASb,GAASjK,IAZG,2CAAJ,2DPOM,eAQxBvB,EAAe6X,IARS,eASxB7X,EAAsBwa,IATE,eAUxBxa,EAAqBya,IAVG,eAWxBza,GAA0B,gBAAG2I,EAAH,EAAGA,QAAH,M1BCoB,CAC/CD,KdvB+B,qBcwB/BC,Q0BH+DA,E1BC5BR,S0BZV,IAcduS,GAAO,CAClB1Z,YAAa,cACb2Z,QAAS,WQ5BEvG,GAAgBpJ,aAAeW,IAAiB,SAAAvI,GAAS,QAAMA,KCC7D,eAAgC,IAAD,IAA5BqB,aAA4B,MAApB,IAAoB,EAAZkQ,EAAY,0BACtCpB,EAAS0D,YAAY3D,IACrBsH,EAAQ3D,YAAY/C,IAE1B,OAAK0G,EAAM5U,OAGT,yBAAKsP,UAAU,aACb,uCAAKqB,QAASpD,EAAQ9O,MAAOA,GAAWkQ,GACrCiG,EAAMra,KAAI,SAACiT,EAAQnM,GAAT,OACT,8BAAU0R,IAAK1R,EAAGmM,OAAQA,EAAQqH,KAAK,OAAOC,OAAO,eANnC,MCAb,cAAO,IACZ3K,EAAMyE,eAANzE,EACFlG,EAASgN,YAAY9C,IACrBlL,EAASgO,YAAYrH,IACrBmL,EAAW9D,YAAYjH,IACvBgL,EAAa/D,YAAYhH,IAE/B,OACE,yBAAKqF,UAAU,kCACV0F,GACD,yBAAK1F,UAAU,kGACb,yBAAKA,UAAU,eAAenF,EAAE,CAAC,eAAD,OAAgB4K,GAAYA,KAC5D,yBAAKzF,UAAU,oBAAoB1N,GAASoT,MAG9C/R,GAAU,6BAAMgB,GAClB,kBAACgR,GAAD,MACChS,GAAU,yBAAKqM,UAAU,cAAcrM,GACvCA,GAAU,wBAAIqM,UAAU,cAAc1N,GAASqB,M,kDCxBhDiS,GAAU,SAACC,EAAIC,GAAW,IACtBC,EAAaF,EAAGG,MAAhBD,SACRF,EAAGG,MAAMD,SAAT,UAAuBD,EAAvB,MAF6B,MAGoCD,EAAGI,cAA5DC,EAHqB,EAGrBA,YAAaC,EAHQ,EAGRA,aAAcC,EAHN,EAGMA,YAAaC,EAHnB,EAGmBA,aAEhD,OADAR,EAAGG,MAAMD,SAAWA,EACbvH,KAAKC,IAAIyH,EAAcE,EAAaD,EAAeE,IAAiB,GAe9D,eAAiD,IAA9CC,EAA6C,EAA7CA,SAA6C,IAAnCC,gBAAmC,MAAxB,GAAwB,MAAnBC,gBAAmB,MAAR,EAAQ,EACvDC,EAAMC,mBAkBZ,OAhBAC,qBAAU,WACR,IAAMd,EAAKY,EAAIG,QACXf,IACED,GAAQC,EAAIW,GACdX,EAAGG,MAAMD,SAAT,UAAuBS,EAAvB,OAEAX,EAAGG,MAAMD,SAAT,UAAuBQ,EAAvB,MACKX,GAAQC,EAAIU,GAtBV,SAATM,EAAUhB,EAAD,GAAoC,IAAD,oBAA7BpH,EAA6B,KAAxBC,EAAwB,KAAlBoI,EAAkB,uDAAP,GACzC,KAAIA,GAAY,GAAhB,CACA,IAAMC,GAAOrI,EAAMD,GAAO,EACtBmH,GAAQC,EAAIkB,IAEdlB,EAAGG,MAAMD,SAAT,UAAuBgB,EAAvB,MACAF,EAAOhB,EAAI,CAACkB,EAAKrI,GAAMoI,EAAW,IAElCD,EAAOhB,EAAI,CAACpH,EAAKsI,GAAMD,EAAW,IAiB5BD,CAAOhB,EAAI,CAACU,EAAUC,IAFtBX,EAAGmB,UAAUC,IAAI,qBAMtB,CAACT,EAAUD,EAAUE,IAEjB,0BAAMA,IAAKA,GAAMH,IClCXY,yBACb,WAEEC,GACI,IAFFjN,EAEC,EAFDA,OAAQ9K,EAEP,EAFOA,OAAQ+Q,EAEf,EAFeA,MAAOiH,EAEtB,EAFsBA,SAAUjI,EAEhC,EAFgCA,SAAU2D,EAE1C,EAF0CA,QAASuE,EAEnD,EAFmDA,YAAaC,EAEhE,EAFgEA,SAAUC,EAE1E,EAF0EA,YAAajB,EAEvF,EAFuFA,SAAajH,EAEpG,8HACKxE,EAAMyE,eAANzE,EADL,EAEqB0E,oBAAS,GAF9B,oBAEIC,EAFJ,KAEUC,EAFV,KAGGgH,EAAMU,GAAQT,mBAEdhH,EAASC,uBAAY,kBAAMF,GAAQ,SAAA3K,GAAG,OAAKA,OAAM,CAAC2K,IAExDkH,qBAAU,WACR,IAAKxH,EAAU,CACb,IAAMqI,EAAU,SAAA1G,GACd,OAAIsG,EAASra,SAAS+T,EAAM/M,QAC1B+M,EAAMwB,iBACNQ,KACO,IAKX,OADAnW,SAAS8a,iBAAiB,UAAWD,GAC9B,kBAAM7a,SAAS+a,oBAAoB,UAAWF,OAGtD,CAACrI,EAAUiI,EAAUtE,IAExB,IAAMvQ,EAAQsN,mBAAQ,WAAO,IAAD,EACpB4D,GAAY,OAANvJ,QAAM,IAANA,GAAA,UAAAA,EAAQ7G,eAAR,eAAiBG,eAAjB,OAAgC0G,QAAhC,IAAgCA,OAAhC,EAAgCA,EAAQ9G,MACpD,OAAOqQ,EAAM5I,EAAE,CAAC,UAAD,OAAW4I,GAAOA,IAAQ6C,IACxC,CAACpM,EAAQoM,EAAUzL,IAEhBiF,EAAQD,mBACZ,iBAAM,CAAChF,EAAE,iBAAkBuM,EAASnc,KAAI,SAAA0c,GAAC,OAAI9M,EAAE,CAAC,YAAD,OAAa8M,GAAKA,OAAK/W,KAAK,OAAOA,KAAK,QACvF,CAACwW,EAAUvM,IAGb,OAAIX,IAAM,OAAImN,QAAJ,IAAIA,OAAJ,EAAIA,EAAa3W,QAEvB,kBAACkX,GAAA,EAAD,CAAgBpH,OAAQhB,EAAME,OAAQA,GACpC,kBAACQ,GAAA,EAAD,eACEC,MAAM,OACNH,UAAU,sBACV8C,QAASA,EACT3D,SAAUA,EACVW,MAAOA,GACHT,GAEH9M,GAAS,uCAEZ,kBAACsV,GAAA,EAAD,CAAgBC,OAAK,EAAC3H,MAAM,OAAOH,UAAU,SAASb,SAAUA,IAChE,kBAAC4I,GAAA,EAAD,CAAc/H,UAAU,UAAUgI,OAAK,GACpCX,EAAYpc,KAAI,SAAC8F,EAAGgB,GAAJ,eACf,kBAACkW,GAAA,EAAD,CAAcxE,IAAK1R,EAAGiO,UAAU,qBAAqB8C,QAAS,kBAAMyE,EAAYxW,KAC7E8J,EAAE,CAAC,UAAD,QAAW,UAAA9J,EAAEsC,eAAF,eAAWG,cAAezC,EAAEqC,OAAQ,UAAArC,EAAEsC,eAAF,eAAWG,cAAezC,EAAEqC,cAQ1F,OAAIiU,QAAJ,IAAIA,OAAJ,EAAIA,EAAa3W,QAEb,yBAAKsP,UAAU,yCACb,kBAAC4H,GAAA,EAAD,CAAgBpH,OAAQhB,EAAME,OAAQA,GACpC,kBAACmI,GAAA,EAAD,CACEC,OAAK,EACL3H,MAAM,OACNC,SAAO,EACPhP,KAAK,KACL4O,UAAU,2BACVb,SAAUA,GAETmI,GAEH,kBAACS,GAAA,EAAD,CAAcC,OAAK,EAAChI,UAAU,WAC3BqH,EAAYpc,KAAI,SAAC8F,EAAGgB,GAAJ,eACf,kBAACkW,GAAA,EAAD,CAAcxE,IAAK1R,EAAGiO,UAAU,qBAAqB8C,QAAS,kBAAMyE,EAAYxW,KAC7E8J,EAAE,CAAC,UAAD,QAAW,UAAA9J,EAAEsC,eAAF,eAAWG,cAAezC,EAAEqC,OAAQ,UAAArC,EAAEsC,eAAF,eAAWG,cAAezC,EAAEqC,aAKtF,kBAAC8M,GAAA,EAAD,eACEE,SAAO,EACPD,MAAM,OACNH,UAAWmB,KAAW,QAAD,eAAkBhB,GAAS,UAChD2C,QAASA,EACT3D,SAAUA,EACVW,MAAOA,GACHT,GAEH9M,GAAS,wCAOhB,kBAAC2N,GAAA,EAAD,eACEgI,SAAUzB,EACVT,MAAO,CAAE5W,UACTgR,SAAUlG,EACViG,MAAM,OACNH,UAAWmB,KAAW,QAAD,OAAShB,GAAS,SAAW,CAAEjG,WACpDiF,SAAUA,EACV2D,QAASA,EACThD,MAAOA,GACHT,GAEJ,kBAAC8I,GAAD,CAAW1E,IAAKlR,EAAOgU,SAAUrM,EAAS,GAAM,EAAGsM,SAAU,GAC1DjU,OCrGI,cAAO,IACZsI,EAAMyE,eAANzE,EACF9D,EAAW2K,cACXzO,EAAU0O,YAAY3E,IACtBoL,EAAoBzG,YAAY5E,IAChCsL,EAAkB1G,YAAY5G,IAC9BuN,EAAgB3G,YAAYrE,IANf,EAQuBiC,oBAAS,GARhC,oBAQZgJ,EARY,KAQGC,EARH,KASbC,EAAe5I,mBAAQ,kBAAOuI,GAAqBG,IAAe,CAACH,EAAmBG,IAEtFG,EAAW/I,sBAAW,yCAC1B,WAAMzF,GAAN,UAAAnJ,EAAA,6DACEyX,GAAiB,GACbtO,EAAO9G,OAAS1I,GAA8BwP,EAAO9G,OAAS1I,GAChE0O,YAAW,kBAAMoP,GAAiB,KAAQ,KAH9C,SAKQzR,EAASqN,GAAelK,EAAO9G,MAAM8G,IAL7C,2CAD0B,sDAQ1B,CAACnD,EAAUyR,IAGPG,EAAgB,SAAAzO,GAAM,+BAAI,uBAAAnJ,EAAA,+EAAY2X,EAASxO,IAArB,4CAEhCyM,qBAAU,WACJ1T,EAAQvC,QAAQ8X,GAAiB,KACpC,CAACA,EAAkBvV,IAEtB,IAAM2V,EAASlC,mBA5BI,EA6BenH,qBA7Bf,oBA6BZsJ,EA7BY,KA6BDC,EA7BC,KA8BnBnC,qBAAU,WACJiC,EAAOhC,SACTkC,EAAaF,EAAOhC,QAAQV,eAE7B,CAAC0C,EAAQE,IAEZ,IAAMC,EAAgBlJ,mBACpB,kBACEyI,EACI,CACEhB,SAAUzM,EAAE,CAAC,eAAD,OAAgBwN,GAAmBA,IAC/ChB,YAAa,CACX,CACEjU,KAAM1I,EACN2I,QAAS,CAAEG,YAAa,mBAAoBX,KAAMnH,IAEpD,CACE0H,KAAM1I,EACN2I,QAAS,CAAEG,YAAa,qBAAsBX,KAAMnH,KAGxD6b,YAAa,SAAArN,GAAM,OAAIwO,EAASxO,UAElCrM,IACN,CAACya,EAAeI,EAAU7N,EAAGwN,IAtDZ,eAyDwBpV,GAApC+V,EAzDY,KAyDHC,EAzDG,KAyDS5B,EAzDT,WA2DnB,OACE,yBAAKrH,UAAU,QACb,yBAAKA,UAAU,kBACb,yBAAKA,UAAU,aACb,kBAACkJ,GAAD,CACEhP,OAAQ8O,GAAW,GACnB7J,UAAW6J,GAAWT,EACtBnB,SAAU,CAAC,KAAM,gBACjBtE,QAAS6F,EAAcK,MAG3B,yBAAKhJ,UAAU,aACb,kBAACkJ,GAAD,CACEhP,OAAQ+O,GAAW,GACnB9J,UAAW8J,GAAWV,EACtBnB,SAAU,CAAC,KAAM,kBACjBtE,QAAS6F,EAAcM,GACvB5B,YAAaA,EACbE,YAAa,SAAArN,GAAM,OAAIwO,EAASxO,QAItC,yBAAK8F,UAAU,kBACb,yBAAKA,UAAU,aACb,kBAACkJ,GAAD,CACEzC,IAAKmC,EACLxZ,OAAQyZ,EACR1J,SAAUsJ,EACVrB,SAAU,CAAC,UAAW,UACtBtE,QAAS,kBAAM/L,EAASsD,GAAa,QAEpCQ,EAAE,WAGP,yBAAKmF,UAAU,aACb,kBAACkJ,GAAD,CAAK/J,SAAUsJ,EAAcrB,SAAU,CAAC,UAAW,UAAWtE,QAAS,kBAAM/L,EAASsD,GAAa,QAChGQ,EAAE,WAGP,yBAAKmF,UAAU,aACb,kBAACkJ,GAAD,CAAK/J,SAAUsJ,EAAcrB,SAAU,CAAC,UAAW,UAAWtE,QAAS,kBAAM/L,EAASsD,GAAa,QAChGQ,EAAE,WAGP,yBAAKmF,UAAU,aACb,kBAACkJ,GAAD,CACE/I,MAAM,SACNhB,SAAUsJ,EACVrB,SAAU,CAAC,iBAAkB,UAC7BtE,QAAS,kBAAM/L,EhCvHO,CAAE3D,KpCNR,kBoE+HfyH,EAAE,YAIT,yBAAKmF,UAAU,kBACb,yBAAKA,UAAU,aACb,kBAACkJ,GAAD,CACE9Z,OAAQyZ,EACR1J,SAAUsJ,EACVrB,SAAU,CAAC,UAAW,UACtBtE,QAAS,kBAAM/L,EAASsD,GAAa,QAEpCQ,EAAE,WAGP,yBAAKmF,UAAU,aACb,kBAACkJ,GAAD,CAAK/J,SAAUsJ,EAAcrB,SAAU,CAAC,UAAW,UAAWtE,QAAS,kBAAM/L,EAASsD,GAAa,QAChGQ,EAAE,WAGP,yBAAKmF,UAAU,aACb,kBAACkJ,GAAD,CAAK/J,SAAUsJ,EAAcrB,SAAU,CAAC,UAAW,UAAWtE,QAAS,kBAAM/L,EAASsD,GAAa,QAChGQ,EAAE,WAGP,yBAAKmF,UAAU,aACb,kBAACkJ,GAAD,CACE/I,MAAM,UACNhB,SAAUsJ,EACVrB,SAAU,CAAC,YAAa,YAAa,UACrCtE,QAAS,kBAAM/L,EhChJM,CAAE3D,KpCXR,iBoE6JdyH,EAAE,YAIT,yBAAKmF,UAAU,kBACb,yBAAKA,UAAU,SACb,yBAAKA,UAAU,kBACb,yBAAKA,UAAU,aACb,kBAACkJ,GAAD,CACE9Z,OAAQyZ,EACR1J,SAAUsJ,EACVrB,SAAU,CAAC,UAAW,UACtBtE,QAAS,kBAAM/L,EAASsD,GAAa,QAEpCQ,EAAE,WAGP,yBAAKmF,UAAU,aACb,kBAACkJ,GAAD,CAAK/J,SAAUsJ,EAAcrB,SAAU,CAAC,UAAW,UAAWtE,QAAS,kBAAM/L,EAASsD,GAAa,QAChGQ,EAAE,WAGP,yBAAKmF,UAAU,aACb,kBAACkJ,GAAD,CAAK/J,SAAUsJ,EAAcrB,SAAU,CAAC,UAAW,UAAWtE,QAAS,kBAAM/L,EAASsD,GAAa,QAChGQ,EAAE,YAIT,yBAAKmF,UAAU,kBACb,yBAAKA,UAAU,aACb,kBAACkJ,GAAD,CACE9Z,OAAQyZ,EACR1J,SAAUsJ,EACVrB,SAAU,CAAC,UAAW,UACtBtE,QAAS,kBAAM/L,EAASsD,GAAa,QAEpCQ,EAAE,WAGP,yBAAKmF,UAAU,aACb,kBAACkJ,GAAD,CACE/J,SAAUsJ,EACVrB,SAAU,CAAC,gBAAiB,UAC5BtE,QAAS,kBAAM/L,EAASsD,GAAa,SAEpCQ,EAAE,cAKX,yBAAKmF,UAAU,aACb,kBAACkJ,GAAD,eACE/I,MAAM,UACNhB,SAAUsJ,EACVrB,SAAU,CAAC,cAAe,SAC1BtE,QAAS,kBAAM/L,EAASoO,QACpB4D,GAEHlO,EAAE,cCjNA,eAAwB,IAArBhI,EAAoB,EAApBA,KAAMsW,EAAc,EAAdA,QACdtO,EAAMyE,eAANzE,EACF9D,EAAW2K,cAFmB,EAGZnC,oBAAS,GAHG,oBAG7BC,EAH6B,KAGvBC,EAHuB,KAI9BC,EAASC,uBAAY,kBAAMF,GAASD,KAAO,CAACA,EAAMC,IAClD2J,EAAgBzJ,uBAAY,kBAAM5I,EAASmO,QAAgB,CAACnO,IAC5D0L,EAAU9C,uBAAY,kBAAM5I,EAASwL,QAAU,CAACxL,IAChDsS,EAAe1J,uBAAY,kBAAM5I,EAAS0N,QAAe,CAAC1N,IAEhE,OACE,kBAAC6Q,GAAA,EAAD,CAAgBpH,OAAQhB,EAAME,OAAQA,GACpC,kBAACmI,GAAA,EAAD,CAAgBzW,KAAK,KAAKgP,SAAO,EAACD,MAAM,OAAOH,UAAU,aAAa8C,QAASpD,EAAQI,MAAOjF,EAAE,SAAhG,UAGA,kBAACkN,GAAA,EAAD,CAAcC,OAAK,GAChBld,OAAOyF,OAAO6U,IAAMna,KAAI,SAAAqe,GAAC,OACxB,kBAACrB,GAAA,EAAD,CAAcxE,IAAK6F,EAAGxG,QAAS,kBAAMqG,EAAQG,KAC3C,kBAAClG,GAAD,CAAelR,GAAE,eAAUoX,GAAK1J,MAAO/E,EAAE,CAAC,QAAD,OAASyO,GAAKA,IAAKvI,QAASuI,IAAMzW,EAAM0W,UAAQ,EAACrI,KAAG,QAGjG,kBAAC+G,GAAA,EAAD,CAAcuB,SAAO,IACrB,kBAACvB,GAAA,EAAD,CAAcnF,QAASsG,GAAgBvO,EAAE,iBACzC,kBAACoN,GAAA,EAAD,CAAcnF,QAASL,GAAU5H,EAAE,iBACnC,kBAACoN,GAAA,EAAD,CAAcnF,QAASuG,GAAexO,EAAE,kB,wCChCjC,eAAqC,IAAlC3F,EAAiC,EAAjCA,OAAQC,EAAyB,EAAzBA,UAAWG,EAAc,EAAdA,QAC7BmU,GAASvU,GAAU,IAAMC,GAAa,GACtCuU,IAAgB,OAAPpU,QAAO,IAAPA,OAAA,EAAAA,EAASJ,SAAU,KAAa,OAAPI,QAAO,IAAPA,OAAA,EAAAA,EAASH,YAAa,GAG9D,MAAO,CAAEsU,QAAOC,QAAOC,QAFPF,EAAQC,EAEQE,UADdH,EAAQC,ICcb,eAAsB,IAAD,IAAlBvE,EAAkB,EAAlBA,YAAkB,EACOA,GAAe,GAAhDjT,EAD0B,EAC1BA,GAAI6C,EADsB,EACtBA,UAAW3B,EADW,EACXA,KAAMkC,EADK,EACLA,QACrBuF,EAAMyE,eAANzE,EACF9D,EAAW2K,cACTmI,EAAgBC,sBAAhBD,YACFE,EAAcpI,YAAY7D,IAC1B7I,EAAMD,KAAKC,MACX+U,EAAgB/C,aAAIlS,EAAW,CAAEkV,QAAS,KAPd,EAQF1K,mBAASwK,GAAe9U,GAAO+U,GAR7B,oBAQ3BE,EAR2B,KAQjBC,EARiB,KAUlCxD,qBAAU,WACR,GAAIuD,EAAU,CACZ,IAAME,EAAKJ,EAAgB/U,EAC3B,GAAImV,EAAK,EAAG,CACV,IAAMC,EAAKjR,YAAW,kBAAM+Q,GAAY,KAAQC,GAChD,OAAO,kBAAME,aAAaD,QAI7B,CAACpV,EAAKkV,EAAaD,EAAUF,IAnBE,MAqBHO,GAAapF,GAApCwE,EArB0B,EAqB1BA,QAASC,EArBiB,EAqBjBA,UAEXY,EAAc7K,sBAAW,wBAAC,uBAAA5O,EAAA,+EAEtBgG,EnClCuB,CACjC3D,KpCRwB,YoCSxBC,QmCgC6BuW,GnChCX,KmC8Bc,uBAGtB7S,EAAS0T,MAHa,wEAKtB1T,EAASb,GAAS,EAAD,KALK,yDAO7B,CAAC0T,EAAW7S,IAET2T,EAAS/K,sBAAW,wBAAC,uBAAA5O,EAAA,sEAEvB8Y,EAAY3X,GAFW,SAGjB6E,EAASiC,GAAgB9G,IAHR,uBAIjB6E,EAASkF,GAAY3G,IAJJ,wEAMjByB,EAASb,GAAS,EAAD,KANA,yDAQxB,CAACa,EAAU7E,EAAIoD,EAASuU,IAE3B,OACE,yBAAK7J,UAAU,eACZmF,EAAY/R,OAAS1H,GAAoBie,GACxC,yBAAK3J,UAAU,uBACb,wBAAIA,UAAU,iBAAiBnF,EAAE,oBACjC,6BACGA,EAAE,aADL,KACqBvI,GAASsX,KAIlC,4BACG/O,EAAE,CAAC,eAAD,OAAgBzH,GAAQA,IAD7B,IACsCyH,EAAE,YAExC,kBAAC8P,GAAA,EAAD,CAAOvZ,KAAK,KAAK4O,UAAU,cACzB,+BACE,4BACE,4BAAKnF,EAAE,cAAP,KACA,4BAAKvF,EAAQpD,KAEdoD,EAAQ/G,mBACP,4BACE,4BAAKsM,EAAE,eAAP,KACA,4BAAKvF,EAAQ/G,oBAGhB+G,EAAQhH,qBACP,4BACE,4BAAKuM,EAAE,gBAAP,KACA,4BAAKvF,EAAQhH,sBAGjB,4BACE,4BAAKuM,EAAE,YAAP,KACA,6BAAK,UAAAvF,EAAQlH,aAAR,eAAe8D,MAAf,UAAqBoD,EAAQsV,gBAA7B,aAAqB,EAAkB1Y,QAE3CoD,EAAQH,WACT,4BACE,4BAAK0F,EAAE,SAAP,KACA,4BAAKvI,GAASgD,EAAQJ,OAASI,EAAQH,aAG3C,4BACE,4BAAK0F,EAAE,UAAP,KACA,4BAAKvI,GAASgD,EAAQJ,YAErBI,EAAQH,WACT,4BACE,4BAAK0F,EAAE,OAAP,KACA,4BAAKvI,GAASgD,EAAQH,aAG1B,4BACE,4BAAK0F,EAAE,QAAP,KACA,4BACE,6BAAMA,EAAE,CAAC,QAAD,OAASvF,EAAQuV,gBAAgBC,UAAYxV,EAAQuV,gBAAgBC,YAC7E,6B/E3GM,SAAC,GAAD,IAAGC,EAAH,EAAGA,OAAQC,EAAX,EAAWA,MAAX,MAAuB,CAACD,EAAQ,IAAIE,OAAO,GAAID,GAAOpa,KAAK,IAAIgD,QAAQ,QAAS,OAAOsX,O+E2GvFC,CAAK7V,EAAQuV,kBAClBvV,EAAQuV,gBAAgBO,gBACvB,6BACGvQ,EAAE,CAAC,mBAAD,OACkBvF,EAAQuV,gBAAgBO,gBAC3C9V,EAAQuV,gBAAgBO,sBAQrCjG,EAAY/R,OAAS1H,GACpB,6BACGie,GACC,kBAACzJ,GAAA,EAAD,CAAQC,MAAM,UAAU/O,KAAK,KAAK4O,UAAU,OAAO8C,QAAS0H,GACzD3P,EAAE,WADL,IACkBvI,GAASsX,IAG5BM,GACC,kBAAChK,GAAA,EAAD,CAAQC,MAAM,SAAS/O,KAAK,KAAK0R,QAAS4H,GACvC7P,EAAE,YChIF,YAAAwQ,GACb,IAAMtU,EAAW2K,cACT4J,EAAaxB,sBAAbwB,SAER,OAAO,SAAAnG,GAAgB,IAGjBoG,EAFI5B,EAAYY,GAAapF,GAAzBwE,QAGmC4B,EAAvCpG,EAAY/R,OAAS1H,EAA+B,OAC/Cie,EAAsB,UACb,UAElB2B,EAAS,kBAACE,GAAD,CAAarG,YAAaA,IAAiB,CAClDjT,GAAIiT,EAAYjT,GAChBqZ,aACAF,YAAaA,IAAgB1B,EAC7B8B,mBAAoB,IACpBC,UAAW,WACT3U,EAASiC,GAAgBmM,EAAYjT,UCZ9B,cAAO,IACZ2I,EAAMyE,eAANzE,EACFhG,EAAe8M,YAAY/G,IAC3B+Q,EAAkBC,KAElBC,EAAqBhM,mBAAQ,kBAAMhL,EAAa2C,MAAK,SAACzG,EAAG0G,GAAJ,OAAUqU,aAAY/a,EAAEgE,UAAW0C,EAAE1C,gBAAa,CAC3GF,IAGF,OACE,yBAAKmL,UAAU,WACb,kBAAC2K,GAAA,EAAD,CAAOvZ,KAAK,KAAK2a,OAAK,EAAC/L,UAAU,kBAAkBgM,SAAO,GACxD,+BACE,4BACE,4BAAKnR,EAAE,SACP,4BAAKA,EAAE,SACP,wBAAImF,UAAU,cAAcnF,EAAE,aAGlC,+BACGgR,EAAmB5gB,KAAI,SAAAka,GAAW,OACjC,wBAAI1B,IAAK0B,EAAYjT,GAAIqP,KAAK,SAASuB,QAAS,kBAAM6I,EAAgBxG,KACpE,4BAxBS,SAAC,GAAD,IAAGpQ,EAAH,EAAGA,UAAH,OAAoBA,EAAYkX,aAAOlX,EAAW,cAAgB,KAwBtEmX,CAAe/G,IACpB,4BAAKtK,EAAE,eAAD,OAAgBsK,EAAY/R,QAClC,wBAAI4M,UAAU,cA7BR,SAAC,GAAD,IAAG9K,EAAH,EAAGA,OAAQC,EAAX,EAAWA,UAAWG,EAAtB,EAAsBA,QAAtB,OAClBhD,GAASgD,GAAWA,EAAQJ,QAAU,IAAMI,EAAQH,WAAa,IAAMD,GAAU,IAAMC,GAAa,IA4B5DgX,CAAYhH,YCzBvC,I,OAAA,WAAO,IACZtK,EAAMyE,eAANzE,EACFzF,EAAUuM,YAAY7C,IAFT,EAIKS,mBAAS6F,GAAK1Z,aAJnB,oBAIZmH,EAJY,KAINsW,EAJM,KAMnB,OAAK/T,EAGH,kBAACsN,GAAA,EAAD,CAAM1C,UAAU,UACd,kBAAC2C,GAAA,EAAD,KACE,kBAACC,GAAD,MACA,4BAAK/H,EAAE,mBACP,kBAACuR,GAAD,CAAMvZ,KAAMA,EAAMsW,QAASA,KAE7B,kBAACtG,GAAA,EAAD,KACGhQ,IAASuS,GAAK1Z,aAAe,kBAAC2gB,GAAD,MAC7BxZ,IAASuS,GAAK1Z,aAAe,kBAAC4gB,GAAD,MAC7BzZ,IAASuS,GAAKC,SAAW,kBAACkH,GAAD,QAZX,OCfR,eAAgB,IAAbjY,EAAY,EAAZA,MACRxF,EAAmBwF,EAAnBxF,QAASC,EAAUuF,EAAVvF,MACT8L,EAAMyE,eAANzE,EAFoB,EAGI0E,oBAAS,GAHb,oBAGrB0C,EAHqB,KAGXC,EAHW,KAmB5B,OATAyE,qBAAU,WACR,OAAO,WACaha,SAAS6f,iBAAiB,mBAAmB9b,QAAUuR,EAAW,EAAI,IAEtFtV,SAAS8f,cAAc,yCAAyCzF,UAAU0F,OAAO,eAGpF,CAACzK,IAGF,yBAAKjC,UAAWmB,KAAW,QAAS,CAAEc,cACpC,4BAAKpH,EAAE,CAAC,SAAD,OAAU/L,GAAWA,OACzBC,IAAUkT,GACX,kBAAC/B,GAAA,EAAD,CAAQC,MAAM,OAAO/O,KAAK,QAAQ0R,QAlBzB,WACbnW,SAAS8f,cAAc,yCAAyCzF,UAAUC,IAAI,YAC9E/E,GAAY,KAiBLrH,EAAE,mBAGJ9L,GAASkT,GACV,yBAAKjC,UAAU,QACb,8BAAOjR,MCtBF,I,OAAA,WACb,IAAM4d,ECXO,WAAO,IAAD,EACOpN,oBAAS,GADhB,oBACZoN,EADY,KACLC,EADK,KAYnB,OATAjG,qBAAU,WACR,IAAKgG,EAAO,CACV,IAAME,EAAU,kBAAMD,GAAS,IAE/B,OADAjgB,SAAS8a,iBAAiB,YAAaoF,GAChC,kBAAMlgB,SAAS+a,oBAAoB,YAAamF,OAGxD,CAACF,EAAOC,IAEJD,EDDOG,GAKd,OEXa,SAAAzB,GACb,IAAMtU,EAAW2K,cACXpN,EAAQqN,YAAYvH,IAClBkR,EAAaxB,sBAAbwB,SAER3E,qBAAU,WACJrS,EAAMxF,SACRwc,EAAS,kBAAC,GAAD,CAAOhX,MAAOA,IAAW,CAChCpC,GAAI,QACJqZ,WAAY,QACZF,YAAaA,IAAgB/W,EAAMtF,UACnC0c,UAAW,WACT3U,E7DjBuB,CAAE3D,KXFR,oBwEuBtB,CAACkY,EAAUvU,EAAUzC,EAAO+W,IFT/B0B,CAASJ,GGZI,wEAAgB,GAAhB,IAAGvC,UAAH,MAAQ,IAAR,EACbzD,qBAAU,WACR,IAAIqG,EAAU,EACRC,EAAU,SAAAnM,GACd,GAA6B,IAAzBA,EAAMoM,QAAQxc,OAAc,CAC9B,IAAMuE,EAAMD,KAAKC,MACY,IAAzB6L,EAAMoM,QAAQxc,QAAgBuE,EAAM+X,IACtClM,EAAMwB,iBAENxB,EAAML,OAAO0M,SAEfH,EAAU/X,EAAMmV,IAMpB,OAFAzd,SAASygB,KAAK3F,iBAAiB,aAAcwF,EAAS,CAAEI,SAAS,IAE1D,kBAAM1gB,SAASygB,KAAK1F,oBAAoB,aAAcuF,EAAS,CAAEI,SAAS,OAChF,CAACjD,IHLJkD,GITa,SAAAjC,GACb,IAAMxW,EAAe8M,YAAY7G,IAC3B6Q,EAAkBC,GAAmBP,GAE3C1E,qBAAU,WACR9R,EAAa6D,QAAQiT,KACpB,CAAC9W,EAAc8W,IJIlB4B,CAAgBZ,GAGd,yBAAK3M,UAAWmB,KAAW,2BACzB,kBAACqM,GAAD,MACA,kBAACC,GAAD,MACA,kBAACC,GAAD,SKVcC,QACW,cAA7BvhB,OAAOC,SAASuhB,UAEe,UAA7BxhB,OAAOC,SAASuhB,UAEhBxhB,OAAOC,SAASuhB,SAASC,MACvB,2DCRNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,IAAD,CAAe9R,MAAOA,IACpB,kBAAC,gBAAD,CAAe6H,UAAU,iBACvB,kBAACkK,GAAD,SAINthB,SAASuhB,eAAe,SDiHpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBne,MAAK,SAAAoe,GACJA,EAAaC,gBAEd5e,OAAM,SAAA2E,GACLka,QAAQla,MAAMA,EAAMxF,c","file":"static/js/main.d2e44d4c.chunk.js","sourcesContent":["export const ACTION = {\n  ACCEPT_PAYMENT: 'ACCEPT_PAYMENT',\n  ACCEPT_SIGNATURE: 'ACCEPT_SIGNATURE',\n  DISCONNECT: 'DISCONNECT',\n  IDENTIFY: 'IDENTIFY',\n  INVOKE_INPUT_OPTION: 'INVOKE_INPUT_OPTION',\n  REJECT_PAYMENT: 'REJECT_PAYMENT',\n  REJECT_SIGNATURE: 'REJECT_SIGNATURE',\n  RESET: 'RESET',\n  SHOW_WELCOME: 'SHOW_WELCOME',\n  TRANSACTION: 'TRANSACTION',\n  TRANSACTION_MODE: 'TRANSACTION_MODE',\n  VOID_PAYMENT: 'VOID_PAYMENT',\n};\n\nexport const APP = {\n  CLOUD_PAY_DISPLAY: 'CLOUD_PAY_DISPLAY',\n};\n\nexport const APP_NAME = {\n  [APP.CLOUD_PAY_DISPLAY]: 'Cloud Pay Display',\n};\n\nexport const APP_BY_NAME = Object.fromEntries(Object.entries(APP_NAME).map(arr => arr.reverse()));\n\nexport const DOMAIN = 'https://www.clover.com';\n\nexport const PERMISSION = {\n  MANUAL_ENTRY_ALLOWED: 'MANUAL_ENTRY_ALLOWED',\n  PERFORM_MANUAL_REFUND: 'PERFORM_MANUAL_REFUND',\n  VOID_PAYMENTS: 'VOID_PAYMENTS',\n};\n\nexport const REG_PRODUCTS = /^(Flex|Mini|Mobile)/i;\n\nexport const STORAGE = 'clover/virtual-keypad';\n\nexport const TRANSACTION = {\n  SALE: 'SALE',\n  CREDIT: 'CREDIT',\n  VOID: 'VOID',\n};\n","export default [];\n","import { STORAGE } from './constants';\n\nexport const set = value => {\n  localStorage.setItem(STORAGE, btoa(JSON.stringify(value)));\n};\n\nexport const get = () => {\n  try {\n    return JSON.parse(atob(localStorage.getItem(STORAGE) || 'bnVsbA=='));\n  } catch (e) {\n    return null;\n  }\n};\n","import QS from 'query-string';\n\nimport { DOMAIN } from '../../common/constants';\nimport * as Storage from '../../common/Storage';\n\nconst qs = QS.parse(window.location.search);\nconst hash = QS.parse(window.location.hash);\nconst storage = Storage.get();\n\nconst getCloverDomain = () => {\n  if (document.referrer) {\n    const referrer = new URL(document.referrer);\n    if (referrer.origin.includes('clover.com')) {\n      return referrer.toString();\n    }\n  }\n  if (storage?.configuration?.cloverDomain) {\n    return storage?.configuration?.cloverDomain;\n  }\n  return DOMAIN;\n};\n\nexport default {\n  cloverDomain: getCloverDomain(),\n  merchantId: qs.merchant_id || storage?.configuration?.merchantId || '',\n  employeeId: qs.employee_id || storage?.configuration?.employeeId || '',\n  accessToken: hash.access_token || storage?.configuration?.accessToken || '',\n  raid: qs.raid || storage?.configuration?.raid || '',\n  friendlyId: storage?.configuration?.friendlyId || 'Virtual Keypad',\n  forceConnect: false,\n  loading: undefined,\n};\n","export default {\n  connector: null,\n  connected: false,\n};\n","import Clover from 'remote-pay-cloud';\n\nimport * as CONST from './constants';\nimport initialState from './initialState';\n\nconst fixCreditPayIntent = connector => {\n  // HACK: CREDIT transactions do not properly relay externalId nor externalReferenceId\n  // We are going to override connector.device.doTxStart and populate the externalReferenceId from the externalPaymentId\n  const { doTxStart } = connector.device;\n  // eslint-disable-next-line no-param-reassign\n  connector.device.doTxStart = (payIntent, order, requestInfo) => {\n    if (requestInfo === 'CREDIT') {\n      // eslint-disable-next-line no-param-reassign\n      payIntent.externalReferenceId = payIntent.externalPaymentId;\n    }\n    return doTxStart.call(connector.device, payIntent, order, requestInfo);\n  };\n};\n\nconst tryDispose = connector => {\n  try {\n    // eslint-disable-next-line no-unused-expressions\n    connector?.dispose();\n  } catch (e) {\n    // Do nothing\n  }\n};\n\nexport default (state = initialState, { type, payload }) => {\n  switch (type) {\n    case CONST.CONNECTION_CLEAR:\n      tryDispose(state.connector);\n      return initialState;\n    case CONST.CONNECTION_SET:\n      tryDispose(state.connector);\n      return {\n        ...state,\n        connector: payload,\n        connected: false,\n      };\n    case '@@connector/onDeviceError':\n      if (\n        payload.code === 'Interrupted' &&\n        payload.type === 'COMMUNICATION' &&\n        payload.message?.includes('FORCECONNECT')\n      ) {\n        try {\n          if (state.connector?.dispose) {\n            state.connector.dispose();\n          }\n        } catch (e) {\n          // ignore errors\n        }\n        return initialState;\n      }\n      return state;\n    case '@@connector/onDeviceDisconnected':\n      return { ...state, connected: false };\n    case '@@connector/onDeviceReady': {\n      fixCreditPayIntent(state.connector);\n      const request = new Clover.remotepay.RetrieveDeviceStatusRequest();\n      request.setSendLastMessage(true);\n      state.connector.retrieveDeviceStatus(request);\n\n      return { ...state, connected: true };\n    }\n    default:\n      return state;\n  }\n};\n","import * as Storage from '../../common/Storage';\n\nconst storage = Storage.get();\n\nexport default {\n  list: [],\n  selected: storage?.devices?.selected || '',\n};\n","export default {\n  message: null,\n  stack: null,\n  important: undefined,\n};\n","export default {\n  employee: null,\n  permissions: null,\n};\n","export default {\n  width: 0,\n  height: 0,\n  strokes: [],\n};\n","const retryFetch = (url, { retries = 3, ...options }) =>\n  fetch(url, options).catch(e => {\n    if (retries > 1) return retryFetch(url, { retries: retries - 1, ...options });\n    throw e;\n  });\n\nexport default retryFetch;\n","import { PERMISSION } from './constants';\nimport retryFetch from './retryFetch';\n\nexport const deviceApps = ({ cloverDomain, merchantId, deviceId, accessToken }) =>\n  retryFetch(new URL(`/v2/merchant/${merchantId}/device/${deviceId}/current_apps`, cloverDomain).toString(), {\n    method: 'GET',\n    headers: {\n      accept: 'application/json',\n      'content-type': 'application/json',\n      authorization: `Bearer ${accessToken}`,\n    },\n  }).then(r => r.json());\n\nexport const devices = ({ cloverDomain, merchantId, accessToken }) =>\n  retryFetch(new URL(`/v3/merchants/${merchantId}/devices`, cloverDomain).toString(), {\n    method: 'GET',\n    headers: {\n      accept: 'application/json',\n      'content-type': 'application/json',\n      authorization: `Bearer ${accessToken}`,\n    },\n  }).then(r => r.json());\n\nexport const employee = ({ cloverDomain, merchantId, employeeId, accessToken }) =>\n  retryFetch(new URL(`/v3/merchants/${merchantId}/employees/${employeeId}?expand=roles`, cloverDomain).toString(), {\n    method: 'GET',\n    headers: {\n      accept: 'application/json',\n      'content-type': 'application/json',\n      authorization: `Bearer ${accessToken}`,\n    },\n  }).then(r => r.json());\n\nexport const permissionSets = ({ cloverDomain, merchantId, accessToken, filterNames = Object.values(PERMISSION) }) => {\n  const url = new URL(`/v3/merchants/${merchantId}/permission_sets`, cloverDomain);\n  url.searchParams.set('expand', 'roles');\n  url.searchParams.set('limit', 1000);\n  if (filterNames?.length) {\n    url.searchParams.set('filter', `name in (${filterNames.map(n => `'${n}'`).join(',')})`);\n  }\n  return retryFetch(url.toString(), {\n    method: 'GET',\n    headers: {\n      accept: 'application/json',\n      'content-type': 'application/json',\n      authorization: `Bearer ${accessToken}`,\n    },\n  }).then(r => r.json());\n};\n","import { APP_BY_NAME, REG_PRODUCTS } from './constants';\nimport * as api from './api';\n\nconst appsReducer = (o, a) => {\n  const app = APP_BY_NAME[a.appName];\n  return app ? { ...o, [app]: true } : o;\n};\n\nconst createPartition = (array, size) =>\n  array.reduce(\n    (a, o) => {\n      const last = a[a.length - 1];\n      if (last.length === size) {\n        a.push([o]);\n      } else {\n        last.push(o);\n      }\n      return a;\n    },\n    [[]]\n  );\n\nexport default async ({ cloverDomain, merchantId, accessToken }) => {\n  const { elements } = await api.devices({ cloverDomain, merchantId, accessToken });\n  const devices = elements.filter(d => REG_PRODUCTS.test(d.productName));\n\n  // NOTE: We need to limit simultaneous API requests.\n  const partitions = createPartition(devices, 4);\n  for (let i = 0; i < partitions.length; i++) {\n    // eslint-disable-next-line no-await-in-loop\n    partitions[i] = await Promise.all(\n      partitions[i].map(({ id: deviceId }) => api.deviceApps({ cloverDomain, merchantId, accessToken, deviceId }))\n    );\n  }\n  const apps = partitions.flat();\n\n  return devices.map((device, i) => ({\n    ...device,\n    apps: apps[i].applications.reduce(appsReducer, {}),\n  }));\n};\n","import * as api from './api';\n\nexport default async ({ cloverDomain, merchantId, accessToken, employeeId }) => {\n  const [employee, permissions] = await Promise.all([\n    api.employee({ cloverDomain, merchantId, employeeId, accessToken }).catch(() => null),\n    api.permissionSets({ cloverDomain, merchantId, accessToken }).catch(() => null),\n  ]);\n  return { employee, permissions };\n};\n","export const currency = value => {\n  const n = +value;\n  if (!isNaN(n) && n >= 0) {\n    return (n / 100).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });\n  }\n  return '';\n};\n\nexport const card = ({ first6, last4 }) => [first6, '*'.repeat(6), last4].join('').replace(/.{4}/g, ' $&').trim();\n","import { TRANSACTION } from '../../common';\n\nexport default {\n  active: null,\n  mode: TRANSACTION.SALE,\n  data: {},\n};\n","import { combineReducers } from 'redux';\nimport actions from './actions/reducer';\nimport buffer from './buffer/reducer';\nimport configuration from './configuration/reducer';\nimport connection from './connection/reducer';\nimport devices from './devices/reducer';\nimport error from './error/reducer';\nimport settings from './settings/reducer';\nimport signature from './signature/reducer';\nimport status from './status/reducer';\nimport transactions from './transactions/reducer';\n\nconst rootReducer = combineReducers({\n  actions,\n  buffer,\n  configuration,\n  connection,\n  devices,\n  error,\n  settings,\n  signature,\n  status,\n  transactions,\n});\n\nexport default rootReducer;\n","import { ACTION } from '../../common/constants';\nimport * as CONST from './constants';\nimport { CONNECTION_SET } from '../connection/constants';\nimport initialState from './initialState';\n\nexport default (state = initialState, { type, payload }) => {\n  switch (type) {\n    case CONST.ACTIONS_CLEAR:\n      return initialState;\n    case CONST.ACTIONS_APPEND: {\n      const found = state.some(a => a.type === payload.type && a.payload?.description === payload.payload?.description);\n      return found ? state : [...state, payload];\n    }\n    case CONST.ACTIONS_SET:\n      return payload || [];\n    case CONNECTION_SET:\n      return [{ type: ACTION.DISCONNECT, payload: { description: 'Cancel' } }];\n    case '@@connector/onDeviceReady':\n      return [{ type: ACTION.IDENTIFY }, { type: ACTION.TRANSACTION }];\n    case '@@connector/onResetDeviceResponse':\n      return [{ type: ACTION.IDENTIFY }, { type: ACTION.TRANSACTION }];\n    case '@@connector/onDeviceActivityStart':\n      return payload.inputOptions.map(io => ({ type: ACTION.INVOKE_INPUT_OPTION, payload: io }));\n    case '@@connector/onSaleResponse':\n    case '@@connector/onVoidPaymentResponse':\n    case '@@connector/onManualRefundResponse':\n      return [{ type: ACTION.IDENTIFY }, { type: ACTION.TRANSACTION }];\n    case '@@connector/onConfirmPaymentRequest':\n      return [\n        { type: ACTION.ACCEPT_PAYMENT, payload },\n        { type: ACTION.REJECT_PAYMENT, payload },\n      ];\n    case '@@connector/onVerifySignatureRequest':\n      return [\n        { type: ACTION.ACCEPT_SIGNATURE, payload },\n        { type: ACTION.REJECT_SIGNATURE, payload },\n      ];\n    default:\n      return state;\n  }\n};\n","export const ACTIONS_APPEND = 'appendActions';\nexport const ACTIONS_CLEAR = 'clearActions';\nexport const ACTIONS_SET = 'setActions';\n","export const CONNECTION_CLEAR = 'clearConnector';\nexport const CONNECTION_SET = 'setConnector';\n","import * as CONST from './constants';\nimport initialState from './initialState';\n\nexport default (state = initialState, { type, payload }) => {\n  switch (type) {\n    case CONST.BUFFER_CLEAR:\n      return initialState;\n    case CONST.BUFFER_APPEND:\n      return (state + payload).replace(/^0+/, '').slice(0, 7);\n    case CONST.BUFFER_SET:\n      return payload;\n    case CONST.BUFFER_UNDO:\n      return state.length ? state.slice(0, state.length - 1) : '';\n    default:\n      return state;\n  }\n};\n","export default '';\n","export const BUFFER_APPEND = 'appendBuffer';\nexport const BUFFER_CLEAR = 'clearBuffer';\nexport const BUFFER_SET = 'setBuffer';\nexport const BUFFER_UNDO = 'undoBuffer';\n","import * as CONST from './constants';\nimport initialState from './initialState';\n\nexport default (state = initialState, { type, payload }) => {\n  switch (type) {\n    case CONST.CONFIGURATION_LOADING:\n      return {\n        ...state,\n        loading: true,\n      };\n    case CONST.CONFIGURATION_NOT_LOADING:\n      return {\n        ...state,\n        loading: undefined,\n      };\n    case CONST.CONFIGURATION_SET:\n      return {\n        ...state,\n        cloverDomain: payload.cloverDomain || '',\n        merchantId: payload.merchantId || '',\n        employeeId: payload.employeeId || '',\n        raid: payload.raid || '',\n        accessToken: payload.accessToken || '',\n        friendlyId: payload.friendlyId || '',\n        forceConnect: payload.forceConnect || false,\n      };\n    default:\n      return state;\n  }\n};\n","export const CONFIGURATION_LOADING = 'setConfigurationLoading';\nexport const CONFIGURATION_NOT_LOADING = 'setConfigurationNotLoading';\nexport const CONFIGURATION_SET = 'setConfiguration';\n","import * as CONST from './constants';\nimport initialState from './initialState';\n\nexport default (state = initialState, { type, payload }) => {\n  switch (type) {\n    case CONST.DEVICES_CLEAR_LIST:\n      return {\n        ...state,\n        list: [],\n      };\n    case CONST.DEVICES_CLEAR_SELECTED:\n      return {\n        ...state,\n        selected: '',\n      };\n    case CONST.DEVICES_SET_SELECTED:\n      return {\n        ...state,\n        selected: payload || '',\n      };\n    case CONST.DEVICES_SET_LIST:\n      return {\n        ...state,\n        list: payload || [],\n      };\n    case '@@connector/onDeviceError':\n      if (\n        payload.code === 'Interrupted' &&\n        payload.type === 'COMMUNICATION' &&\n        payload.message?.includes('FORCECONNECT')\n      ) {\n        return initialState;\n      }\n      return state;\n    default:\n      return state;\n  }\n};\n","export const DEVICES_CLEAR_LIST = 'clearDevices';\nexport const DEVICES_CLEAR_SELECTED = 'clearDeviceId';\nexport const DEVICES_SET_LIST = 'setDevices';\nexport const DEVICES_SET_SELECTED = 'setDeviceId';\n","import * as CONST from './constants';\nimport initialState from './initialState';\n\nexport default (state = initialState, { type, payload }) => {\n  switch (type) {\n    case CONST.ERROR_CLEAR:\n      return initialState;\n    case CONST.ERROR_SET:\n      return {\n        ...state,\n        message: payload.message,\n        stack: payload.stack,\n        important: payload.important,\n      };\n    case '@@connector/onDeviceError':\n      if (\n        payload.code === 'Interrupted' &&\n        payload.type === 'COMMUNICATION' &&\n        payload.message?.includes('FORCECONNECT')\n      ) {\n        return {\n          ...state,\n          message: 'Forcefully disconnected by another connection to the same device.',\n          stack: JSON.stringify(payload, null, 2),\n          important: undefined,\n        };\n      }\n      return {\n        ...state,\n        message: `Device Error ${payload.message}`,\n        stack: JSON.stringify(payload, null, 2),\n        important: undefined,\n      };\n    case '@@connector/onManualRefundResponse':\n    case '@@connector/onSaleResponse':\n    case '@@connector/onVoidPaymentResponse':\n      if (!payload.success) {\n        return {\n          ...state,\n          message: payload.message,\n          stack: JSON.stringify(payload, null, 2),\n          important: true,\n        };\n      }\n      return state;\n    default:\n      return state;\n  }\n};\n","export const ERROR_CLEAR = 'clearError';\nexport const ERROR_SET = 'setError';\n","import * as CONST from './constants';\nimport initialState from './initialState';\n\nexport default (state = initialState, { type, payload }) => {\n  switch (type) {\n    case CONST.SETTINGS_EMPLOYEE:\n      return {\n        ...state,\n        employee: payload,\n      };\n    case CONST.SETTINGS_PERMISSIONS:\n      return {\n        ...state,\n        permissions: payload,\n      };\n    default:\n      return state;\n  }\n};\n","export const SETTINGS_EMPLOYEE = 'setEmployee';\nexport const SETTINGS_PERMISSIONS = 'setPermissions';\n","import * as CONST from './constants';\nimport initialState from './initialState';\n\nexport default (state = initialState, { type, payload }) => {\n  switch (type) {\n    case CONST.SIGNATURE_CLEAR:\n      return initialState;\n    case CONST.SIGNATURE_SET:\n      return {\n        width: payload?.width || 0,\n        height: payload?.height || 0,\n        strokes: payload?.strokes || [],\n      };\n    case '@@connector/onVerifySignatureRequest':\n      return {\n        width: payload.signature?.width || 0,\n        height: payload.signature?.height || 0,\n        strokes: payload.signature?.strokes || [],\n      };\n    default:\n      return state;\n  }\n};\n","export const SIGNATURE_CLEAR = 'clearSignature';\nexport const SIGNATURE_SET = 'setSignature';\n","import * as CONST from './constants';\nimport initialState from './initialState';\n\nexport default (state = initialState, { type, payload }) => {\n  switch (type) {\n    case CONST.STATUS_CLEAR:\n      return '';\n    case CONST.STATUS_SET:\n      return payload || '';\n    case '@@connector/onDeviceReady':\n      return 'Ready';\n    case '@@connector/onResetDeviceResponse':\n      return 'Ready';\n    case '@@connector/onDeviceActivityStart':\n      return payload.message;\n    case '@@connector/onSaleResponse':\n    case '@@connector/onVoidPaymentResponse':\n    case '@@connector/onManualRefundResponse':\n      return 'Ready';\n    case '@@connector/onConfirmPaymentRequest':\n      return payload.challenges[0].message;\n    case '@@connector/onVerifySignatureRequest':\n      return 'Verify Signature';\n    default:\n      return state;\n  }\n};\n","export default '';\n","export const STATUS_CLEAR = 'clearStatus';\nexport const STATUS_SET = 'setStatus';\n","import * as CONST from './constants';\nimport initialState from './initialState';\nimport { TRANSACTION } from '../../common';\n\nexport default (state = initialState, { type, payload }) => {\n  switch (type) {\n    case CONST.TRANSACTIONS_MODE:\n      return {\n        ...state,\n        mode: payload,\n      };\n    case CONST.TRANSACTIONS_ACTIVE: {\n      if (payload.id) {\n        const cur = state.data[payload.id] || {};\n\n        return {\n          ...state,\n          active: payload.id,\n          data: {\n            ...state.data,\n            [payload.id]: {\n              ...state.data[payload.id],\n              id: payload.id,\n              timestamp: Date.now(),\n              type: payload.type || cur.type,\n              amount: payload.amount || cur.amount || 0,\n              tipAmount: payload.tipAmount || cur.tipAmount || 0,\n            },\n          },\n        };\n      }\n      return {\n        ...state,\n        active: '',\n      };\n    }\n    case CONST.TRANSACTIONS_HIDE:\n      return {\n        ...state,\n        data: {\n          ...state.data,\n          [payload]: {\n            ...state.data[payload],\n            visible: false,\n          },\n        },\n      };\n    case CONST.TRANSACTIONS_SHOW:\n      return {\n        ...state,\n        data: {\n          ...state.data,\n          [payload]: {\n            ...state.data[payload],\n            visible: true,\n          },\n        },\n      };\n    case CONST.TRANSACTIONS_REMOVE: {\n      const newState = {\n        ...state,\n        data: { ...state.data },\n      };\n      delete newState.data[payload];\n      return newState;\n    }\n    case CONST.TRANSACTIONS_UPDATE: {\n      const cur = state.data[payload.id] || {};\n\n      return {\n        ...state,\n        data: {\n          ...state.data,\n          [payload.id]: {\n            ...cur,\n            id: payload.id,\n            timestamp: Date.now(),\n            visible: payload.visible || cur.visible || false,\n            amount: payload.amount || cur.amount || 0,\n            tipAmount: payload.tipAmount || cur.tipAmount || 0,\n            type: payload.type || cur.type || '',\n            payment: payload.payment || cur.payment || null,\n          },\n        },\n      };\n    }\n    case '@@connector/onSaleResponse': {\n      if (payload.success) {\n        return {\n          ...state,\n          active: '',\n          data: {\n            ...state.data,\n            [payload.payment.externalPaymentId]: {\n              ...state.data[payload.payment.externalPaymentId],\n              id: payload.payment.externalPaymentId,\n              timestamp: Date.now(),\n              visible: true,\n              type: TRANSACTION.SALE,\n              payment: payload.payment,\n            },\n          },\n        };\n      }\n      const newState = {\n        ...state,\n        active: '',\n      };\n      delete newState.data[state.active];\n      return newState;\n    }\n    case '@@connector/onManualRefundResponse': {\n      if (payload.success) {\n        return {\n          ...state,\n          active: '',\n          data: {\n            ...state.data,\n            [payload.credit.externalReferenceId]: {\n              ...state.data[payload.credit.externalReferenceId],\n              id: payload.credit.externalReferenceId,\n              timestamp: Date.now(),\n              visible: true,\n              type: TRANSACTION.CREDIT,\n              payment: payload.credit,\n            },\n          },\n        };\n      }\n      const newState = {\n        ...state,\n        active: '',\n      };\n      delete newState.data[state.active];\n      return newState;\n    }\n    case '@@connector/onVoidPaymentResponse': {\n      if (payload.success) {\n        return {\n          ...state,\n          active: '',\n          data: {\n            ...state.data,\n            [payload.payment.externalPaymentId]: {\n              ...state.data[payload.payment.externalPaymentId],\n              id: payload.payment.externalPaymentId,\n              timestamp: Date.now(),\n              visible: true,\n              type: TRANSACTION.VOID,\n              payment: payload.payment,\n            },\n          },\n        };\n      }\n      const cur = state.data[state.active];\n      if (cur?.type === TRANSACTION.VOID) {\n        return {\n          ...state,\n          active: '',\n          data: {\n            ...state.data,\n            [cur.id]: {\n              ...state.data[cur.id],\n              type: TRANSACTION.SALE,\n            },\n          },\n        };\n      }\n      return state;\n    }\n    case '@@connector/onDeviceError':\n      if (\n        payload.code === 'Interrupted' &&\n        payload.type === 'COMMUNICATION' &&\n        payload.message?.includes('FORCECONNECT')\n      ) {\n        return initialState;\n      }\n      return state;\n    default:\n      return state;\n  }\n};\n","export const TRANSACTIONS_ACTIVE = 'setActiveTransaction';\nexport const TRANSACTIONS_REMOVE = 'removeTransaction';\nexport const TRANSACTIONS_UPDATE = 'updateTransaction';\nexport const TRANSACTIONS_SHOW = 'showTransaction';\nexport const TRANSACTIONS_HIDE = 'hideTransaction';\nexport const TRANSACTIONS_MODE = 'setTransactionMode';\n","import Clover from 'remote-pay-cloud';\nimport { createSelector } from 'reselect';\n\nimport { DOMAIN } from '../../common';\n\nexport const selectConfiguration = state => state.configuration;\n\nexport const selectFriendlyId = createSelector(selectConfiguration, ({ friendlyId }) => friendlyId || 'Virtual Keypad');\n\nexport const selectProduction = createSelector(selectConfiguration, ({ cloverDomain }) => cloverDomain === DOMAIN);\n\nexport const selectCardEntryMethods = createSelector(selectProduction, production =>\n  production\n    ? Clover.CardEntryMethods.DEFAULT\n    : // eslint-disable-next-line no-bitwise\n      Clover.CardEntryMethods.DEFAULT | Clover.CardEntryMethods.CARD_ENTRY_METHOD_MANUAL\n);\n\nexport const selectConfigurationLoading = createSelector(selectConfiguration, ({ loading }) => loading || false);\n","import * as CONST from './constants';\n\nexport const clearError = () => ({ type: CONST.ERROR_CLEAR });\n\nexport const setError = ({ message, stack, important } = {}) => ({\n  type: CONST.ERROR_SET,\n  payload: { message, stack, important },\n});\n","import * as CONST from './constants';\n\nexport const appendAction = action => ({\n  type: CONST.ACTIONS_APPEND,\n  payload: action,\n});\n\nexport const clearActions = () => ({ type: CONST.ACTIONS_CLEAR });\n\nexport const setActions = actions => ({\n  type: CONST.ACTIONS_SET,\n  payload: actions,\n});\n","import { createSelector } from 'reselect';\n\nexport const selectConnection = state => state.connection;\n\nexport const selectConnector = createSelector(selectConnection, ({ connector }) => connector);\n\nexport const selectConnected = createSelector(selectConnection, ({ connected }) => connected);\n","import * as CONST from './constants';\n\nexport const clearStatus = () => ({ type: CONST.STATUS_CLEAR });\n\nexport const setStatus = text => ({\n  type: CONST.STATUS_SET,\n  payload: text,\n});\n","import * as Storage from './Storage';\nimport initialDevices from '../store/devices/initialState';\n\nexport default ({ configuration, devices }) =>\n  Storage.set({\n    configuration: {\n      ...configuration,\n      forceConnect: undefined,\n      loading: undefined,\n    },\n    devices: {\n      ...initialDevices,\n      selected: devices.selected,\n    },\n  });\n","import * as CONST from './constants';\n\nexport const setConfiguration = ({\n  cloverDomain,\n  merchantId,\n  employeeId,\n  raid,\n  accessToken,\n  friendlyId,\n  forceConnect,\n}) => ({\n  type: CONST.CONFIGURATION_SET,\n  payload: { cloverDomain, merchantId, employeeId, raid, accessToken, friendlyId, forceConnect },\n});\n\nexport const setConfigurationLoading = () => ({ type: CONST.CONFIGURATION_LOADING });\n\nexport const setConfigurationNotLoading = () => ({ type: CONST.CONFIGURATION_NOT_LOADING });\n","import * as CONST from './constants';\n\nexport const clearDeviceId = () => ({ type: CONST.DEVICES_CLEAR_SELECTED });\n\nexport const clearDevices = () => ({ type: CONST.DEVICES_CLEAR_LIST });\n\nexport const setDeviceId = deviceId => ({\n  type: CONST.DEVICES_SET_SELECTED,\n  payload: deviceId,\n});\n\nexport const setDevices = devices => ({\n  type: CONST.DEVICES_SET_LIST,\n  payload: devices,\n});\n","import * as CONST from './constants';\n\nexport const setEmployee = data => ({\n  type: CONST.SETTINGS_EMPLOYEE,\n  payload: data,\n});\n\nexport const setPermissions = data => ({\n  type: CONST.SETTINGS_PERMISSIONS,\n  payload: data,\n});\n","import { APP } from '../../common/constants';\nimport persist from '../../common/persist';\nimport fetchDevices from '../../common/fetchDevices';\nimport fetchSettings from '../../common/fetchSettings';\nimport { setConfiguration, setConfigurationLoading, setConfigurationNotLoading } from '../configuration/actions';\nimport { setDevices } from '../devices/actions';\nimport { clearError, setError } from '../error/actions';\nimport { setEmployee, setPermissions } from '../settings/actions';\n\nexport default ({ cloverDomain, merchantId, employeeId, raid, accessToken, friendlyId, forceConnect }) => async (\n  dispatch,\n  getState\n) => {\n  try {\n    await dispatch({\n      type: 'configure',\n      payload: { cloverDomain, merchantId, employeeId, raid, accessToken, friendlyId, forceConnect },\n    });\n    await dispatch(clearError());\n    await dispatch(setConfigurationLoading());\n\n    await dispatch(\n      setConfiguration({ cloverDomain, merchantId, employeeId, raid, accessToken, friendlyId, forceConnect })\n    );\n    persist(getState());\n\n    const devices = await fetchDevices({ cloverDomain, merchantId, raid, employeeId, accessToken });\n    await dispatch(setDevices(devices));\n\n    if (!devices.length) {\n      throw new Error('Merchant has no devices');\n    }\n\n    if (!devices.some(a => a.apps[APP.CLOUD_PAY_DISPLAY])) {\n      throw new Error('Merchant has no devices with Cloud Pay Display installed');\n    }\n\n    const { employee, permissions } = await fetchSettings({ cloverDomain, merchantId, employeeId, raid, accessToken });\n    await dispatch(setEmployee(employee));\n    await dispatch(setPermissions(permissions));\n  } catch (e) {\n    await dispatch(setError(e));\n  } finally {\n    await dispatch(setConfigurationNotLoading());\n  }\n};\n","import { createSelector } from 'reselect';\n\nexport const selectRawDevices = state => state.devices;\n\nexport const selectDeviceId = createSelector(selectRawDevices, ({ selected }) => selected);\n\nexport const selectDevices = createSelector(selectRawDevices, selectDeviceId, ({ list }, deviceId) =>\n  [...list].sort((a, b) => (a.id === deviceId ? -1 : b.id === deviceId ? 1 : 0))\n);\n","import * as CONST from './constants';\n\nexport const clearConnector = () => ({ type: CONST.CONNECTION_CLEAR });\n\nexport const setConnector = connector => ({\n  type: CONST.CONNECTION_SET,\n  payload: connector,\n});\n","import Clover from 'remote-pay-cloud';\n\nimport { APP } from '../../common/constants';\nimport persist from '../../common/persist';\nimport { selectConfiguration } from '../configuration/selectors';\nimport { selectDevices } from '../devices/selectors';\nimport { setConnector } from '../connection/actions';\nimport { setDeviceId } from '../devices/actions';\nimport { setError } from '../error/actions';\nimport { setStatus } from '../status/actions';\n\nexport default deviceId => async (dispatch, getState) => {\n  try {\n    await dispatch({ type: 'connect', payload: deviceId });\n    await dispatch(setDeviceId(deviceId));\n\n    const state = getState();\n    persist(state);\n\n    const { cloverDomain, merchantId, raid, accessToken, friendlyId, forceConnect } = selectConfiguration(state);\n    const device = selectDevices(state).find(d => d.id === deviceId);\n\n    if (!device) throw new Error(`Device not found`);\n    if (!device.apps[APP.CLOUD_PAY_DISPLAY]) throw new Error('Device does not have Cloud Pay Display installed');\n\n    const factory = Clover.CloverConnectorFactoryBuilder.createICloverConnectorFactory({\n      [Clover.CloverConnectorFactoryBuilder.FACTORY_VERSION]: Clover.CloverConnectorFactoryBuilder.VERSION_12,\n    });\n\n    const connector = factory.createICloverConnector(\n      new Clover.WebSocketCloudCloverDeviceConfigurationBuilder(raid, deviceId, merchantId, accessToken)\n        .setCloverServer(cloverDomain)\n        .setFriendlyId(friendlyId)\n        .setForceConnect(forceConnect)\n        .build()\n    );\n\n    class Listener extends Clover.remotepay.ICloverConnectorListener {\n      constructor() {\n        super();\n        Object.keys(Object.getPrototypeOf(Object.getPrototypeOf(this))).forEach(type => {\n          this[type] = payload => dispatch({ type: `@@connector/${type}`, payload });\n        });\n      }\n    }\n    const listener = new Listener();\n    connector.addCloverConnectorListener(listener);\n\n    dispatch(setConnector(connector));\n    dispatch(setStatus('Connecting'));\n\n    connector.initializeConnection();\n  } catch (e) {\n    dispatch(setError(e));\n  }\n};\n","import * as CONST from './constants';\n\nexport const setActiveTransaction = ({ id, type, amount, tipAmount } = {}) => ({\n  type: CONST.TRANSACTIONS_ACTIVE,\n  payload: { id, type, amount, tipAmount },\n});\n\nexport const removeTransaction = id => ({\n  type: CONST.TRANSACTIONS_REMOVE,\n  payload: id,\n});\n\nexport const showTransaction = id => ({\n  type: CONST.TRANSACTIONS_SHOW,\n  payload: id,\n});\n\nexport const hideTransaction = id => ({\n  type: CONST.TRANSACTIONS_HIDE,\n  payload: id,\n});\n\nexport const updateTransaction = ({ id, type, amount, tipAmount, payment }) => ({\n  type: CONST.TRANSACTIONS_UPDATE,\n  payload: { id, type, amount, tipAmount, payment },\n});\n\nexport const setTransactionMode = ({ mode }) => ({\n  type: CONST.TRANSACTIONS_MODE,\n  payload: mode,\n});\n","import { clearConnector } from '../connection/actions';\nimport { selectConnector } from '../connection/selectors';\nimport { setError } from '../error/actions';\nimport { clearDevices } from '../devices/actions';\nimport { setActiveTransaction } from '../transactions/actions';\n\nexport default () => async (dispatch, getState) => {\n  try {\n    await dispatch({ type: 'disconnect' });\n\n    const connector = selectConnector(getState());\n    try {\n      connector.showWelcomeScreen();\n      await new Promise(resolve => setTimeout(resolve, 500));\n    } catch (e2) {\n      // Do nothing\n    }\n\n    connector.dispose();\n\n    await dispatch(clearConnector());\n    await dispatch(clearDevices());\n    await dispatch(setActiveTransaction());\n  } catch (e) {\n    await dispatch(setError(e));\n  }\n};\n","import en from './en.json';\nimport deDE from './de-DE.json';\nimport esAR from './es-AR.json';\nimport frCA from './fr-CA.json';\nimport nlNL from './nl-NL.json';\n\nexport default {\n  en,\n  'de-DE': deDE,\n  'es-AR': esAR,\n  'fr-CA': frCA,\n  'nl-NL': nlNL,\n};\n","import i18n from 'i18next';\nimport { initReactI18next } from 'react-i18next';\nimport LanguageDetector from 'i18next-browser-languagedetector';\n\nimport resources from './locales';\n\nexport default i18n\n  .use(LanguageDetector)\n  .use(initReactI18next)\n  .init({\n    fallbackLng: ['en', 'de-DE', 'es-AR', 'fr-CA', 'nl-NL'],\n    debug: false,\n    keySeparator: '~',\n    nsSeparator: false,\n    interpolation: { escapeValue: false },\n    resources,\n  });\n","import { selectConnector } from '../connection/selectors';\nimport { clearActions } from '../actions/actions';\nimport { setError } from '../error/actions';\nimport { setStatus } from '../status/actions';\n\nexport default action => async (dispatch, getState) => {\n  try {\n    dispatch({ ...action, type: 'reset' });\n    dispatch(setStatus('Resetting'));\n    dispatch(clearActions());\n\n    const connector = selectConnector(getState());\n    connector.resetDevice();\n  } catch (e) {\n    dispatch(setError(e));\n  }\n};\n","export const selectError = state => state.error;\n","import { setError } from '../error';\nimport { ACTION } from '../../common/constants';\nimport { setActions } from '../actions/actions';\nimport { selectConnector } from '../connection/selectors';\nimport { setStatus } from '../status/actions';\n\nexport default action => async (dispatch, getState) => {\n  try {\n    dispatch({ ...action, type: 'showWelcome' });\n    dispatch(setStatus('Ready'));\n    dispatch(setActions([{ type: ACTION.IDENTIFY }, { type: ACTION.TRANSACTION }]));\n\n    const connector = selectConnector(getState());\n    connector.showWelcomeScreen();\n  } catch (e) {\n    dispatch(setError(e));\n  }\n};\n","import * as CONST from './constants';\n\nexport const appendBuffer = value => ({\n  type: CONST.BUFFER_APPEND,\n  payload: value,\n});\n\nexport const clearBuffer = () => ({ type: CONST.BUFFER_CLEAR });\n\nexport const setBuffer = value => ({\n  type: CONST.BUFFER_SET,\n  payload: value || '',\n});\n\nexport const undoBuffer = () => ({ type: CONST.BUFFER_UNDO });\n","export const selectBuffer = state => state.buffer;\n","import { createSelector } from 'reselect';\n\nexport const selectRawTransactions = state => state.transactions;\n\nexport const selectTransactions = createSelector(selectRawTransactions, ({ data }) => Object.values(data));\n\nexport const selectActiveTransaction = createSelector(selectRawTransactions, ({ active, data }) => data[active]);\n\nexport const selectActiveTransactionType = createSelector(selectActiveTransaction, active => active?.type);\n\nexport const selectActiveTransactionAmount = createSelector(\n  selectActiveTransaction,\n  active => (active?.amount || 0) + (active?.tipAmount || 0)\n);\n\nexport const selectPaymentTransactions = createSelector(selectTransactions, transactions =>\n  transactions.filter(t => t.payment)\n);\n\nexport const selectVisiblePaymentTransactions = createSelector(selectPaymentTransactions, transactions =>\n  transactions.filter(t => t.visible)\n);\n\nexport const selectTransactionMode = createSelector(selectRawTransactions, ({ mode }) => mode);\n","import Clover from 'remote-pay-cloud';\nimport i18n from '../../i18n';\n\nimport { clearBuffer } from '../buffer/actions';\nimport { selectBuffer } from '../buffer/selectors';\nimport { selectConnector } from '../connection/selectors';\nimport { selectCardEntryMethods } from '../configuration/selectors';\nimport { clearActions } from '../actions/actions';\nimport { setError } from '../error/actions';\nimport { setStatus } from '../status/actions';\nimport { TRANSACTION } from '../../common/constants';\nimport { updateTransaction, setActiveTransaction, selectTransactionMode } from '../transactions';\n\nexport default action => async (dispatch, getState) => {\n  try {\n    const t = await i18n;\n    dispatch({ ...action, type: 'transaction' });\n\n    const state = getState();\n    const buffer = selectBuffer(state);\n    const connector = selectConnector(state);\n    const cardEntryMethods = selectCardEntryMethods(state);\n    const type = selectTransactionMode(state);\n\n    dispatch(clearActions());\n    dispatch(setStatus('Processing...'));\n    dispatch(clearBuffer());\n\n    const amount = +buffer;\n    if (!amount) throw new Error('Amount is required');\n    if (isNaN(amount)) throw new Error('Amount is invalid');\n    if (amount <= 0 || amount > 99_999_99) throw new Error('Amount is invalid');\n\n    let id = Clover.CloverID.getNewId();\n    if (type === TRANSACTION.CREDIT) {\n      // HACK: externalId is ignored.  We need to use the externalReferenceId field, which is limited to 12-chars.\n      id = id.slice(0, 12);\n    }\n\n    dispatch(setActiveTransaction({ id, type, amount }));\n\n    switch (type) {\n      case TRANSACTION.SALE:\n        {\n          const request = new Clover.remotepay.SaleRequest();\n          request.setAmount(amount);\n          request.setExternalId(id);\n          request.setCardEntryMethods(cardEntryMethods);\n\n          dispatch(updateTransaction({ id, type: TRANSACTION.SALE, amount }));\n\n          connector.sale(request);\n        }\n        break;\n      case TRANSACTION.CREDIT:\n        {\n          const request = new Clover.remotepay.ManualRefundRequest();\n          request.setAmount(amount);\n          request.setExternalId(id);\n          request.setCardEntryMethods(cardEntryMethods);\n\n          dispatch(updateTransaction({ id, type: TRANSACTION.CREDIT, amount }));\n\n          connector.manualRefund(request);\n        }\n        break;\n      default:\n        throw new Error(`${t('ERROR~Invalid transaction type')}: ${type}`);\n    }\n  } catch (e) {\n    dispatch(setError(e));\n    dispatch({ type: '@@connector/onDeviceReady' });\n  }\n};\n","import Clover from 'remote-pay-cloud';\n\nimport { TRANSACTION } from '../../common/constants';\nimport { setError } from '../error/actions';\nimport { selectConnector } from '../connection/selectors';\nimport { clearActions } from '../actions/actions';\nimport { setStatus } from '../status/actions';\nimport { setActiveTransaction } from '../transactions';\n\nexport default payment => async (dispatch, getState) => {\n  try {\n    dispatch({ type: 'voidPayment', payload: payment });\n\n    const { id, externalPaymentId, orderId, amount, tipAmount } = payment;\n    const connector = selectConnector(getState());\n\n    dispatch(clearActions());\n    dispatch(setStatus('Processing'));\n    if (!id) throw new Error('No payment was specified');\n\n    const type = TRANSACTION.VOID;\n    dispatch(setActiveTransaction({ id: externalPaymentId, type, amount, tipAmount }));\n\n    const request = new Clover.remotepay.VoidPaymentRequest();\n    request.setPaymentId(id);\n    request.setOrderId(orderId);\n    request.setVoidReason(Clover.order.VoidReason.USER_CANCEL);\n    connector.voidPayment(request);\n  } catch (e) {\n    dispatch(setError(e));\n    dispatch({ type: '@@connector/onDeviceReady' });\n  }\n};\n","import createStore from './createStore';\nimport { selectConfiguration } from './configuration/selectors';\nimport { configure } from './thunks';\n\nconst store = createStore(undefined);\n\nconst config = selectConfiguration(store.getState());\nstore.dispatch(configure(config));\n\nexport default store;\n","import { applyMiddleware, compose, createStore } from 'redux';\nimport thunk from 'redux-thunk';\n\nimport rootReducer from './rootReducer';\n\nexport default initialState => {\n  const middleware = applyMiddleware(thunk);\n\n  // eslint-disable-next-line no-underscore-dangle\n  const devTools = window.__REDUX_DEVTOOLS_EXTENSION__;\n  const enhancer = devTools ? devTools() : f => f;\n\n  return createStore(rootReducer, initialState, compose(middleware, enhancer));\n};\n","import { createSelector } from 'reselect';\n\nimport { ACTION } from '../../common/constants';\n\nexport const selectActions = state => state.actions;\n\nexport const selectTransactionAction = createSelector(selectActions, actions =>\n  actions.find(a => a.type === ACTION.TRANSACTION)\n);\n\nexport const selectNonTransactionActions = createSelector(selectActions, actions => {\n  const arr = actions.filter(a => a.type !== ACTION.TRANSACTION);\n  if (arr.length === 2) {\n    const [a, b] = arr;\n    if (a.payload?.description === 'No' && b.payload?.description === 'Yes') {\n      return [b, a];\n    }\n  }\n  return arr;\n});\n","import { createSelector } from 'reselect';\nimport { PERMISSION } from '../../common';\n\nexport const selectRawSettings = state => state.settings;\n\nexport const selectEmployee = createSelector(selectRawSettings, ({ employee }) => employee);\n\nexport const selectEmployeeRoles = createSelector(selectEmployee, employee => employee?.roles?.elements);\n\nexport const selectPermissions = createSelector(selectRawSettings, ({ permissions }) => permissions?.elements);\n\nexport const selectCreditEnabled = createSelector(\n  selectEmployeeRoles,\n  selectPermissions,\n  (employeeRoles, permissions) => {\n    if (employeeRoles && permissions) {\n      const employeeRoleIds = employeeRoles.map(r => r.id);\n      const permissionRoleIds = new Set(\n        permissions\n          .filter(p => p.name === PERMISSION.PERFORM_MANUAL_REFUND)\n          .map(p => p.roles?.elements.map(r => r.id))\n          .flat()\n      );\n      return employeeRoleIds.some(id => permissionRoleIds.has(id));\n    }\n    return false;\n  }\n);\n\nexport const selectVoidEnabled = createSelector(\n  selectEmployeeRoles,\n  selectPermissions,\n  (employeeRoles, permissions) => {\n    if (employeeRoles && permissions) {\n      const employeeRoleIds = employeeRoles.map(r => r.id);\n      const permissionRoleIds = new Set(\n        permissions\n          .filter(p => p.name === PERMISSION.VOID_PAYMENTS)\n          .map(p => p.roles?.elements.map(r => r.id))\n          .flat()\n      );\n      return employeeRoleIds.some(id => permissionRoleIds.has(id));\n    }\n    return false;\n  }\n);\n","import { createSelector } from 'reselect';\n\nexport const selectSignature = state => state.signature;\n\nexport const selectSignatureBounds = createSelector(selectSignature, ({ strokes }) => {\n  const bounds = strokes\n    .map(({ points }) => points)\n    .flat()\n    .reduce(\n      ({ x, X, y, Y }, point) => ({\n        x: Math.min(x, point.x),\n        X: Math.max(X, point.x),\n        y: Math.min(y, point.y),\n        Y: Math.max(Y, point.y),\n      }),\n      { x: Infinity, X: -Infinity, y: Infinity, Y: -Infinity }\n    );\n  return [bounds.x, bounds.y, bounds.X - bounds.x, bounds.Y - bounds.y].join(' ');\n});\n\nexport const selectSignatureLines = createSelector(selectSignature, ({ strokes }) =>\n  strokes.map(({ points }) => points.map(({ x, y }) => `${x},${y}`).join(' '))\n);\n","export const selectStatus = state => state.status;\n","import { createSelector } from 'reselect';\nimport { selectConnector, selectDevices } from '../../store';\n\nexport const selectVisible = createSelector(\n  selectConnector,\n  selectDevices,\n  (connector, devices) => !connector && !devices.length\n);\n","import React, { useMemo, useState, useCallback } from 'react';\nimport { Button, Popover, PopoverHeader, PopoverBody } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\nimport Markdown from 'react-markdown';\n\nexport default ({\n  id,\n  type = 'text',\n  autoCorrect = 'off',\n  autoComplete = 'off',\n  autoCapitalize = 'off',\n  spellCheck = 'false',\n  value,\n  disabled,\n  onChange,\n  ...other\n}) => {\n  const { t } = useTranslation();\n\n  const [show, setShow] = useState(false);\n  const toggle = useCallback(() => setShow(cur => !cur), [setShow]);\n\n  const label = useMemo(() => t(`${id}~label`), [id, t]);\n  const title = useMemo(() => t(`${id}~title`, ''), [id, t]);\n  const help = useMemo(() => t(`${id}~help`, ''), [id, t]);\n\n  return (\n    <div className=\"form-group\">\n      <label htmlFor={id} className=\"d-block\">\n        {label}:\n        {help && (\n          <>\n            <Button\n              type=\"button\"\n              id={`${id}-btn`}\n              color=\"secondary\"\n              outline\n              size=\"sm\"\n              className=\"float-right p-0 px-2\"\n              title=\"Help\"\n              onFocus={toggle}\n            >\n              ?\n            </Button>\n            <Popover trigger=\"focus\" isOpen={show} toggle={toggle} target={`${id}-btn`}>\n              <PopoverHeader>{label} Help</PopoverHeader>\n              <PopoverBody>\n                <Markdown source={help} linkTarget=\"_blank\" />\n              </PopoverBody>\n            </Popover>\n          </>\n        )}\n      </label>\n      <input\n        id={id}\n        type={type}\n        className=\"form-control\"\n        title={title}\n        autoCorrect={autoCorrect}\n        autoComplete={autoComplete}\n        autoCapitalize={autoCapitalize}\n        spellCheck={spellCheck}\n        value={value}\n        onChange={event => onChange(event.target.value)}\n        disabled={disabled}\n        {...other}\n      />\n    </div>\n  );\n};\n","import React, { useCallback, useState } from 'react';\nimport { Button, Popover, PopoverHeader, PopoverBody } from 'reactstrap';\nimport Markdown from 'react-markdown';\nimport classNames from 'classnames';\n\nexport default ({ id, label, help, checked, onChange, disabled, switch: isSwitch, mb0, ...other }) => {\n  const [show, setShow] = useState(false);\n  const toggle = useCallback(() => setShow(cur => !cur), [setShow]);\n\n  return (\n    <div className={classNames('form-group', { 'mb-0': mb0 })}>\n      <div className={classNames('custom-control', { 'custom-switch': isSwitch, 'custom-checkbox': !isSwitch })}>\n        <input\n          id={id}\n          type=\"checkbox\"\n          className=\"custom-control-input\"\n          checked={checked}\n          onChange={() => onChange(!checked)}\n          disabled={disabled}\n          {...other}\n        />\n        <label className=\"custom-control-label font-weight-normal d-block\" htmlFor={id}>\n          {label}\n          {help && (\n            <>\n              <Button\n                type=\"button\"\n                id={`${id}-btn`}\n                color=\"secondary\"\n                outline\n                size=\"sm\"\n                className=\"float-right p-0 px-2\"\n                title=\"Help\"\n                onFocus={toggle}\n              >\n                ?\n              </Button>\n              <Popover trigger=\"focus\" isOpen={show} toggle={toggle} target={`${id}-btn`}>\n                <PopoverHeader>{label} Help</PopoverHeader>\n                <PopoverBody>\n                  <Markdown source={help} linkTarget=\"_blank\" />\n                </PopoverBody>\n              </Popover>\n            </>\n          )}\n        </label>\n      </div>\n    </div>\n  );\n};\n","import React from 'react';\nimport { useTranslation } from 'react-i18next';\n\nexport default ({ size = 28 }) => {\n  const { t } = useTranslation();\n  return (\n    <svg\n      className=\"Logo\"\n      id=\"clover-logo-svg\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={size}\n      height={size}\n      viewBox=\"0 0 33.15 33.15\"\n      aria-labelledby=\"svg-logo-title\"\n      role=\"image\"\n    >\n      <title id=\"svg-logo-title\">{t('Clover')}</title>\n      <g id=\"clover-symbol-2\" data-name=\"clover-symbol\">\n        <path d=\"M191.45,85.64A7.5,7.5,0,1,0,184,93.09h7.49V85.64Z\" transform=\"translate(-176.46 -77.01)\"></path>\n        <path d=\"M193.61,85.64a7.5,7.5,0,1,1,7.49,7.45h-7.49V85.64Z\" transform=\"translate(-176.46 -77.01)\"></path>\n        <path d=\"M193.61,102.7a7.5,7.5,0,1,0,7.49-7.45h-7.49v7.45Z\" transform=\"translate(-176.46 -77.01)\"></path>\n        <path\n          d=\"M191.46,102.7A7.5,7.5,0,1,1,184,95.25h7.49v7.45Zm-7.5,5.35a5.38,5.38,0,0,0,5.4-5.35V97.36H184a5.35,5.35,0,1,0,0,10.7h0Z\"\n          transform=\"translate(-176.46 -77.01)\"\n        ></path>\n      </g>\n    </svg>\n  );\n};\n","import React, { useCallback, useState, useMemo } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Button, Collapse, Card, CardHeader, CardBody, CardFooter } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\n\nimport { configure, selectConfiguration, selectConfigurationLoading } from '../../store';\nimport { selectVisible } from './selectors';\nimport { CheckboxField, TextField } from '../Fields';\nimport { Logo } from '../SVG';\n\nexport default () => {\n  const { t } = useTranslation();\n  const dispatch = useDispatch();\n  const configuration = useSelector(selectConfiguration);\n  const loading = useSelector(selectConfigurationLoading);\n  const visible = useSelector(selectVisible);\n\n  const [cloverDomain, setCloverDomain] = useState(configuration.cloverDomain);\n  const [merchantId, setMerchantId] = useState(configuration.merchantId);\n  const [employeeId, setEmployeeId] = useState(configuration.employeeId);\n  const [accessToken, setAccessToken] = useState(configuration.accessToken);\n  const [raid, setRaid] = useState(configuration.raid);\n  const [friendlyId, setFriendlyId] = useState(configuration.friendlyId);\n  const [forceConnect, setForceConnect] = useState(configuration.forceConnect);\n  const [expanded, setExpanded] = useState(false);\n  const toggle = useCallback(() => setExpanded(cur => !cur), [setExpanded]);\n\n  const [submitting, setSubmitting] = useState(false);\n\n  const disabled = useMemo(() => loading || submitting, [loading, submitting]);\n\n  const submit = useCallback(\n    async event => {\n      try {\n        event.preventDefault();\n        setSubmitting(true);\n        await dispatch(\n          configure({ cloverDomain, merchantId, employeeId, accessToken, raid, friendlyId, forceConnect })\n        );\n      } finally {\n        setSubmitting(false);\n      }\n    },\n    [dispatch, cloverDomain, merchantId, employeeId, accessToken, raid, friendlyId, forceConnect]\n  );\n\n  const reset = useCallback(\n    event => {\n      event.preventDefault();\n      setCloverDomain(configuration.cloverDomain);\n      setMerchantId(configuration.merchantId);\n      setEmployeeId(configuration.employeeId);\n      setAccessToken(configuration.accessToken);\n      setRaid(configuration.raid);\n      setFriendlyId(configuration.friendlyId);\n      setForceConnect(configuration.forceConnect);\n    },\n    [\n      configuration,\n      setCloverDomain,\n      setMerchantId,\n      setEmployeeId,\n      setAccessToken,\n      setRaid,\n      setFriendlyId,\n      setForceConnect,\n    ]\n  );\n\n  if (!visible) return null;\n\n  return (\n    <form onSubmit={submit} onReset={reset}>\n      <Card className=\"Configuration\">\n        <CardHeader>\n          <Logo />\n          <h3>{t('Virtual Keypad')}</h3>\n        </CardHeader>\n        {loading && (\n          <CardBody>\n            <p>Loading...</p>\n          </CardBody>\n        )}\n        {!loading && (\n          <>\n            <CardBody>\n              <Button type=\"button\" size=\"sm\" className=\"w-100 mb-2\" color=\"dark\" onClick={toggle}>\n                {t('Configuration')} {expanded ? '' : ''}\n              </Button>\n              <Collapse isOpen={expanded}>\n                <TextField\n                  id=\"cloverDomain\"\n                  type=\"url\"\n                  value={cloverDomain}\n                  onChange={setCloverDomain}\n                  disabled={disabled}\n                  required\n                />\n                <TextField\n                  id=\"merchantId\"\n                  pattern=\"^[a-zA-Z0-9]{13}$\"\n                  maxLength=\"13\"\n                  value={merchantId}\n                  onChange={setMerchantId}\n                  disabled={disabled}\n                  required\n                />\n                <TextField\n                  id=\"employeeId\"\n                  pattern=\"^[a-zA-Z0-9]{13}$\"\n                  maxLength=\"13\"\n                  value={employeeId}\n                  onChange={setEmployeeId}\n                  disabled={disabled}\n                />\n                <TextField\n                  id=\"raid\"\n                  pattern=\"^[a-zA-Z0-9 .]{1,255}$\"\n                  value={raid}\n                  onChange={setRaid}\n                  disabled={disabled}\n                  required\n                />\n                <TextField\n                  id=\"accessToken\"\n                  pattern=\"^[a-fA-F0-9]{8}(-?[a-fA-F0-9]{4}){3}-?[a-fA-F0-9]{12}$\"\n                  value={accessToken}\n                  onChange={setAccessToken}\n                  disabled={disabled}\n                  required\n                />\n                <TextField id=\"friendlyId\" value={friendlyId} onChange={setFriendlyId} disabled={disabled} />\n                <CheckboxField\n                  id=\"forceConnect\"\n                  label={t(`forceConnect~label`)}\n                  help={t(`forceConnect~help`)}\n                  checked={forceConnect}\n                  onChange={() => setForceConnect(!forceConnect)}\n                  mb0\n                />\n              </Collapse>\n            </CardBody>\n            <CardFooter>\n              <Button type=\"submit\" color=\"success\" disabled={disabled}>\n                {t('Connect')}\n              </Button>\n              <Button type=\"reset\" color=\"secondary\" className=\"ml-2\" disabled={disabled}>\n                {t('Reset')}\n              </Button>\n            </CardFooter>\n          </>\n        )}\n      </Card>\n    </form>\n  );\n};\n","import { createSelector } from 'reselect';\n\nimport { selectConnector, selectDevices } from '../../store';\n\nexport const selectVisible = createSelector(\n  selectConnector,\n  selectDevices,\n  (connector, devices) => !connector && !!devices.length\n);\n","import React, { useState, useMemo } from 'react';\nimport { Tooltip } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\nimport classNames from 'classnames';\n\nimport { APP } from '../../common/constants';\n\nexport default ({ device, active, disabled, onClick }) => {\n  const { t } = useTranslation();\n  const [show, setShow] = useState(false);\n  const id = useMemo(() => `device-${device.id}`, [device.id]);\n\n  const toggle = event => {\n    if (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n    setShow(!show);\n  };\n\n  const cloud = device.apps[APP.CLOUD_PAY_DISPLAY];\n  const cloudStatus = t(`cloudPayDisplay~${cloud ? '' : 'un'}installed`);\n\n  return (\n    <button\n      key={device.id}\n      type=\"button\"\n      className={classNames(\n        'list-group-item d-flex justify-content-between align-items-center list-group-item-action p-1',\n        {\n          disabled,\n          'list-group-item-primary': !disabled && active,\n        }\n      )}\n      onClick={onClick}\n    >\n      <div className=\"p-1\">\n        {device.name && <div className=\"font-weight-bold\">{device.name}</div>}\n        {device.productName} {device.serial}\n      </div>\n      <span\n        id={id}\n        onMouseEnter={() => setShow(true)}\n        onMouseLeave={() => setShow(false)}\n        onClick={toggle}\n        className={classNames('badge p-1', {\n          'badge-secondary': disabled,\n          'badge-success': !disabled && cloud,\n          'badge-warning': !disabled && !cloud,\n        })}\n        role=\"img\"\n        aria-label={cloudStatus}\n      >\n        \n      </span>\n      <Tooltip isOpen={show} target={id} toggle={toggle} placement=\"left\">\n        <span className=\"small\">{cloudStatus}</span>\n      </Tooltip>\n    </button>\n  );\n};\n","import React, { useCallback, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Card, CardHeader, CardBody } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\n\nimport { selectDevices, selectDeviceId, connect, clearDevices } from '../../store';\nimport { selectVisible } from './selectors';\nimport { Logo } from '../SVG';\nimport Device from './Device';\n\nexport default () => {\n  const { t } = useTranslation();\n  const dispatch = useDispatch();\n  const devices = useSelector(selectDevices);\n  const deviceId = useSelector(selectDeviceId);\n  const visible = useSelector(selectVisible);\n  const [disabled, setDisabled] = useState();\n\n  const select = useCallback(\n    id => async event => {\n      try {\n        event.preventDefault();\n        setDisabled(true);\n        await dispatch(connect(id));\n      } finally {\n        setDisabled(false);\n      }\n    },\n    [dispatch]\n  );\n\n  const cancel = () => dispatch(clearDevices());\n\n  if (!visible) return null;\n\n  return (\n    <Card className=\"Devices\">\n      <CardHeader>\n        <Logo />\n        <h3>{t('Virtual Keypad')}</h3>\n        <button className=\"close text-light\" title={t('Cancel')} onClick={cancel} disabled={disabled}>\n          &times;\n        </button>\n      </CardHeader>\n      <CardBody>\n        <div className=\"form-group\">\n          <label>{t('Select Device')}:</label>\n          <div className=\"list-group\">\n            {devices.map(device => (\n              <Device\n                key={device.id}\n                device={device}\n                disabled={disabled}\n                active={device.id === deviceId}\n                onClick={select(device.id)}\n              />\n            ))}\n          </div>\n        </div>\n      </CardBody>\n    </Card>\n  );\n};\n","import { ACTION } from '../../common/constants';\nimport {\n  acceptPayment,\n  acceptSignature,\n  disconnect,\n  identify,\n  invokeInputOption,\n  rejectPayment,\n  rejectSignature,\n  reset,\n  setTransactionMode,\n  showWelcome,\n  transaction,\n} from '../../store';\n\nexport const ACTION_CREATOR = {\n  [ACTION.ACCEPT_PAYMENT]: acceptPayment,\n  [ACTION.ACCEPT_SIGNATURE]: acceptSignature,\n  [ACTION.DISCONNECT]: disconnect,\n  [ACTION.IDENTIFY]: identify,\n  [ACTION.INVOKE_INPUT_OPTION]: invokeInputOption,\n  [ACTION.REJECT_PAYMENT]: rejectPayment,\n  [ACTION.REJECT_SIGNATURE]: rejectSignature,\n  [ACTION.RESET]: reset,\n  [ACTION.SHOW_WELCOME]: showWelcome,\n  [ACTION.TRANSACTION]: transaction,\n  [ACTION.TRANSACTION_MODE]: ({ payload }) => setTransactionMode(payload),\n};\n\nexport const MODE = {\n  TRANSACTION: 'TRANSACTION',\n  HISTORY: 'HISTORY',\n};\n","import { setError } from '../error/actions';\nimport { clearActions } from '../actions/actions';\nimport { selectConnector } from '../connection/selectors';\nimport { setStatus } from '../status/actions';\n\nexport default action => async (dispatch, getState) => {\n  try {\n    dispatch({ ...action, type: 'acceptPayment' });\n    dispatch(setStatus('Accepting payment'));\n    dispatch(clearActions());\n\n    const connector = selectConnector(getState());\n    connector.acceptPayment(action.payload.payment);\n  } catch (e) {\n    dispatch(setError(e));\n  }\n};\n","import Clover from 'remote-pay-cloud';\n\nimport { setError } from '../error/actions';\nimport { clearActions } from '../actions/actions';\nimport { selectConnector } from '../connection/selectors';\nimport { setStatus } from '../status/actions';\nimport { clearSignature } from '../signature/actions';\n\nexport default action => async (dispatch, getState) => {\n  try {\n    dispatch({ ...action, type: 'acceptSignature' });\n    dispatch(setStatus('Accepting signature'));\n    dispatch(clearActions());\n    dispatch(clearSignature());\n\n    const connector = selectConnector(getState());\n    const request = new Clover.remotepay.VerifySignatureRequest();\n    request.setPayment(action.payload.payment);\n    connector.acceptSignature(request);\n  } catch (e) {\n    dispatch(setError(e));\n  }\n};\n","import * as CONST from './constants';\n\nexport const clearSignature = () => ({ type: CONST.SIGNATURE_CLEAR });\n\nexport const setSignature = signature => ({\n  type: CONST.SIGNATURE_SET,\n  payload: signature,\n});\n","import { ACTION } from '../../common/constants';\nimport { selectConnector } from '../connection/selectors';\nimport { selectFriendlyId } from '../configuration/selectors';\nimport { setActions } from '../actions/actions';\nimport { setError } from '../error/actions';\nimport { setStatus } from '../status/actions';\nimport i18n from '../../i18n';\n\nexport default action => async (dispatch, getState) => {\n  try {\n    const t = await i18n;\n    dispatch({ ...action, type: 'identify' });\n    dispatch(setStatus('Identifying'));\n    dispatch(\n      setActions([\n        { type: ACTION.SHOW_WELCOME, payload: { description: 'OK' } },\n        { type: ACTION.DISCONNECT, payload: { description: 'Cancel' } },\n      ])\n    );\n\n    const state = getState();\n    const connector = selectConnector(state);\n    const friendlyId = selectFriendlyId(state);\n\n    connector.showMessage(`${friendlyId} ${t('connected')}`);\n  } catch (e) {\n    dispatch(setError(e));\n  }\n};\n","import Clover from 'remote-pay-cloud';\n\nimport { setError } from '../error/actions';\nimport { selectConnector } from '../connection/selectors';\n\nexport default action => async (dispatch, getState) => {\n  try {\n    dispatch({ ...action, type: 'invokeInputOption' });\n\n    const connector = selectConnector(getState());\n    const request = new Clover.remotepay.InputOption();\n    request.setDescription(action.payload.description);\n    request.setKeyPress(action.payload.keyPress);\n    connector.invokeInputOption(request);\n  } catch (e) {\n    dispatch(setError(e));\n  }\n};\n","import { setError } from '../error/actions';\nimport { clearActions } from '../actions/actions';\nimport { selectConnector } from '../connection/selectors';\nimport { setStatus } from '../status/actions';\n\nexport default action => async (dispatch, getState) => {\n  try {\n    dispatch({ ...action, type: 'rejectPayment' });\n    dispatch(setStatus('Rejecting payment'));\n    dispatch(clearActions());\n\n    const connector = selectConnector(getState());\n    connector.rejectPayment(action.payload.payment, action.payload.challenges[0]);\n  } catch (e) {\n    dispatch(setError(e));\n  }\n};\n","import Clover from 'remote-pay-cloud';\n\nimport { setError } from '../error/actions';\nimport { clearActions } from '../actions/actions';\nimport { selectConnector } from '../connection/selectors';\nimport { setStatus } from '../status/actions';\nimport { clearSignature } from '../signature/actions';\n\nexport default action => async (dispatch, getState) => {\n  try {\n    dispatch({ ...action, type: 'rejectSignature' });\n    dispatch(setStatus('Rejecting signature'));\n    dispatch(clearActions());\n    dispatch(clearSignature());\n\n    const connector = selectConnector(getState());\n    const request = new Clover.remotepay.VerifySignatureRequest();\n    request.setPayment(action.payload.payment);\n    connector.rejectSignature(request);\n  } catch (e) {\n    dispatch(setError(e));\n  }\n};\n","import { createSelector } from 'reselect';\nimport { selectConnector } from '../../store';\n\nexport const selectVisible = createSelector(selectConnector, connector => !!connector);\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { selectSignatureBounds, selectSignatureLines } from '../../store';\n\nexport default ({ width = 250, ...other }) => {\n  const bounds = useSelector(selectSignatureBounds);\n  const lines = useSelector(selectSignatureLines);\n\n  if (!lines.length) return null;\n\n  return (\n    <div className=\"Signature\">\n      <svg viewBox={bounds} width={width} {...other}>\n        {lines.map((points, i) => (\n          <polyline key={i} points={points} fill=\"none\" stroke=\"black\" />\n        ))}\n      </svg>\n    </div>\n  );\n};\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\n\nimport { currency } from '../../common';\nimport { selectStatus, selectBuffer, selectActiveTransactionType, selectActiveTransactionAmount } from '../../store';\nimport Signature from './Signature';\n\nexport default () => {\n  const { t } = useTranslation();\n  const status = useSelector(selectStatus);\n  const buffer = useSelector(selectBuffer);\n  const tranType = useSelector(selectActiveTransactionType);\n  const tranAmount = useSelector(selectActiveTransactionAmount);\n\n  return (\n    <div className=\"Screen alert alert-secondary\">\n      {!!tranAmount && (\n        <div className=\"Transaction d-flex justify-content-between bg-white rounded-top border-bottom border-secondary\">\n          <div className=\"font-italic\">{t([`TRANSACTION~${tranType}`, tranType])}</div>\n          <div className=\"font-weight-bold\">{currency(tranAmount)}</div>\n        </div>\n      )}\n      {!buffer && <div>{status}</div>}\n      <Signature />\n      {buffer && <div className=\"text-muted\">{buffer}</div>}\n      {buffer && <h3 className=\"text-right\">{currency(buffer)}</h3>}\n    </div>\n  );\n};\n","import React, { useEffect, useRef } from 'react';\n\nconst measure = (el, scale) => {\n  const { fontSize } = el.style;\n  el.style.fontSize = `${scale}em`; // eslint-disable-line no-param-reassign\n  const { offsetWidth, offsetHeight, scrollWidth, scrollHeight } = el.parentElement;\n  el.style.fontSize = fontSize; // eslint-disable-line no-param-reassign\n  return Math.min(offsetWidth / scrollWidth, offsetHeight / scrollHeight) >= 1;\n};\n\nconst resize = (el, [min, max], attempts = 10) => {\n  if (attempts <= 0) return;\n  const mid = (max + min) / 2;\n  if (measure(el, mid)) {\n    // eslint-disable-next-line no-param-reassign\n    el.style.fontSize = `${mid}em`;\n    resize(el, [mid, max], attempts - 1);\n  } else {\n    resize(el, [min, mid], attempts - 1);\n  }\n};\n\nexport default ({ children, minScale = 0.4, maxScale = 1 }) => {\n  const ref = useRef();\n\n  useEffect(() => {\n    const el = ref.current;\n    if (el) {\n      if (measure(el, maxScale)) {\n        el.style.fontSize = `${maxScale}em`;\n      } else {\n        el.style.fontSize = `${minScale}em`;\n        if (!measure(el, minScale)) {\n          el.classList.add('text-truncate');\n        } else {\n          resize(el, [minScale, maxScale]);\n        }\n      }\n    }\n  }, [maxScale, minScale, ref]);\n\n  return <span ref={ref}>{children}</span>;\n};\n","import React, { forwardRef, useEffect, useState, useMemo, useCallback, useRef } from 'react';\nimport { Button, ButtonDropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\nimport classNames from 'classnames';\n\nimport ScaleText from './ScaleText';\n\nexport default forwardRef(\n  (\n    { action, height, color, keyCodes, disabled, onClick, moreActions, moreText, onMoreClick, children, ...other },\n    ref$\n  ) => {\n    const { t } = useTranslation();\n    const [show, setShow] = useState(false);\n    const ref = ref$ || useRef();\n\n    const toggle = useCallback(() => setShow(cur => !cur), [setShow]);\n\n    useEffect(() => {\n      if (!disabled) {\n        const keydown = event => {\n          if (keyCodes.includes(event.code)) {\n            event.preventDefault();\n            onClick();\n            return false;\n          }\n          return true;\n        };\n        document.addEventListener('keydown', keydown);\n        return () => document.removeEventListener('keydown', keydown);\n      }\n      return undefined;\n    }, [disabled, keyCodes, onClick]);\n\n    const value = useMemo(() => {\n      const key = action?.payload?.description || action?.type;\n      return key ? t([`ACTION~${key}`, key]) : children;\n    }, [action, children, t]);\n\n    const title = useMemo(\n      () => [t('Shortcut keys'), keyCodes.map(k => t([`KEY_CODE~${k}`, k])).join(', ')].join(': '),\n      [keyCodes, t]\n    );\n\n    if (action && moreActions?.length) {\n      return (\n        <ButtonDropdown isOpen={show} toggle={toggle}>\n          <Button\n            color=\"dark\"\n            className=\"action rounded-left\"\n            onClick={onClick}\n            disabled={disabled}\n            title={title}\n            {...other}\n          >\n            {value || <span>&nbsp;</span>}\n          </Button>\n          <DropdownToggle caret color=\"dark\" className=\"action\" disabled={disabled} />\n          <DropdownMenu className=\"bg-dark\" right>\n            {moreActions.map((a, i) => (\n              <DropdownItem key={i} className=\"bg-dark text-light\" onClick={() => onMoreClick(a)}>\n                {t([`ACTION~${a.payload?.description || a.type}`, a.payload?.description || a.type])}\n              </DropdownItem>\n            ))}\n          </DropdownMenu>\n        </ButtonDropdown>\n      );\n    }\n\n    if (moreActions?.length) {\n      return (\n        <div className=\"btn-group-vertical d-flex flex-column\">\n          <ButtonDropdown isOpen={show} toggle={toggle}>\n            <DropdownToggle\n              caret\n              color=\"dark\"\n              outline\n              size=\"sm\"\n              className=\"text-light text-truncate\"\n              disabled={disabled}\n            >\n              {moreText}\n            </DropdownToggle>\n            <DropdownMenu right className=\"bg-dark\">\n              {moreActions.map((a, i) => (\n                <DropdownItem key={i} className=\"bg-dark text-light\" onClick={() => onMoreClick(a)}>\n                  {t([`ACTION~${a.payload?.description || a.type}`, a.payload?.description || a.type])}\n                </DropdownItem>\n              ))}\n            </DropdownMenu>\n          </ButtonDropdown>\n          <Button\n            outline\n            color=\"dark\"\n            className={classNames('h-100', `text-${color || 'light'}`)}\n            onClick={onClick}\n            disabled={disabled}\n            title={title}\n            {...other}\n          >\n            {value || <span>&nbsp;</span>}\n          </Button>\n        </div>\n      );\n    }\n\n    return (\n      <Button\n        innerRef={ref}\n        style={{ height }}\n        outline={!action}\n        color=\"dark\"\n        className={classNames(`text-${color || 'light'}`, { action })}\n        disabled={disabled}\n        onClick={onClick}\n        title={title}\n        {...other}\n      >\n        <ScaleText key={value} minScale={action ? 0.4 : 1} maxScale={1}>\n          {value}\n        </ScaleText>\n      </Button>\n    );\n  }\n);\n","import React, { useMemo, useCallback, useState, useEffect, useRef } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\n\nimport {\n  appendBuffer,\n  clearBuffer,\n  selectCreditEnabled,\n  selectNonTransactionActions,\n  selectTransactionAction,\n  selectTransactionMode,\n  transaction,\n  undoBuffer,\n} from '../../store';\nimport Key from './Key';\nimport { ACTION_CREATOR } from './constants';\nimport { ACTION, TRANSACTION } from '../../common';\n\nexport default () => {\n  const { t } = useTranslation();\n  const dispatch = useDispatch();\n  const actions = useSelector(selectNonTransactionActions);\n  const transactionAction = useSelector(selectTransactionAction);\n  const transactionMode = useSelector(selectTransactionMode);\n  const creditEnabled = useSelector(selectCreditEnabled);\n\n  const [actionClicked, setActionClicked] = useState(false);\n  const keysDisabled = useMemo(() => !transactionAction || actionClicked, [transactionAction, actionClicked]);\n\n  const onAction = useCallback(\n    async action => {\n      setActionClicked(true);\n      if (action.type === ACTION.INVOKE_INPUT_OPTION || action.type === ACTION.TRANSACTION_MODE) {\n        setTimeout(() => setActionClicked(false), 250);\n      }\n      await dispatch(ACTION_CREATOR[action.type](action));\n    },\n    [dispatch, setActionClicked]\n  );\n\n  const actionHandler = action => async () => onAction(action);\n\n  useEffect(() => {\n    if (actions.length) setActionClicked(false);\n  }, [setActionClicked, actions]);\n\n  const keyRef = useRef();\n  const [keyHeight, setKeyHeight] = useState();\n  useEffect(() => {\n    if (keyRef.current) {\n      setKeyHeight(keyRef.current.offsetWidth);\n    }\n  }, [keyRef, setKeyHeight]);\n\n  const submitOptions = useMemo(\n    () =>\n      creditEnabled\n        ? {\n            moreText: t([`TRANSACTION~${transactionMode}`, transactionMode]),\n            moreActions: [\n              {\n                type: ACTION.TRANSACTION_MODE,\n                payload: { description: 'TRANSACTION~SALE', mode: TRANSACTION.SALE },\n              },\n              {\n                type: ACTION.TRANSACTION_MODE,\n                payload: { description: 'TRANSACTION~CREDIT', mode: TRANSACTION.CREDIT },\n              },\n            ],\n            onMoreClick: action => onAction(action),\n          }\n        : undefined,\n    [creditEnabled, onAction, t, transactionMode]\n  );\n\n  const [action1, action2, ...moreActions] = actions;\n\n  return (\n    <div className=\"Keys\">\n      <div className=\"row no-gutters\">\n        <div className=\"col-6 p-1\">\n          <Key\n            action={action1 || {}}\n            disabled={!action1 || actionClicked}\n            keyCodes={['F1', 'NumpadDivide']}\n            onClick={actionHandler(action1)}\n          />\n        </div>\n        <div className=\"col-6 p-1\">\n          <Key\n            action={action2 || {}}\n            disabled={!action2 || actionClicked}\n            keyCodes={['F2', 'NumpadMultiply']}\n            onClick={actionHandler(action2)}\n            moreActions={moreActions}\n            onMoreClick={action => onAction(action)}\n          />\n        </div>\n      </div>\n      <div className=\"row no-gutters\">\n        <div className=\"col-3 p-1\">\n          <Key\n            ref={keyRef}\n            height={keyHeight}\n            disabled={keysDisabled}\n            keyCodes={['Numpad7', 'Digit7']}\n            onClick={() => dispatch(appendBuffer('7'))}\n          >\n            {t('KEY~7')}\n          </Key>\n        </div>\n        <div className=\"col-3 p-1\">\n          <Key disabled={keysDisabled} keyCodes={['Numpad8', 'Digit8']} onClick={() => dispatch(appendBuffer('8'))}>\n            {t('KEY~8')}\n          </Key>\n        </div>\n        <div className=\"col-3 p-1\">\n          <Key disabled={keysDisabled} keyCodes={['Numpad9', 'Digit9']} onClick={() => dispatch(appendBuffer('9'))}>\n            {t('KEY~9')}\n          </Key>\n        </div>\n        <div className=\"col-3 p-1\">\n          <Key\n            color=\"danger\"\n            disabled={keysDisabled}\n            keyCodes={['NumpadSubtract', 'Escape']}\n            onClick={() => dispatch(clearBuffer())}\n          >\n            {t('KEY~X')}\n          </Key>\n        </div>\n      </div>\n      <div className=\"row no-gutters\">\n        <div className=\"col-3 p-1\">\n          <Key\n            height={keyHeight}\n            disabled={keysDisabled}\n            keyCodes={['Numpad4', 'Digit4']}\n            onClick={() => dispatch(appendBuffer('4'))}\n          >\n            {t('KEY~4')}\n          </Key>\n        </div>\n        <div className=\"col-3 p-1\">\n          <Key disabled={keysDisabled} keyCodes={['Numpad5', 'Digit5']} onClick={() => dispatch(appendBuffer('5'))}>\n            {t('KEY~5')}\n          </Key>\n        </div>\n        <div className=\"col-3 p-1\">\n          <Key disabled={keysDisabled} keyCodes={['Numpad6', 'Digit6']} onClick={() => dispatch(appendBuffer('6'))}>\n            {t('KEY~6')}\n          </Key>\n        </div>\n        <div className=\"col-3 p-1\">\n          <Key\n            color=\"warning\"\n            disabled={keysDisabled}\n            keyCodes={['NumpadAdd', 'Backspace', 'Delete']}\n            onClick={() => dispatch(undoBuffer())}\n          >\n            {t('KEY~<')}\n          </Key>\n        </div>\n      </div>\n      <div className=\"row no-gutters\">\n        <div className=\"col-9\">\n          <div className=\"row no-gutters\">\n            <div className=\"col-4 p-1\">\n              <Key\n                height={keyHeight}\n                disabled={keysDisabled}\n                keyCodes={['Numpad1', 'Digit1']}\n                onClick={() => dispatch(appendBuffer('1'))}\n              >\n                {t('KEY~1')}\n              </Key>\n            </div>\n            <div className=\"col-4 p-1\">\n              <Key disabled={keysDisabled} keyCodes={['Numpad2', 'Digit2']} onClick={() => dispatch(appendBuffer('2'))}>\n                {t('KEY~2')}\n              </Key>\n            </div>\n            <div className=\"col-4 p-1\">\n              <Key disabled={keysDisabled} keyCodes={['Numpad3', 'Digit3']} onClick={() => dispatch(appendBuffer('3'))}>\n                {t('KEY~3')}\n              </Key>\n            </div>\n          </div>\n          <div className=\"row no-gutters\">\n            <div className=\"col-8 p-1\">\n              <Key\n                height={keyHeight}\n                disabled={keysDisabled}\n                keyCodes={['Numpad0', 'Digit0']}\n                onClick={() => dispatch(appendBuffer('0'))}\n              >\n                {t('KEY~0')}\n              </Key>\n            </div>\n            <div className=\"col-4 p-1\">\n              <Key\n                disabled={keysDisabled}\n                keyCodes={['NumpadDecimal', 'Period']}\n                onClick={() => dispatch(appendBuffer('00'))}\n              >\n                {t('KEY~00')}\n              </Key>\n            </div>\n          </div>\n        </div>\n        <div className=\"col-3 p-1\">\n          <Key\n            color=\"success\"\n            disabled={keysDisabled}\n            keyCodes={['NumpadEnter', 'Enter']}\n            onClick={() => dispatch(transaction())}\n            {...submitOptions}\n          >\n            {t('KEY~O')}\n          </Key>\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React, { useState, useCallback } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { ButtonDropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\n\nimport { disconnect, reset, showWelcome } from '../../store';\nimport { CheckboxField } from '../Fields';\nimport { MODE } from './constants';\n\nexport default ({ mode, setMode }) => {\n  const { t } = useTranslation();\n  const dispatch = useDispatch();\n  const [show, setShow] = useState(false);\n  const toggle = useCallback(() => setShow(!show), [show, setShow]);\n  const onShowWelcome = useCallback(() => dispatch(showWelcome()), [dispatch]);\n  const onReset = useCallback(() => dispatch(reset()), [dispatch]);\n  const onDisconnect = useCallback(() => dispatch(disconnect()), [dispatch]);\n\n  return (\n    <ButtonDropdown isOpen={show} toggle={toggle}>\n      <DropdownToggle size=\"sm\" outline color=\"dark\" className=\"text-light\" onClick={toggle} title={t('Menu')}>\n        \n      </DropdownToggle>\n      <DropdownMenu right>\n        {Object.values(MODE).map(m => (\n          <DropdownItem key={m} onClick={() => setMode(m)}>\n            <CheckboxField id={`mode-${m}`} label={t([`MODE~${m}`, m])} checked={m === mode} readOnly mb0 />\n          </DropdownItem>\n        ))}\n        <DropdownItem divider />\n        <DropdownItem onClick={onShowWelcome}>{t('Show Welcome')}</DropdownItem>\n        <DropdownItem onClick={onReset}>{t('Reset Device')}</DropdownItem>\n        <DropdownItem onClick={onDisconnect}>{t('Disconnect')}</DropdownItem>\n      </DropdownMenu>\n    </ButtonDropdown>\n  );\n};\n","export default ({ amount, tipAmount, payment }) => {\n  const start = (amount || 0) + (tipAmount || 0);\n  const final = (payment?.amount || 0) + (payment?.tipAmount || 0);\n  const partial = start > final;\n  const remaining = start - final;\n  return { start, final, partial, remaining };\n};\n","import React, { useEffect, useState, useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Button, Table } from 'reactstrap';\nimport { useToasts } from 'react-toast-notifications';\nimport { useTranslation } from 'react-i18next';\nimport { add } from 'date-fns';\n\nimport { currency, card, TRANSACTION } from '../../common';\nimport {\n  hideTransaction,\n  selectVoidEnabled,\n  setBuffer,\n  setError,\n  transaction as doTransaction,\n  voidPayment,\n} from '../../store';\nimport parseAmounts from './parseAmounts';\n\nexport default ({ transaction }) => {\n  const { id, timestamp, type, payment } = transaction || {};\n  const { t } = useTranslation();\n  const dispatch = useDispatch();\n  const { removeToast } = useToasts();\n  const voidEnabled = useSelector(selectVoidEnabled);\n  const now = Date.now();\n  const voidableUntil = add(timestamp, { minutes: 26 });\n  const [voidable, setVoidable] = useState(voidEnabled && now <= voidableUntil);\n\n  useEffect(() => {\n    if (voidable) {\n      const ms = voidableUntil - now;\n      if (ms > 0) {\n        const to = setTimeout(() => setVoidable(false), ms);\n        return () => clearTimeout(to);\n      }\n    }\n    return undefined;\n  }, [now, setVoidable, voidable, voidableUntil]);\n\n  const { partial, remaining } = parseAmounts(transaction);\n\n  const onRemaining = useCallback(async () => {\n    try {\n      await dispatch(setBuffer(remaining));\n      await dispatch(doTransaction());\n    } catch (e) {\n      await dispatch(setError(e));\n    }\n  }, [remaining, dispatch]);\n\n  const onVoid = useCallback(async () => {\n    try {\n      removeToast(id);\n      await dispatch(hideTransaction(id));\n      await dispatch(voidPayment(payment));\n    } catch (e) {\n      await dispatch(setError(e));\n    }\n  }, [dispatch, id, payment, removeToast]);\n\n  return (\n    <div className=\"Transaction\">\n      {transaction.type !== TRANSACTION.VOID && partial && (\n        <div className=\"alert alert-warning\">\n          <h6 className=\"alert-heading\">{t('Partial Payment')}</h6>\n          <div>\n            {t('Remaining')}: {currency(remaining)}\n          </div>\n        </div>\n      )}\n      <h5>\n        {t([`TRANSACTION~${type}`, type])} {t('Details')}\n      </h5>\n      <Table size=\"sm\" className=\"small mb-0\">\n        <tbody>\n          <tr>\n            <th>{t('Payment ID')}:</th>\n            <td>{payment.id}</td>\n          </tr>\n          {payment.externalPaymentId && (\n            <tr>\n              <th>{t('External ID')}:</th>\n              <td>{payment.externalPaymentId}</td>\n            </tr>\n          )}\n          {payment.externalReferenceId && (\n            <tr>\n              <th>{t('External Ref')}:</th>\n              <td>{payment.externalReferenceId}</td>\n            </tr>\n          )}\n          <tr>\n            <th>{t('Order ID')}:</th>\n            <td>{payment.order?.id || payment.orderRef?.id}</td>\n          </tr>\n          {!!payment.tipAmount && (\n            <tr>\n              <th>{t('Total')}:</th>\n              <td>{currency(payment.amount + payment.tipAmount)}</td>\n            </tr>\n          )}\n          <tr>\n            <th>{t('Amount')}:</th>\n            <td>{currency(payment.amount)}</td>\n          </tr>\n          {!!payment.tipAmount && (\n            <tr>\n              <th>{t('Tip')}:</th>\n              <td>{currency(payment.tipAmount)}</td>\n            </tr>\n          )}\n          <tr>\n            <th>{t('Card')}:</th>\n            <td>\n              <div>{t([`CARD~${payment.cardTransaction.cardType}`, payment.cardTransaction.cardType])}</div>\n              <div>{card(payment.cardTransaction)}</div>\n              {payment.cardTransaction.cardholderName && (\n                <div>\n                  {t([\n                    `CARDHOLDER_NAME~${payment.cardTransaction.cardholderName}`,\n                    payment.cardTransaction.cardholderName,\n                  ])}\n                </div>\n              )}\n            </td>\n          </tr>\n        </tbody>\n      </Table>\n      {transaction.type === TRANSACTION.SALE && (\n        <div>\n          {partial && (\n            <Button color=\"primary\" size=\"sm\" className=\"mr-1\" onClick={onRemaining}>\n              {t('Process')} {currency(remaining)}\n            </Button>\n          )}\n          {voidable && (\n            <Button color=\"danger\" size=\"sm\" onClick={onVoid}>\n              {t('Void')}\n            </Button>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useToasts } from 'react-toast-notifications';\n\nimport { hideTransaction } from '../../store';\nimport { TRANSACTION } from '../../common';\nimport parseAmounts from './parseAmounts';\nimport Transaction from './Transaction';\n\nexport default autoDismiss => {\n  const dispatch = useDispatch();\n  const { addToast } = useToasts();\n\n  return transaction => {\n    const { partial } = parseAmounts(transaction);\n\n    let appearance;\n    if (transaction.type === TRANSACTION.VOID) appearance = 'info';\n    else if (partial) appearance = 'warning';\n    else appearance = 'success';\n\n    addToast(<Transaction transaction={transaction} />, {\n      id: transaction.id,\n      appearance,\n      autoDismiss: autoDismiss && !partial,\n      autoDismissTimeout: 8000,\n      onDismiss: () => {\n        dispatch(hideTransaction(transaction.id));\n      },\n    });\n  };\n};\n","import React, { useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Table } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\nimport { format, compareDesc } from 'date-fns';\n\nimport { selectPaymentTransactions } from '../../store';\nimport { currency } from '../../common';\nimport { useShowTransaction } from '../Transaction';\n\nconst parseAmount = ({ amount, tipAmount, payment }) =>\n  currency(payment ? (payment.amount || 0) + (payment.tipAmount || 0) : (amount || 0) + (tipAmount || 0));\n\nconst parseTimestamp = ({ timestamp }) => (timestamp ? format(timestamp, 'M/d h:mm a') : '??');\n\nexport default () => {\n  const { t } = useTranslation();\n  const transactions = useSelector(selectPaymentTransactions);\n  const showTransaction = useShowTransaction();\n\n  const sortedTransactions = useMemo(() => transactions.sort((a, b) => compareDesc(a.timestamp, b.timestamp)), [\n    transactions,\n  ]);\n\n  return (\n    <div className=\"History\">\n      <Table size=\"sm\" hover className=\"table-secondary\" striped>\n        <thead>\n          <tr>\n            <th>{t('Date')}</th>\n            <th>{t('Type')}</th>\n            <th className=\"text-right\">{t('Amount')}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {sortedTransactions.map(transaction => (\n            <tr key={transaction.id} role=\"button\" onClick={() => showTransaction(transaction)}>\n              <td>{parseTimestamp(transaction)}</td>\n              <td>{t(`TRANSACTION~${transaction.type}`)}</td>\n              <td className=\"text-right\">{parseAmount(transaction)}</td>\n            </tr>\n          ))}\n        </tbody>\n      </Table>\n    </div>\n  );\n};\n","import React, { useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Card, CardHeader, CardBody } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\n\nimport { Logo } from '../SVG';\nimport { MODE } from './constants';\nimport { selectVisible } from './selectors';\nimport Screen from './Screen';\nimport Keys from './Keys';\nimport Menu from './Menu';\nimport History from './History';\nimport './styles.scss';\n\nexport default () => {\n  const { t } = useTranslation();\n  const visible = useSelector(selectVisible);\n\n  const [mode, setMode] = useState(MODE.TRANSACTION);\n\n  if (!visible) return null;\n\n  return (\n    <Card className=\"Keypad\">\n      <CardHeader>\n        <Logo />\n        <h3>{t('Virtual Keypad')}</h3>\n        <Menu mode={mode} setMode={setMode} />\n      </CardHeader>\n      <CardBody>\n        {mode === MODE.TRANSACTION && <Screen />}\n        {mode === MODE.TRANSACTION && <Keys />}\n        {mode === MODE.HISTORY && <History />}\n      </CardBody>\n    </Card>\n  );\n};\n","import React, { useState, useEffect } from 'react';\nimport { Button } from 'reactstrap';\nimport { useTranslation } from 'react-i18next';\nimport classNames from 'classnames';\n\nexport default ({ error }) => {\n  const { message, stack } = error;\n  const { t } = useTranslation();\n  const [expanded, setExpanded] = useState(false);\n\n  const expand = () => {\n    document.querySelector('.react-toast-notifications__container').classList.add('expanded');\n    setExpanded(true);\n  };\n\n  useEffect(() => {\n    return () => {\n      const remaining = document.querySelectorAll('.Error.expanded').length - (expanded ? 1 : 0);\n      if (!remaining) {\n        document.querySelector('.react-toast-notifications__container').classList.remove('expanded');\n      }\n    };\n  }, [expanded]);\n\n  return (\n    <div className={classNames('Error', { expanded })}>\n      <h5>{t([`ERROR~${message}`, message])}</h5>\n      {!!stack && !expanded && (\n        <Button color=\"link\" size=\"small\" onClick={expand}>\n          {t('Show details')}\n        </Button>\n      )}\n      {!!stack && expanded && (\n        <pre className=\"mb-0\">\n          <code>{stack}</code>\n        </pre>\n      )}\n    </div>\n  );\n};\n","import React from 'react';\nimport classNames from 'classnames';\n\nimport Configuration from '../Configuration';\nimport Devices from '../Devices/Devices';\nimport Keypad from '../Keypad';\nimport { useError } from '../Error';\nimport { useTransactions } from '../Transaction';\nimport useMouse from './useMouse';\nimport usePreventDoubleTapZoom from './usePreventDoubleTapZoom';\nimport './styles.scss';\n\nexport default () => {\n  const mouse = useMouse();\n  useError(mouse);\n  usePreventDoubleTapZoom();\n  useTransactions(mouse);\n\n  return (\n    <div className={classNames('App container maxwidth')}>\n      <Configuration />\n      <Devices />\n      <Keypad />\n    </div>\n  );\n};\n","import { useState, useEffect } from 'react';\n\nexport default () => {\n  const [mouse, setMouse] = useState(false);\n\n  useEffect(() => {\n    if (!mouse) {\n      const onHover = () => setMouse(true);\n      document.addEventListener('mouseover', onHover);\n      return () => document.removeEventListener('mouseover', onHover);\n    }\n    return undefined;\n  }, [mouse, setMouse]);\n\n  return mouse;\n};\n","import React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useToasts } from 'react-toast-notifications';\n\nimport { selectError, clearError } from '../../store';\nimport Error from './Error';\n\nexport default autoDismiss => {\n  const dispatch = useDispatch();\n  const error = useSelector(selectError);\n  const { addToast } = useToasts();\n\n  useEffect(() => {\n    if (error.message) {\n      addToast(<Error error={error} />, {\n        id: 'error',\n        appearance: 'error',\n        autoDismiss: autoDismiss && !error.important,\n        onDismiss: () => {\n          dispatch(clearError());\n        },\n      });\n    }\n  }, [addToast, dispatch, error, autoDismiss]);\n};\n","import { useEffect } from 'react';\n\nexport default ({ ms = 500 } = {}) =>\n  useEffect(() => {\n    let expires = 0;\n    const handler = event => {\n      if (event.touches.length === 1) {\n        const now = Date.now();\n        if (event.touches.length === 1 && now > expires) {\n          event.preventDefault();\n          // Trigger a fake click for the tap we just prevented\n          event.target.click();\n        }\n        expires = now + ms;\n      }\n    };\n\n    document.body.addEventListener('touchstart', handler, { passive: false });\n\n    return () => document.body.removeEventListener('touchstart', handler, { passive: false });\n  }, [ms]);\n","import { useEffect } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { selectVisiblePaymentTransactions } from '../../store';\nimport useShowTransaction from './useShowTransaction';\n\nexport default autoDismiss => {\n  const transactions = useSelector(selectVisiblePaymentTransactions);\n  const showTransaction = useShowTransaction(autoDismiss);\n\n  useEffect(() => {\n    transactions.forEach(showTransaction);\n  }, [transactions, showTransaction]);\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider as ReduxProvider } from 'react-redux';\nimport { ToastProvider } from 'react-toast-notifications';\n\nimport store from './store';\nimport App from './components/App';\nimport './i18n';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <ReduxProvider store={store}>\n      <ToastProvider placement=\"bottom-center\">\n        <App />\n      </ToastProvider>\n    </ReduxProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}